{"ast":null,"code":"import _regeneratorRuntime from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/**\n * Code generated using Python\n * @author Raja Reddy\n * Date : 17 Oct 2021\n *\n * Modified By :\n */import{useState,useEffect,useMemo}from\"react\";import{withRouter,useParams,useHistory,Link}from\"react-router-dom\";import{useForm}from\"react-hook-form\";import axios from\"axios\";import Table,{SelectColumnFilter}from\"../utils/Table\";//\nimport*as yup from\"yup\";import{yupResolver}from\"@hookform/resolvers/yup\";import addDays from\"date-fns/addDays\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var schema=yup.object({});var Rollback=function Rollback(){var _useForm=useForm({resolver:yupResolver(schema)}),register=_useForm.register,handleSubmit=_useForm.handleSubmit,setValue=_useForm.setValue,errors=_useForm.formState.errors,clearErrors=_useForm.clearErrors;var _useParams=useParams(),id=_useParams.id;//console.log(id);\nvar history=useHistory();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),serverErrors=_useState4[0],setServerErrors=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),entity=_useState6[0],setEntity=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),state=_useState8[0],setState=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),mesg=_useState10[0],setMesg=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),dakId=_useState12[0],setDakId=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),rollBackMesg=_useState14[0],setRollBackMesg=_useState14[1];var _useState15=useState(true),_useState16=_slicedToArray(_useState15,2),loading=_useState16[0],setLoading=_useState16[1];var _useState17=useState(\"\"),_useState18=_slicedToArray(_useState17,2),fileName=_useState18[0],setFileName=_useState18[1];var _useState19=useState(\"Page1\"),_useState20=_slicedToArray(_useState19,2),key=_useState20[0],setKey=_useState20[1];useEffect(function(){var fetching=false;var unmounted=false;function fetchData(){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(fetching){_context.next=3;break;}_context.next=3;return axios.get(\"/pms?search='PrintPmCs'\").then(function(response){console.log(\"response>>\"+response.data);//setSh3List(response.data);\nsetData(response.data);}).catch(function(error){//console.log(error);\n//console.log(error.response.status);\n//console.log(error.response.headers);\nif(error.response)setServerErrors(error.response.data.error);else setServerErrors(error.Error);});case 3:case\"end\":return _context.stop();}}},_callee);}));return _fetchData.apply(this,arguments);}fetchData();return function(){fetching=true;unmounted=true;};// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);var onError=function onError(errors,e){return console.log(errors,e);};//All foreign keys.\n// XXXXXX Add search fields and adjust the values as necessary\nvar errorCallback=function errorCallback(err){//console.log(err);\nsetServerErrors(err);};var handleInputChange=function handleInputChange(e){console.log(e.target.value);setDakId(e.target.value);};var handleMesgChange=function handleMesgChange(e){console.log(e.target.value);setRollBackMesg(e.target.value);};var rollback=function rollback(){var saving=false;console.log(dakId);function rollbackTrans(){return _rollbackTrans.apply(this,arguments);}function _rollbackTrans(){_rollbackTrans=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!saving)axios.get(\"/pms/\".concat(dakId,\"/rollback?rollBackMesg=\")+rollBackMesg).then(function(response){setMesg(response.data);}).catch(function(error){//console.log(error);\n//console.log(error.response.status);\n//console.log(error.response.headers);\nif(error.response)setServerErrors(error.response.data.error);else setServerErrors(error.Error);});case 1:case\"end\":return _context2.stop();}}},_callee2);}));return _rollbackTrans.apply(this,arguments);}rollbackTrans();return function(){saving=true;};};var download=function download(){console.log(fileName);setFileName(dakId+\".pdf\");axios({url:\"\".concat(process.env.REACT_APP_BASE_URL,\"/files/\")+fileName,//XXXXXXXX localhost\nmethod:\"GET\",responseType:\"blob\"// important\n}).then(function(response){var url=window.URL.createObjectURL(new Blob([response.data]));var link=document.createElement(\"a\");link.href=url;link.setAttribute(\"download\",fileName);document.body.appendChild(link);link.click();});};return/*#__PURE__*/_jsx(\"div\",{className:\"max-w-xl mx-auto \",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-full w-3/4  mx-auto \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full w-3/4  mx-auto\",children:[mesg,/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-semibold ml-4\",children:\"Rollback\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"search\",placeholder:\"DakId No\",onChange:function onChange(e){return handleInputChange(e);},className:\"form-control py-0\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"mb-2 text-red-500\",children:[\"Note: Please do not use words containing \\\"subm\\\" like 'submitted','submission','submitting','submit' in Rollback reason. \",/*#__PURE__*/_jsx(\"br\",{}),\"For Submission Date : use word - DOS / Claim Date\"]}),/*#__PURE__*/_jsx(\"textarea\",{rows:3,placeholder:\"Rollback reason\",onChange:function onChange(e){return handleMesgChange(e);},className:\"form-control py-0\"})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",onClick:rollback,className:\"w-24 m-0 p-0\",children:\"Rollback\"})})]})]})})});};export default withRouter(Rollback);","map":{"version":3,"sources":["/home/itsdcsec/falconws/falcon_face/src/components/Rollback.js"],"names":["useState","useEffect","useMemo","withRouter","useParams","useHistory","Link","useForm","axios","Table","SelectColumnFilter","yup","yupResolver","addDays","schema","object","Rollback","resolver","register","handleSubmit","setValue","errors","formState","clearErrors","id","history","data","setData","serverErrors","setServerErrors","entity","setEntity","state","setState","mesg","setMesg","dakId","setDakId","rollBackMesg","setRollBackMesg","loading","setLoading","fileName","setFileName","key","setKey","fetching","unmounted","fetchData","get","then","response","console","log","catch","error","Error","onError","e","errorCallback","err","handleInputChange","target","value","handleMesgChange","rollback","saving","rollbackTrans","download","url","process","env","REACT_APP_BASE_URL","method","responseType","window","URL","createObjectURL","Blob","link","document","createElement","href","setAttribute","body","appendChild","click"],"mappings":"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","sourcesContent":["/**\n * Code generated using Python\n * @author Raja Reddy\n * Date : 17 Oct 2021\n *\n * Modified By :\n */\n\nimport { useState, useEffect, useMemo } from \"react\";\nimport { withRouter, useParams, useHistory, Link } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport axios from \"axios\";\nimport Table, { SelectColumnFilter } from \"../utils/Table\"; //\n\nimport * as yup from \"yup\";\n\nimport { yupResolver } from \"@hookform/resolvers/yup\";\n\nimport addDays from \"date-fns/addDays\";\n\nconst schema = yup.object({});\n\nconst Rollback = () => {\n  const {\n    register,\n    handleSubmit,\n    setValue,\n    formState: { errors },\n    clearErrors,\n  } = useForm({\n    resolver: yupResolver(schema),\n  });\n\n  let { id } = useParams();\n  //console.log(id);\n\n  let history = useHistory();\n\n  const [data, setData] = useState([]);\n  const [serverErrors, setServerErrors] = useState([]);\n  const [entity, setEntity] = useState({});\n  const [state, setState] = useState({});\n  const [mesg, setMesg] = useState(\"\");\n  const [dakId, setDakId] = useState(\"\");\n  const [rollBackMesg, setRollBackMesg] = useState(\"\");\n\n  const [loading, setLoading] = useState(true);\n  const [fileName, setFileName] = useState(\"\");\n\n  const [key, setKey] = useState(\"Page1\");\n\n  useEffect(() => {\n    let fetching = false;\n    let unmounted = false;\n\n    async function fetchData() {\n      if (!fetching)\n        //console.log(secId);\n        await axios\n          .get(`/pms?search='PrintPmCs'`)\n          .then((response) => {\n            console.log(\"response>>\" + response.data);\n            //setSh3List(response.data);\n            setData(response.data);\n          })\n          .catch((error) => {\n            //console.log(error);\n            //console.log(error.response.status);\n            //console.log(error.response.headers);\n            if (error.response) setServerErrors(error.response.data.error);\n            else setServerErrors(error.Error);\n          });\n    }\n    fetchData();\n\n    return () => {\n      fetching = true;\n      unmounted = true;\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const onError = (errors, e) => console.log(errors, e);\n\n  //All foreign keys.\n  // XXXXXX Add search fields and adjust the values as necessary\n\n  const errorCallback = (err) => {\n    //console.log(err);\n    setServerErrors(err);\n  };\n\n  const handleInputChange = (e) => {\n    console.log(e.target.value);\n    setDakId(e.target.value);\n  };\n  const handleMesgChange = (e) => {\n    console.log(e.target.value);\n    setRollBackMesg(e.target.value);\n  };\n\n  const rollback = () => {\n    let saving = false;\n    console.log(dakId);\n    async function rollbackTrans() {\n      if (!saving)\n        axios\n          .get(`/pms/${dakId}/rollback?rollBackMesg=` + rollBackMesg)\n          .then((response) => {\n            setMesg(response.data);\n          })\n          .catch((error) => {\n            //console.log(error);\n            //console.log(error.response.status);\n            //console.log(error.response.headers);\n            if (error.response) setServerErrors(error.response.data.error);\n            else setServerErrors(error.Error);\n          });\n    }\n    rollbackTrans();\n\n    return () => {\n      saving = true;\n    };\n  };\n\n  const download = () => {\n    console.log(fileName);\n    setFileName(dakId + \".pdf\");\n    axios({\n      url: `${process.env.REACT_APP_BASE_URL}/files/` + fileName, //XXXXXXXX localhost\n      method: \"GET\",\n      responseType: \"blob\", // important\n    }).then((response) => {\n      const url = window.URL.createObjectURL(new Blob([response.data]));\n      const link = document.createElement(\"a\");\n      link.href = url;\n      link.setAttribute(\"download\", fileName);\n      document.body.appendChild(link);\n      link.click();\n    });\n  };\n\n  return (\n    <div className=\"max-w-xl mx-auto \">\n      <div className=\"w-full w-3/4  mx-auto \">\n        <div className=\"w-full w-3/4  mx-auto\">\n          {mesg}\n\n          <h1 className=\"text-xl font-semibold ml-4\">Rollback</h1>\n          <div>\n            <div>\n              <input\n                type=\"text\"\n                name=\"search\"\n                placeholder=\"DakId No\"\n                onChange={(e) => handleInputChange(e)}\n                className=\"form-control py-0\"\n              />\n            </div>\n            <div>\n\t\t\t\t<h3 className=\"mb-2 text-red-500\">\n\t\t\t\t\tNote: Please do not use words containing \"subm\" like 'submitted','submission','submitting','submit' in Rollback reason. <br></br>\n\t\t\t\t\tFor Submission Date : use word - DOS / Claim Date\n\t\t\t\t</h3>\n              <textarea\n                rows={3}\n                placeholder=\"Rollback reason\"\n                onChange={(e) => handleMesgChange(e)}\n                className=\"form-control py-0\"\n              />\n            </div>\n            <div>\n              <button type=\"submit\" onClick={rollback} className=\"w-24 m-0 p-0\">\n                Rollback\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default withRouter(Rollback);\n"]},"metadata":{},"sourceType":"module"}