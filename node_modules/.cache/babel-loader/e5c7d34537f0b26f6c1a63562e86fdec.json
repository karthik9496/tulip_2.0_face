{"ast":null,"code":"var _jsxFileName = \"/home/pcdaopune/ITSDC/falcon_face/src/components/PayElementEdit.js\",\n    _s = $RefreshSig$();\n\n/**\n * Code generated using Python\n * @author Raja Reddy\n * Date : 17 Oct 2021\n *\n * Modified By :\n */\nimport { useState, useEffect } from \"react\";\nimport { withRouter, useParams, useHistory } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport axios from \"axios\";\nimport * as yup from \"yup\";\nimport { yupResolver } from \"@hookform/resolvers/yup\";\nimport LiveSearch from \"../utils/LiveSearch\"; //import DatePicker  from 'react-datepicker';\n//import \"react-datepicker/dist/react-datepicker.css\";\n//import addDays from 'date-fns/addDays'\n\nimport Tabs from \"react-bootstrap/Tabs\";\nimport Tab from \"react-bootstrap/Tab\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst schema = yup.object({\n  employee: yup.object().required(\"Required\"),\n  basicPay: yup.number().integer().required(\"Required\")\n});\n\nconst PayElementEdit = () => {\n  _s();\n\n  var _errors$employee, _errors$fromDate, _errors$basicPay;\n\n  const {\n    register,\n    handleSubmit,\n    setValue,\n    formState: {\n      errors\n    },\n    clearErrors\n  } = useForm({\n    resolver: yupResolver(schema)\n  });\n  let {\n    id\n  } = useParams();\n  let history = useHistory();\n  const [serverErrors, setServerErrors] = useState([]);\n  const [entity, setEntity] = useState({});\n  const [state, setState] = useState({});\n  const [key, setKey] = useState(\"page1\");\n  const [rankCode, setRankCode] = useState(\"\");\n  const [empId, setEmpId] = useState();\n  const [basicPay, setBasicPay] = useState();\n  const [payElementData, setPayElementData] = useState([]);\n  const [rank, setRank] = useState(\"\");\n  const [rankName, setRankName] = useState(\"\"); //pcdao -- for showing message if user not AO.\n\n  const [msg, setMsg] = useState(\"\");\n  useEffect(() => {\n    let isCancelled = false;\n    console.log(id);\n\n    if (id !== \"new\") {\n      async function fetchData() {\n        let record = \"\";\n        await axios.get(\"/payElements/\" + id).then(response => {\n          record = response.data;\n          const fields = [\"id\", \"employee\", \"cancelDo2\", \"cancelled\", \"discharged\", \"effective\", \"oldRankPay\", \"do2\", \"fromDate\", \"toDate\", \"basicPay\", \"dp\", \"gradePay\", \"rankPay\", \"msPay\", \"npaPay\", \"specialistPay\", \"oldBasicPay\", \"absent\", \"deputation\", \"cdaoNo\", \"checkDigit\", \"payLevel\", \"monthEnding\", \"deputationStatus\", \"recordStatus\"];\n          fields.forEach(field => setValue(field, record[field]));\n        }).catch(error => {\n          //console.log(error);\n          //console.log(error.response.status);\n          //console.log(error.response.headers);\n          if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n        });\n        setRankCode(record.employee.rank.rankName + \":\" + record.employee.rank.rankCode.toString());\n        console.log(record.employee.rank.rankName + \":\" + record.employee.rank.rankCode.toString());\n        setEmpId(record.employee.id);\n\n        if (!isCancelled) {\n          setEntity(record);\n          setState(prev => ({ ...prev,\n            state: record\n          }));\n        }\n      }\n\n      fetchData();\n      return () => {\n        isCancelled = true;\n      };\n    }\n  }, [id, setValue]);\n\n  const onSubmit = (data, event) => {\n    event.preventDefault();\n    console.log(data);\n\n    if (data.id) {\n      axios.put(\"/payElements/\" + data.id, data).then(response => {\n        history.push(\"/payElements\");\n      }).catch(error => {\n        //console.log(error.response.data);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        setServerErrors(error.response.data);\n      });\n    } else {\n      //pcdao -- added condition to show message if user not AO.\n      axios.post(\"/payElements\", data).then(response => {\n        if (response.data) {\n          history.push(\"/payElements\");\n        } else {\n          setMsg(\"Facility Available only for AO.\");\n        }\n      }).catch(error => {\n        //console.log(error.response.data);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        setServerErrors(error.response.data);\n      });\n    }\n  };\n\n  const onError = (errors, e) => console.log(errors, e); //All foreign keys.\n  // XXXXXX Add search fields and adjust the values as necessary\n\n\n  const parentData = {\n    employee: {\n      title: \"Employee\",\n      url: \"employees\",\n      searchList: [\"cdaoNo\", \"checkDigit\", \"officerName\"],\n      //XXXXXXXXX Add search fields here and also in the corresponding repository\n      fkEntity: \"employee\"\n    },\n    cancelDo2: {\n      title: \"Cancel Do2\",\n      url: \"cancelDo2s\",\n      searchList: [\"id\"],\n      //XXXXXXXXX Add search fields here and also in the corresponding repository\n      fkEntity: \"cancelDo2\"\n    },\n    do2: {\n      title: \"Do2\",\n      url: \"do2s\",\n      searchList: [\"id\"],\n      //XXXXXXXXX Add search fields here and also in the corresponding repository\n      fkEntity: \"do2\"\n    }\n  }; //Callback for child components (Foreign Keys)\n\n  const callback = childData => {\n    //console.log(\"Parent Callback\");\n    setEntity(prev => ({ ...prev,\n      [childData.fk]: childData.entity\n    }));\n    setValue(childData.fk, childData.entity);\n\n    if (childData.fk === \"employee\") {\n      setRankCode(childData.entity.rank.rankName + \":\" + childData.entity.rank.rankCode.toString());\n    } //console.log(errors);\n\n\n    clearErrors(childData.fk);\n  };\n\n  const errorCallback = err => {\n    //console.log(err);\n    setServerErrors(err);\n  };\n\n  const handleInputChange = e => {//console.log(e.target.value);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-xl mx-auto \",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full w-3/4  mx-auto \",\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit(onSubmit, onError),\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: [id === \"new\" ? \"Add\" : \"Edit\", \" Pay Element \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h6\", {\n          className: \"text-red-500\",\n          children: msg\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-red-500\",\n          children: serverErrors\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Tabs, {\n          id: \"PayElementEdit\",\n          activeKey: key,\n          onSelect: k => setKey(k),\n          className: \"mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(Tab, {\n            eventKey: \"page1\",\n            title: \"Page 1\",\n            className: \"h-120\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"grid grid-cols-2 gap-0\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(LiveSearch, {\n                  name: \"employee\",\n                  onChange: handleInputChange,\n                  parentData: parentData.employee,\n                  parentCallback: callback,\n                  fkEntity: entity.employee,\n                  errCallback: errorCallback\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 234,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-red-500 \",\n                  children: (_errors$employee = errors.employee) === null || _errors$employee === void 0 ? void 0 : _errors$employee.message\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 242,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 233,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"Rank\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 248,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  name: \"rank\",\n                  value: rankCode,\n                  readOnly: true,\n                  className: \"form-control py-0\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 249,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 247,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"From Date\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 259,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"date\",\n                  name: \"fromDate\",\n                  ...register(\"fromDate\"),\n                  className: \"form-control py-0\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 260,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-red-500\",\n                  children: (_errors$fromDate = errors.fromDate) === null || _errors$fromDate === void 0 ? void 0 : _errors$fromDate.message\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 266,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 258,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"Basic Pay\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 270,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  name: \"basicPay\",\n                  ...register(\"basicPay\"),\n                  className: \"form-control py-0\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 271,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-red-500\",\n                  children: (_errors$basicPay = errors.basicPay) === null || _errors$basicPay === void 0 ? void 0 : _errors$basicPay.message\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 277,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 269,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Tab, {\n            eventKey: \"help\",\n            title: \"Help\",\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              children: \"Help\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 283,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n              className: \"list-disc\",\n              children: [/*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"Point 1\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 285,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"Point 2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 286,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 284,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 282,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"px-4\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            children: \"Save\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 217,\n    columnNumber: 5\n  }, this);\n};\n\n_s(PayElementEdit, \"j6zvfXAZVyI8aoNhCbXH+u58ziA=\", false, function () {\n  return [useForm, useParams, useHistory];\n});\n\n_c = PayElementEdit;\nexport default _c2 = withRouter(PayElementEdit);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"PayElementEdit\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["/home/pcdaopune/ITSDC/falcon_face/src/components/PayElementEdit.js"],"names":["useState","useEffect","withRouter","useParams","useHistory","useForm","axios","yup","yupResolver","LiveSearch","Tabs","Tab","schema","object","employee","required","basicPay","number","integer","PayElementEdit","register","handleSubmit","setValue","formState","errors","clearErrors","resolver","id","history","serverErrors","setServerErrors","entity","setEntity","state","setState","key","setKey","rankCode","setRankCode","empId","setEmpId","setBasicPay","payElementData","setPayElementData","rank","setRank","rankName","setRankName","msg","setMsg","isCancelled","console","log","fetchData","record","get","then","response","data","fields","forEach","field","catch","error","Error","toString","prev","onSubmit","event","preventDefault","put","push","post","onError","e","parentData","title","url","searchList","fkEntity","cancelDo2","do2","callback","childData","fk","errorCallback","err","handleInputChange","k","message","fromDate"],"mappings":"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","sourcesContent":["/**\n * Code generated using Python\n * @author Raja Reddy\n * Date : 17 Oct 2021\n *\n * Modified By :\n */\n\nimport { useState, useEffect } from \"react\";\nimport { withRouter, useParams, useHistory } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport axios from \"axios\";\nimport * as yup from \"yup\";\n\nimport { yupResolver } from \"@hookform/resolvers/yup\";\nimport LiveSearch from \"../utils/LiveSearch\";\n\n//import DatePicker  from 'react-datepicker';\n//import \"react-datepicker/dist/react-datepicker.css\";\n//import addDays from 'date-fns/addDays'\n\nimport Tabs from \"react-bootstrap/Tabs\";\nimport Tab from \"react-bootstrap/Tab\";\n\nconst schema = yup.object({\n  employee: yup.object().required(\"Required\"),\n  basicPay: yup.number().integer().required(\"Required\"),\n});\n\nconst PayElementEdit = () => {\n  const {\n    register,\n    handleSubmit,\n    setValue,\n    formState: { errors },\n    clearErrors,\n  } = useForm({\n    resolver: yupResolver(schema),\n  });\n\n  let { id } = useParams();\n\n  let history = useHistory();\n  const [serverErrors, setServerErrors] = useState([]);\n  const [entity, setEntity] = useState({});\n  const [state, setState] = useState({});\n  const [key, setKey] = useState(\"page1\");\n\n  const [rankCode, setRankCode] = useState(\"\");\n  const [empId, setEmpId] = useState();\n  const [basicPay, setBasicPay] = useState();\n  const [payElementData, setPayElementData] = useState([]);\n  const [rank, setRank] = useState(\"\");\n  const [rankName, setRankName] = useState(\"\");\n\n  //pcdao -- for showing message if user not AO.\n  const [msg, setMsg] = useState(\"\");\n\n  useEffect(() => {\n    let isCancelled = false;\n    console.log(id);\n    if (id !== \"new\") {\n      async function fetchData() {\n        let record = \"\";\n        await axios\n          .get(\"/payElements/\" + id)\n          .then((response) => {\n            record = response.data;\n            const fields = [\n              \"id\",\n              \"employee\",\n              \"cancelDo2\",\n              \"cancelled\",\n              \"discharged\",\n              \"effective\",\n              \"oldRankPay\",\n              \"do2\",\n              \"fromDate\",\n              \"toDate\",\n              \"basicPay\",\n              \"dp\",\n              \"gradePay\",\n              \"rankPay\",\n              \"msPay\",\n              \"npaPay\",\n              \"specialistPay\",\n              \"oldBasicPay\",\n              \"absent\",\n              \"deputation\",\n              \"cdaoNo\",\n              \"checkDigit\",\n              \"payLevel\",\n              \"monthEnding\",\n              \"deputationStatus\",\n              \"recordStatus\",\n            ];\n            fields.forEach((field) => setValue(field, record[field]));\n          })\n          .catch((error) => {\n            //console.log(error);\n            //console.log(error.response.status);\n            //console.log(error.response.headers);\n            if (error.response) setServerErrors(error.response.data.error);\n            else setServerErrors(error.Error);\n          });\n        setRankCode(\n          record.employee.rank.rankName +\n            \":\" +\n            record.employee.rank.rankCode.toString()\n        );\n        console.log(\n          record.employee.rank.rankName +\n            \":\" +\n            record.employee.rank.rankCode.toString()\n        );\n        setEmpId(record.employee.id);\n\n        if (!isCancelled) {\n          setEntity(record);\n          setState((prev) => ({ ...prev, state: record }));\n        }\n      }\n\n      fetchData();\n      return () => {\n        isCancelled = true;\n      };\n    }\n  }, [id, setValue]);\n\n  const onSubmit = (data, event) => {\n    event.preventDefault();\n    console.log(data);\n    if (data.id) {\n      axios\n        .put(\"/payElements/\" + data.id, data)\n        .then((response) => {\n          history.push(\"/payElements\");\n        })\n        .catch((error) => {\n          //console.log(error.response.data);\n          //console.log(error.response.status);\n          //console.log(error.response.headers);\n          setServerErrors(error.response.data);\n        });\n    } else {\n\t  //pcdao -- added condition to show message if user not AO.\n      axios\n        .post(\"/payElements\", data)\n        .then((response) => {\n          if (response.data) {\n            history.push(\"/payElements\");\n          } else {\n            setMsg(\"Facility Available only for AO.\");\n          }\n        })\n        .catch((error) => {\n          //console.log(error.response.data);\n          //console.log(error.response.status);\n          //console.log(error.response.headers);\n          setServerErrors(error.response.data);\n        });\n    }\n  };\n\n  const onError = (errors, e) => console.log(errors, e);\n\n  //All foreign keys.\n  // XXXXXX Add search fields and adjust the values as necessary\n  const parentData = {\n    employee: {\n      title: \"Employee\",\n      url: \"employees\",\n      searchList: [\"cdaoNo\", \"checkDigit\", \"officerName\"], //XXXXXXXXX Add search fields here and also in the corresponding repository\n      fkEntity: \"employee\",\n    },\n    cancelDo2: {\n      title: \"Cancel Do2\",\n      url: \"cancelDo2s\",\n      searchList: [\"id\"], //XXXXXXXXX Add search fields here and also in the corresponding repository\n      fkEntity: \"cancelDo2\",\n    },\n    do2: {\n      title: \"Do2\",\n      url: \"do2s\",\n      searchList: [\"id\"], //XXXXXXXXX Add search fields here and also in the corresponding repository\n      fkEntity: \"do2\",\n    },\n  };\n\n  //Callback for child components (Foreign Keys)\n  const callback = (childData) => {\n    //console.log(\"Parent Callback\");\n    setEntity((prev) => ({ ...prev, [childData.fk]: childData.entity }));\n    setValue(childData.fk, childData.entity);\n    if (childData.fk === \"employee\") {\n      setRankCode(\n        childData.entity.rank.rankName +\n          \":\" +\n          childData.entity.rank.rankCode.toString()\n      );\n    }\n    //console.log(errors);\n    clearErrors(childData.fk);\n  };\n\n  const errorCallback = (err) => {\n    //console.log(err);\n    setServerErrors(err);\n  };\n\n  const handleInputChange = (e) => {\n    //console.log(e.target.value);\n  };\n\n  return (\n    <div className=\"max-w-xl mx-auto \">\n      <div className=\"w-full w-3/4  mx-auto \">\n        <form onSubmit={handleSubmit(onSubmit, onError)}>\n          <h1>{id === \"new\" ? \"Add\" : \"Edit\"} Pay Element </h1>\n\n\t\t  {/* pcdao -- added message if user not AO */}\n          <h6 className=\"text-red-500\">{msg}</h6>\n          <div className=\"text-red-500\">{serverErrors}</div>\n          <Tabs\n            id=\"PayElementEdit\"\n            activeKey={key}\n            onSelect={(k) => setKey(k)}\n            className=\"mb-3\"\n          >\n            <Tab eventKey=\"page1\" title=\"Page 1\" className=\"h-120\">\n              <div className=\"grid grid-cols-2 gap-0\">\n                <div>\n                  <LiveSearch\n                    name=\"employee\"\n                    onChange={handleInputChange}\n                    parentData={parentData.employee}\n                    parentCallback={callback}\n                    fkEntity={entity.employee}\n                    errCallback={errorCallback}\n                  />\n                  <div className=\"text-red-500 \">\n                    {errors.employee?.message}\n                  </div>\n                </div>\n\n                <div>\n                  <label>Rank</label>\n                  <input\n                    type=\"text\"\n                    name=\"rank\"\n                    value={rankCode}\n                    readOnly\n                    className=\"form-control py-0\"\n                  />\n                </div>\n\n                <div>\n                  <label>From Date</label>\n                  <input\n                    type=\"date\"\n                    name=\"fromDate\"\n                    {...register(\"fromDate\")}\n                    className=\"form-control py-0\"\n                  />\n                  <div className=\"text-red-500\">{errors.fromDate?.message}</div>\n                </div>\n\n                <div>\n                  <label>Basic Pay</label>\n                  <input\n                    type=\"text\"\n                    name=\"basicPay\"\n                    {...register(\"basicPay\")}\n                    className=\"form-control py-0\"\n                  />\n                  <div className=\"text-red-500\">{errors.basicPay?.message}</div>\n                </div>\n              </div>\n            </Tab>\n\n            <Tab eventKey=\"help\" title=\"Help\">\n              <h1>Help</h1>\n              <ul className=\"list-disc\">\n                <li>Point 1</li>\n                <li>Point 2</li>\n              </ul>\n            </Tab>\n          </Tabs>\n\n          <div className=\"px-4\">\n            <button type=\"submit\">Save</button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default withRouter(PayElementEdit);\n"]},"metadata":{},"sourceType":"module"}