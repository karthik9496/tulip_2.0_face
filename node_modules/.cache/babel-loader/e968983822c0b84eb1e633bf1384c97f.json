{"ast":null,"code":"var _jsxFileName = \"/home/itsdc3/Imp Tulip files/falconws160424/falconws/falcon_face/src/components/VerifyImportDo2.js\";\n\n/**\n * Code generated using Python\n * @author Raja Reddy\n * Date : 17 Oct 2021\n *\n * Modified By : \n */\nimport { useState, useEffect } from \"react\";\nimport { withRouter, useParams, useHistory } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport axios from 'axios';\nimport * as yup from \"yup\";\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport LiveSearch from '../utils/LiveSearch'; //import DatePicker  from 'react-datepicker';\n//import \"react-datepicker/dist/react-datepicker.css\";\n//import addDays from 'date-fns/addDays'\n\nimport Tabs from 'react-bootstrap/Tabs';\nimport Tab from 'react-bootstrap/Tab';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst schema = yup.object({//dakType: yup.object().required('Required'),\n  //description: yup.string().required('Required'),\n});\n\nconst VerifyImportDo2 = () => {\n  const {\n    register,\n    handleSubmit,\n    setValue,\n    formState: {\n      errors\n    },\n    clearErrors\n  } = useForm({\n    resolver: yupResolver(schema)\n  });\n  let {\n    id\n  } = useParams();\n  let history = useHistory();\n  const [serverErrors, setServerErrors] = useState([]);\n  const [files, setFiles] = useState({});\n  const [fileList, setFileList] = useState([]);\n  const [fileCount, setFileCount] = useState(0);\n  const [loading, setLoading] = useState(false);\n  const [disabled, setDisabled] = useState(false);\n  const applicationTypeRegex = /application\\/(zip|xml|pdf)/gm;\n  const textTypeRegex = /text\\/(zip|xml|pdf)/gm;\n  useEffect(() => {\n    let fetching = false;\n\n    async function fetchData() {\n      if (!fetching) await axios.get(`/do2Controls/uploadDo2/loadVerifyDo2`).then(response => {\n        setFileList(response.data);\n        setFileCount(response.data.length);\n        console.log(response.data.length);\n      }).catch(error => {\n        //console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n      });\n    }\n\n    fetchData();\n    return () => {\n      fetching = true;\n    };\n  }, []);\n\n  const importDo2 = () => {\n    if (disabled) return;\n    setDisabled(true);\n    setLoading(true);\n    axios.post(\"/do2Controls/writeToDo2Control/all\").then(res => {\n      let fname = res.data; //console.log(res.data);\n      //alert(\"File uploaded successfully.\")\n\n      if (fname != null && fname.length > 0) {\n        axios({\n          url: `/do2Controls/fileDownload/summary/` + fname,\n          method: 'GET',\n          responseType: 'blob' // important\n\n        }).then(res => {\n          //console.log(response.data);\n          const url = URL.createObjectURL(new Blob([res.data], {\n            type: \"application/pdf\"\n          }));\n          const pdfWindow = window.open();\n          pdfWindow.location.href = url;\n          const link = pdfWindow.location.href; //const link = document.createElement('a');\n          //link.href = url;\n\n          try {\n            link.setAttribute('download', fname); //document.body.appendChild(link);\n\n            link.click();\n          } catch (err) {}\n        });\n      }\n\n      setFileList([]);\n      setFileCount(0);\n      setLoading(false);\n      setDisabled(false);\n    }).catch(error => {\n      alert(error.response.data.message);\n      console.log(error.response.data.message);\n      console.log(error.response.status);\n      console.log(error.response.headers);\n      /*\n      if (error.response)\n      \tsetServerErrors(error.response.data.error);\n      else\n      \tsetServerErrors(error.Error);\n      */\n    });\n  };\n\n  const onSubmit = (data, event) => {\n    event.preventDefault();\n\n    if (data.id) {\n      axios.put(\"/billTypes/\" + data.id, data).then(response => {\n        history.push(\"/billTypes\");\n      }).catch(error => {\n        console.log(error.response.data);\n        console.log(error.response.status);\n        console.log(error.response.headers);\n        setServerErrors(error.response.data);\n      });\n    } else {\n      axios.post(\"/billTypes\", data).then(response => {\n        history.push(\"/billTypes\");\n      }).catch(error => {\n        //console.log(error.response.data);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        setServerErrors(error.response.data);\n      });\n    }\n  };\n\n  const onError = (errors, e) => console.log(errors, e); //All foreign keys. \n  // XXXXXX Add search fields and adjust the values as necessary\n\n\n  const errorCallback = err => {\n    //console.log(err);\n    setServerErrors(err);\n  };\n\n  const handleInputChange = e => {//console.log(e.target.value);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gray-100 text-gray-900\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 pt-4\",\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"container\",\n          children: [loading && /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex justify-center items-center\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"spinner-border animate-spin inline-block w-8 h-8 border-4 rounded-full\",\n                role: \"status\",\n                children: /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"visually-hidden\",\n                  children: \"Loading...\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 188,\n                  columnNumber: 5\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 187,\n                columnNumber: 3\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 186,\n              columnNumber: 8\n            }, this)\n          }, void 0, false), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 193,\n            columnNumber: 4\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 193,\n            columnNumber: 9\n          }, this), fileCount > 0 && /*#__PURE__*/_jsxDEV(\"h1\", {\n            children: [\" Verify and Upload to Do2 Control : \", fileCount, \" files available \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 6\n          }, this), fileCount === 0 && /*#__PURE__*/_jsxDEV(\"h1\", {\n            children: \" No files available for verification and upload to Do2 Control\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 198,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-red-500\",\n            children: serverErrors\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: fileList.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n              children: fileList.map((item, idx) => {\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex\",\n                  children: /*#__PURE__*/_jsxDEV(\"li\", {\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex flex-wrap\",\n                      children: /*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"w-400\",\n                        children: [\" \", item]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 212,\n                        columnNumber: 14\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 211,\n                      columnNumber: 14\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 210,\n                    columnNumber: 14\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 209,\n                  columnNumber: 24\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 206,\n              columnNumber: 11\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-40\",\n            children: fileCount > 0 && /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: importDo2,\n              children: \"Verify\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 229,\n              columnNumber: 7\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 6\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 5\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 4\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 180,\n    columnNumber: 4\n  }, this);\n};\n\nexport default withRouter(VerifyImportDo2);","map":{"version":3,"sources":["/home/itsdc3/Imp Tulip files/falconws160424/falconws/falcon_face/src/components/VerifyImportDo2.js"],"names":["useState","useEffect","withRouter","useParams","useHistory","useForm","axios","yup","yupResolver","LiveSearch","Tabs","Tab","schema","object","VerifyImportDo2","register","handleSubmit","setValue","formState","errors","clearErrors","resolver","id","history","serverErrors","setServerErrors","files","setFiles","fileList","setFileList","fileCount","setFileCount","loading","setLoading","disabled","setDisabled","applicationTypeRegex","textTypeRegex","fetching","fetchData","get","then","response","data","length","console","log","catch","error","Error","importDo2","post","res","fname","url","method","responseType","URL","createObjectURL","Blob","type","pdfWindow","window","open","location","href","link","setAttribute","click","err","alert","message","status","headers","onSubmit","event","preventDefault","put","push","onError","e","errorCallback","handleInputChange","map","item","idx"],"mappings":"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","sourcesContent":["/**\n * Code generated using Python\n * @author Raja Reddy\n * Date : 17 Oct 2021\n *\n * Modified By : \n */\n\nimport { useState, useEffect } from \"react\";\nimport { withRouter, useParams, useHistory } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport axios from 'axios';\nimport * as yup from \"yup\";\n\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport LiveSearch from '../utils/LiveSearch';\n\n//import DatePicker  from 'react-datepicker';\n//import \"react-datepicker/dist/react-datepicker.css\";\n//import addDays from 'date-fns/addDays'\n\nimport Tabs from 'react-bootstrap/Tabs'\nimport Tab from 'react-bootstrap/Tab'\n\nconst schema = yup.object({\n\t//dakType: yup.object().required('Required'),\n\t//description: yup.string().required('Required'),\n});\n\n\nconst VerifyImportDo2 = () => {\n\tconst { register, handleSubmit, setValue, formState: { errors }, clearErrors } = useForm({\n\t\tresolver: yupResolver(schema)\n\t});\n\n\tlet { id } = useParams();\n\n\tlet history = useHistory();\n\tconst [serverErrors, setServerErrors] = useState([]);\n\t const [files,setFiles]=useState({});\n\t const [fileList,setFileList]=useState([]);\n\t const [fileCount,setFileCount]=useState(0);\n\t const [loading,setLoading]=useState(false);\n\t const [disabled,setDisabled]=useState(false);\n\t const applicationTypeRegex = /application\\/(zip|xml|pdf)/gm;\n\t \t const textTypeRegex = /text\\/(zip|xml|pdf)/gm;\n\t  \n\t   \n    useEffect(() => {\n\t\tlet fetching = false;\n\t\tasync function fetchData() {\n\t\t\t \n\t\t\tif(!fetching)\n\t\t\tawait axios.get(`/do2Controls/uploadDo2/loadVerifyDo2`)\n\t\t\t\t.then((response) => {\n\t\t\t\t\tsetFileList(response.data);\n\t\t\t\t\tsetFileCount(response.data.length)\n\t\t\t\t\tconsole.log(response.data.length);\n\t\t\t\t\t \n\t\t\t\t\t \n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\t//console.log(error);\n\t\t\t\t\t//console.log(error.response.status);\n\t\t\t\t\t//console.log(error.response.headers);\n\t\t\t\t\tif (error.response)\n\t\t\t\t\t\tsetServerErrors(error.response.data.error);\n\t\t\t\t\telse\n\t\t\t\t\t\tsetServerErrors(error.Error);\n\t\t\t\t})\n\t\t}\n\t\tfetchData();\n\t\treturn () => { fetching = true; }\n\n\t}, []);\n\t \n const importDo2 = () => {\n\t\t if(disabled)\n\t\t \treturn;\n\t\t \t\n\t\t setDisabled(true);\n\t\t setLoading(true);\n\t\t\n\t\taxios.post(\"/do2Controls/writeToDo2Control/all\")\n\t\t.then(res => {\n\t\t\tlet fname=res.data;\n\t\t\t//console.log(res.data);\n\t\t\t//alert(\"File uploaded successfully.\")\n\t\t\tif(fname!=null && fname.length>0){\n\t\t\taxios({\n\t\t\turl: `/do2Controls/fileDownload/summary/` + fname, \n\t\t\tmethod: 'GET',\n\t\t\tresponseType: 'blob', // important\n\t\t}).then((res) => {\n\t\t\t//console.log(response.data);\n\t\t\tconst url =URL.createObjectURL(new Blob([res.data],{type:\"application/pdf\"}));\n\t\t\tconst pdfWindow=window.open();\n\t\t\tpdfWindow.location.href=url;\n\t\t\tconst link=pdfWindow.location.href;\n\t\t\t//const link = document.createElement('a');\n\t\t\t//link.href = url;\n\t\t\ttry{\n\t\t\tlink.setAttribute('download', fname);\n\t\t \n\t\t\t//document.body.appendChild(link);\n\t\t\tlink.click();\n\t\t\t}catch(err){\n\t\t\t\t\n\t\t\t}\n\t\t});\n\t\t}\n\t\t\tsetFileList([]);\n\t\t\tsetFileCount(0);\n\t\t\tsetLoading(false);\n\t\t\tsetDisabled(false);\n\t\t}).catch((error) => {\n\t\t\talert(error.response.data.message)\n\t\t\tconsole.log(error.response.data.message);\n\t\t\tconsole.log(error.response.status);\n\t\t\tconsole.log(error.response.headers);\n\t\t\t/*\n\t\t\tif (error.response)\n\t\t\t\tsetServerErrors(error.response.data.error);\n\t\t\telse\n\t\t\t\tsetServerErrors(error.Error);\n\t\t\t*/\n\t\t})\n\t};\n\t\n\n\n\tconst onSubmit = (data, event) => {\n\t\tevent.preventDefault();\n\t\tif (data.id) {\n\t\t\taxios.put(\"/billTypes/\" + data.id, data)\n\t\t\t\t.then((response) => { \n\t\t\t\t\thistory.push(\"/billTypes\");\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tconsole.log(error.response.data);\n\t\t\t\t\tconsole.log(error.response.status);\n\t\t\t\t\tconsole.log(error.response.headers);\n\t\t\t\t\tsetServerErrors(error.response.data)\n\t\t\t\t});\n\t\t} else {\n\t\t\taxios.post(\"/billTypes\", data)\n\t\t\t\t.then((response) => {\n\t\t\t\t\thistory.push(\"/billTypes\");\n\t\t\t\t })\n\t\t\t\t.catch((error) => {\n\t\t\t\t\t//console.log(error.response.data);\n\t\t\t\t\t//console.log(error.response.status);\n\t\t\t\t\t//console.log(error.response.headers);\n\t\t\t\t\tsetServerErrors(error.response.data)\n\t\t\t\t});\n\t\t}\n\n\t\t\n\t}\n\n\tconst onError = (errors, e) => console.log(errors, e);\n\n\t//All foreign keys. \n\t// XXXXXX Add search fields and adjust the values as necessary\n\t \n\t \n\tconst errorCallback = (err) => {\n\t\t//console.log(err);\n\t\tsetServerErrors(err);\n\t}\n\n\tconst handleInputChange = (e) => {\n\t\t//console.log(e.target.value);\n\t};\n\n\t \n\n\t \n\treturn (\n\t\t\t<div className=\"min-h-screen bg-gray-100 text-gray-900\">\n\t\t\t<div className=\"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 pt-4\">\n\t\t\t\t<form>\n\t\t\t\t<div className=\"container\">\n\t\t\t\t{loading && <>\n\t\t\t\t\t\t \n\t\t\t\t\t\t <div className=\"flex justify-center items-center\">\n  <div className=\"spinner-border animate-spin inline-block w-8 h-8 border-4 rounded-full\" role=\"status\">\n    <span className=\"visually-hidden\">Loading...</span>\n  </div>\n</div>\n\t\t\t\t\t\t</>\t\n\t\t\t\t\t\t}\n\t\t\t<br/><br/>\n\t\t\t\t{fileCount>0 && \n\t\t\t\t\t<h1 > Verify and Upload to Do2 Control : {fileCount} files available </h1>\n\t\t\t\t}\n\t\t\t\t{fileCount===0 && \n\t\t\t\t\t<h1 > No files available for verification and upload to Do2 Control</h1>\n\t\t\t\t}\n\t\t\t\t\t<div className=\"text-red-500\">{serverErrors}</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t \n\t\t\t\t\t\t {\t\t\t \n        fileList.length>0 &&\n          <div>\n            {\n              fileList.map((item,idx) => {\n                return <div className=\"flex\"> \n             <li> \n             <div className=\"flex flex-wrap\">\n             <div className=\"w-400\"> {item}</div>\n             \n                </div></li>\n              </div>\n              })\n            }\n          </div>  \n      }\n \t \n\t\t\t\t\t\t \n\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t \n\n\t\t\t\t\t<div className=\"w-40\">\n\t\t\t\t\t{fileCount>0 && \n\t\t\t\t\t\t<button type=\"button\" onClick={importDo2} >Verify</button>\n\t\t\t\t\t\t}\n\t\t\t\t\t</div>\n</div>\n\t\t\t\t</form>\n\t\t\t\t\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport default withRouter(VerifyImportDo2);"]},"metadata":{},"sourceType":"module"}