{"ast":null,"code":"import _toConsumableArray from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect,useMemo}from\"react\";import Table,{SelectColumnFilter}from\"../utils/Table\";//\nimport axios from\"axios\";import{withRouter,Link,useHistory}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function NdcList(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),update=_useState4[0],setUpdate=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),serverErrors=_useState6[0],setServerErrors=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),search=_useState8[0],setSearch=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),inputText=_useState10[0],setInputText=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),mesg=_useState12[0],setMesg=_useState12[1];useEffect(function(){var fetching=false;function fetchData(){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(fetching){_context.next=3;break;}_context.next=3;return axios.get(\"/ndcs?search=\"+search).then(function(response){setData(response.data);if(response.data!=null){//\tconsole.log(\">>>>>Search CdaoNo---:\" + response.data.cdaoNo);\nsetData(response.data);}}).catch(function(error){//console.log(error);\n//console.log(error.response.status);\n//console.log(error.response.headers);\nif(error.response)setServerErrors(error.response.data.error);else setServerErrors(error.Error);});case 3:case\"end\":return _context.stop();}}},_callee);}));return _fetchData.apply(this,arguments);}fetchData();return function(){fetching=true;};},[update,search]);function approve(_x){return _approve.apply(this,arguments);}function _approve(){_approve=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.put(\"/ndcs/\".concat(id,\"/approve\")).then(function(response){setMesg(response.data);setData([]);}).catch(function(error){console.log(error);//console.log(error.response.status);\n//console.log(error.response.headers);\nif(error.response)setServerErrors(error.response.data.error);else setServerErrors(error.Error);});case 2:case\"end\":return _context2.stop();}}},_callee2);}));return _approve.apply(this,arguments);}function print(_x2){return _print.apply(this,arguments);}function _print(){_print=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return axios.get(\"/ndcs/printNdc/\".concat(id)).then(function(response){//console.log(data);\nvar url=window.open(\"\".concat(process.env.REACT_APP_BASE_URL,\"/files/\").concat(response.data));}).catch(function(error){console.log(error);//console.log(error.response.status);\n//console.log(error.response.headers);\nif(error.response)setServerErrors(error.response.data.error);else setServerErrors(error.Error);});case 2:case\"end\":return _context3.stop();}}},_callee3);}));return _print.apply(this,arguments);}function submit(_x3){return _submit.apply(this,arguments);}function _submit(){_submit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(id){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return axios.put(\"/ndcs/submit/\".concat(id)).then(function(response){//console.log(data);\nsetMesg(response.data);var updatedRecords=_toConsumableArray(data).filter(function(i){return i.id!==id;});//console.log(updatedRecords);\nsetData(updatedRecords);}).catch(function(error){console.log(error);//console.log(error.response.status);\n//console.log(error.response.headers);\nif(error.response)setServerErrors(error.response.data.error);else setServerErrors(error.Error);});case 2:case\"end\":return _context4.stop();}}},_callee4);}));return _submit.apply(this,arguments);}var columns=useMemo(function(){return[{Header:\"Action\",Cell:function Cell(_ref){var row=_ref.row;return/*#__PURE__*/_jsxs(\"div\",{children:[row.original.action!=null&&row.original.action.includes(\"edit\")&&/*#__PURE__*/_jsx(Link,{to:\"/ndcs/\"+row.original.id,children:/*#__PURE__*/_jsx(\"button\",{className:\" w-16 m-0 p-0 \",children:\" Edit \"})}),\" \",row.original.action!=null&&row.original.action.includes(\"edit\")&&row.original.recordStatus!=null&&row.original.recordStatus===\"V\"&&/*#__PURE__*/_jsxs(\"button\",{className:\"w-16 m-0 p-0 bg-red-500 hover:bg-red-700 \",onClick:function onClick(){return submit(row.original.id);},children:[\" \",\"Submit\",\" \"]}),\" \",row.original.action!=null&&row.original.action.includes(\"subm\")&&/*#__PURE__*/_jsxs(\"button\",{className:\"w-16 m-0 p-0 bg-red-500 hover:bg-red-700 \",onClick:function onClick(){return submit(row.original.id);},children:[\" \",\"Submit\",\" \"]}),\" \",row.original.action!=null&&row.original.action.includes(\"appro\")&&/*#__PURE__*/_jsxs(\"button\",{className:\"w-16 m-0 p-0 bg-red-500 hover:bg-red-700 \",onClick:function onClick(){return approve(row.original.id);},children:[\" \",\"Approve\",\" \"]}),\" \",row.original.recordStatus!=null&&row.original.recordStatus===\"V\"&&/*#__PURE__*/_jsxs(\"button\",{className:\"w-20 m-0 p-0 bg-red-500 hover:bg-red-700 \",onClick:function onClick(){return print(row.original.id);},children:[\" \",\"Print NDC\",\" \"]})]});}},{Header:\"CDAONo\",accessor:\"employee.cdaoNo\"},{Header:\"Dak\",accessor:\"dak.dakidNo\"},{Header:\"Month\",accessor:\"me\"// Change this\n},{Header:\"Outstanding Amount\",accessor:\"amountOutstanding\"},{Header:\"Ndc Date\",accessor:\"ndcDate\"},{Header:\"Record Status\",accessor:\"recordStatus\"},{Header:\"Remarks\",accessor:\"remarks\"},{Header:\"Reason\",accessor:\"reason\"}/*\n\t\t{\n\t\t\tHeader: \"Login Name\",\n\t\t\taccessor: 'loginName',\n\t\t\tFilter: SelectColumnFilter,  // new\n\t\t\tfilter: 'includes',\n\t\t},\n\t\t*/];},[data]);var handleKeyPress=function handleKeyPress(event){// look for the `Enter` keyCode\nif(event.keyCode===13||event.which===13){handleSubmit(event);}};var handleSubmit=function handleSubmit(event){event.preventDefault();console.log(inputText);setSearch(inputText);};return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-100 text-gray-900\",children:/*#__PURE__*/_jsxs(\"main\",{className:\"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 pt-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 ml-4\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-semibold\",children:\"NDC List\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flexContainer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"search\",placeholder:\"CDAO No\",onChange:function onChange(e){return setInputText(e.target.value);},onKeyPress:handleKeyPress,className:\"pl-2 -ml-2 inputField flex-initial\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",onClick:handleSubmit,className:\"w-16 m-0 p-0\",children:\"Search\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Link,{to:\"/ndcs/approvedList\",children:/*#__PURE__*/_jsx(\"button\",{className:\" w-32 ml-8 p-0 h-6 -mt-2\",children:\"Processed \"})})})]})]}),mesg,/*#__PURE__*/_jsx(\"div\",{className:\"-mt-2 max-h-1 py-0\",children:/*#__PURE__*/_jsx(Table,{columns:columns,data:data,className:\"table-auto\"})})]})});}export default withRouter(NdcList);","map":{"version":3,"sources":["/home/itsdcsec/falconws/falcon_face/src/components/NdcList.js"],"names":["useState","useEffect","useMemo","Table","SelectColumnFilter","axios","withRouter","Link","useHistory","NdcList","data","setData","update","setUpdate","serverErrors","setServerErrors","search","setSearch","inputText","setInputText","mesg","setMesg","fetching","fetchData","get","then","response","catch","error","Error","approve","id","put","console","log","print","url","window","open","process","env","REACT_APP_BASE_URL","submit","updatedRecords","filter","i","columns","Header","Cell","row","original","action","includes","recordStatus","accessor","handleKeyPress","event","keyCode","which","handleSubmit","preventDefault","e","target","value"],"mappings":"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","sourcesContent":["import { useState, useEffect, useMemo } from \"react\";\n\nimport Table, { SelectColumnFilter } from \"../utils/Table\"; //\nimport axios from \"axios\";\nimport { withRouter, Link, useHistory } from \"react-router-dom\";\n\nfunction NdcList() {\n  const [data, setData] = useState([]);\n  const [update, setUpdate] = useState(false);\n  const [serverErrors, setServerErrors] = useState([]);\n  const [search, setSearch] = useState(\"\");\n  const [inputText, setInputText] = useState(\"\");\n  const [mesg, setMesg] = useState(\"\");\n\n  useEffect(() => {\n    let fetching = false;\n    async function fetchData() {\n      if (!fetching)\n        await axios\n          .get(\"/ndcs?search=\" + search)\n          .then((response) => {\n            setData(response.data);\n            if (response.data != null) {\n              //\tconsole.log(\">>>>>Search CdaoNo---:\" + response.data.cdaoNo);\n              setData(response.data);\n            }\n          })\n          .catch((error) => {\n            //console.log(error);\n            //console.log(error.response.status);\n            //console.log(error.response.headers);\n            if (error.response) setServerErrors(error.response.data.error);\n            else setServerErrors(error.Error);\n          });\n    }\n    fetchData();\n    return () => {\n      fetching = true;\n    };\n  }, [update, search]);\n\n  async function approve(id) {\n    await axios\n      .put(`/ndcs/${id}/approve`)\n      .then((response) => {\n        setMesg(response.data);\n        setData([]);\n      })\n      .catch((error) => {\n        console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        if (error.response) setServerErrors(error.response.data.error);\n        else setServerErrors(error.Error);\n      });\n  }\n\n  async function print(id) {\n    await axios\n      .get(`/ndcs/printNdc/${id}`)\n      .then((response) => {\n        //console.log(data);\n        const url = window.open(\n          `${process.env.REACT_APP_BASE_URL}/files/${response.data}`\n        );\n      })\n      .catch((error) => {\n        console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        if (error.response) setServerErrors(error.response.data.error);\n        else setServerErrors(error.Error);\n      });\n  }\n  async function submit(id) {\n    await axios\n      .put(`/ndcs/submit/${id}`)\n      .then((response) => {\n        //console.log(data);\n        setMesg(response.data);\n        let updatedRecords = [...data].filter((i) => i.id !== id);\n        //console.log(updatedRecords);\n        setData(updatedRecords);\n      })\n      .catch((error) => {\n        console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        if (error.response) setServerErrors(error.response.data.error);\n        else setServerErrors(error.Error);\n      });\n  }\n\n  const columns = useMemo(\n    () => [\n      {\n        Header: \"Action\",\n        Cell: ({ row }) => (\n          <div>\n            {row.original.action != null &&\n              row.original.action.includes(\"edit\") && (\n                <Link to={\"/ndcs/\" + row.original.id}>\n                  <button className=\" w-16 m-0 p-0 \"> Edit </button>\n                </Link>\n              )}{\" \"}\n            {row.original.action != null &&\n              row.original.action.includes(\"edit\") &&\n              row.original.recordStatus != null &&\n              row.original.recordStatus === \"V\" && (\n                <button\n                  className=\"w-16 m-0 p-0 bg-red-500 hover:bg-red-700 \"\n                  onClick={() => submit(row.original.id)}\n                >\n                  {\" \"}\n                  Submit{\" \"}\n                </button>\n              )}{\" \"}\n            {row.original.action != null &&\n              row.original.action.includes(\"subm\") && (\n                <button\n                  className=\"w-16 m-0 p-0 bg-red-500 hover:bg-red-700 \"\n                  onClick={() => submit(row.original.id)}\n                >\n                  {\" \"}\n                  Submit{\" \"}\n                </button>\n              )}{\" \"}\n            {row.original.action != null &&\n              row.original.action.includes(\"appro\") && (\n                <button\n                  className=\"w-16 m-0 p-0 bg-red-500 hover:bg-red-700 \"\n                  onClick={() => approve(row.original.id)}\n                >\n                  {\" \"}\n                  Approve{\" \"}\n                </button>\n              )}{\" \"}\n            {row.original.recordStatus != null &&\n              row.original.recordStatus === \"V\" && (\n                <button\n                  className=\"w-20 m-0 p-0 bg-red-500 hover:bg-red-700 \"\n                  onClick={() => print(row.original.id)}\n                >\n                  {\" \"}\n                  Print NDC{\" \"}\n                </button>\n              )}\n          </div>\n        ),\n      },\n\n      {\n        Header: \"CDAONo\",\n        accessor: \"employee.cdaoNo\",\n      },\n      {\n        Header: \"Dak\",\n        accessor: \"dak.dakidNo\",\n      },\n\n      {\n        Header: \"Month\",\n        accessor: \"me\", // Change this\n      },\n\n      {\n        Header: \"Outstanding Amount\",\n        accessor: \"amountOutstanding\",\n      },\n      {\n        Header: \"Ndc Date\",\n        accessor: \"ndcDate\",\n      },\n\n      {\n        Header: \"Record Status\",\n        accessor: \"recordStatus\",\n      },\n      {\n        Header: \"Remarks\",\n        accessor: \"remarks\",\n      },\n      {\n        Header: \"Reason\",\n        accessor: \"reason\",\n      },\n\n      /*\n\t\t{\n\t\t\tHeader: \"Login Name\",\n\t\t\taccessor: 'loginName',\n\t\t\tFilter: SelectColumnFilter,  // new\n\t\t\tfilter: 'includes',\n\t\t},\n\t\t*/\n    ],\n    [data]\n  );\n\n  const handleKeyPress = (event) => {\n    // look for the `Enter` keyCode\n    if (event.keyCode === 13 || event.which === 13) {\n      handleSubmit(event);\n    }\n  };\n\n  const handleSubmit = (event) => {\n    event.preventDefault();\n    console.log(inputText);\n    setSearch(inputText);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-100 text-gray-900\">\n      <main className=\"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 pt-4\">\n        <div className=\"mt-2 ml-4\">\n          <h1 className=\"text-xl font-semibold\">NDC List</h1>\n          <div className=\"flexContainer\">\n            <input\n              type=\"text\"\n              name=\"search\"\n              placeholder=\"CDAO No\"\n              onChange={(e) => setInputText(e.target.value)}\n              onKeyPress={handleKeyPress}\n              className=\"pl-2 -ml-2 inputField flex-initial\"\n            />\n            <button\n              type=\"submit\"\n              onClick={handleSubmit}\n              className=\"w-16 m-0 p-0\"\n            >\n              Search\n            </button>\n            <div>\n              <Link to={\"/ndcs/approvedList\"}>\n                <button className=\" w-32 ml-8 p-0 h-6 -mt-2\">Processed </button>\n              </Link>\n            </div>\n          </div>\n        </div>\n        {mesg}\n        <div className=\"-mt-2 max-h-1 py-0\">\n          <Table columns={columns} data={data} className=\"table-auto\" />\n        </div>\n      </main>\n    </div>\n  );\n}\n\nexport default withRouter(NdcList);\n"]},"metadata":{},"sourceType":"module"}