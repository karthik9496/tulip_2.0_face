{"ast":null,"code":"import _defineProperty from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/**\n * Code generated using Python\n * @author Raja Reddy\n * Date : 17 Oct 2021\n *\n * Modified By : \n */import{useState,useEffect,useRef}from\"react\";import{withRouter,useParams,useHistory}from\"react-router-dom\";import{useForm}from\"react-hook-form\";import axios from'axios';import*as yup from\"yup\";import{yupResolver}from'@hookform/resolvers/yup';import LiveSearch from'../utils/LiveSearch';import DatePicker from'react-datepicker';import\"react-datepicker/dist/react-datepicker.css\";import addDays from'date-fns/addDays';import Tabs from'react-bootstrap/Tabs';import Tab from'react-bootstrap/Tab';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var schema=yup.object({employee:yup.object().required('Required'),demandDate:yup.date().required('Required')});var DemandRegisterManualEdit=function DemandRegisterManualEdit(){var _errors$employee,_errors$authorityNo,_errors$authorityDate,_errors$journeyFromDa,_errors$amount,_errors$value,_errors$value2,_errors$demandDate;var _useForm=useForm({resolver:yupResolver(schema)}),register=_useForm.register,handleSubmit=_useForm.handleSubmit,setValue=_useForm.setValue,errors=_useForm.formState.errors,clearErrors=_useForm.clearErrors;var _useParams=useParams(),id=_useParams.id;//console.log(id);\nvar history=useHistory();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),serverErrors=_useState2[0],setServerErrors=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),entity=_useState4[0],setEntity=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),state=_useState6[0],setState=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),loading=_useState8[0],setLoading=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),empId=_useState10[0],setEmpId=_useState10[1];useEffect(function(){var isCancelled=false;console.log(id);if(id!=='new'){function fetchData(){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var record,fields;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:record='';_context.next=3;return axios.get('/demandRegisters/manualDemand/'+id).then(function(response){record=response.data;}).catch(function(error){//console.log(error);\n//console.log(error.response.status);\n//console.log(error.response.headers);\nif(error.response)setServerErrors(error.response.data.error);else setServerErrors(error.Error);});case 3:fields=['id','dak','employee','cdaoNo','checkDigit','settlementDak','unit','advanceType','amount','demandDate','demandMonth','demandOrigin','authorityNo','value1','value2','authorityDate','cdrNo','demandApproved','reason','settled','journeyStartDate','email','auditorDemandDate','aaoDemandDate','aoDemandDate','recordStatus'];fields.forEach(function(field){return setValue(field,record[field]);});if(!isCancelled){setEntity(record);setState(function(prev){return _objectSpread(_objectSpread({},prev),{},{state:record});});}case 6:case\"end\":return _context.stop();}}},_callee);}));return _fetchData.apply(this,arguments);}fetchData();return function(){isCancelled=true;};}},[id,setValue]);var onSubmit=function onSubmit(data,event){event.preventDefault();console.log(\"777777777:\"+data);if(data.id){axios.put(\"/demandRegisters/newDemand/\"+data.id,data).then(function(response){history.push(\"/demandRegisters/newDemand/showManual\");}).catch(function(error){//console.log(error.response.data);\n//console.log(\"response--------\"+error.response.status);\nsetServerErrors(error.response.data['reason']);});}};var onError=function onError(errors,e){return console.log(errors,e);};//All foreign keys. \n// XXXXXX Add search fields and adjust the values as necessary\nvar parentData={employee:{title:\"Employee\",url:\"employees\",searchList:['cdaoNo','officerName'],//XXXXXXXXX Add search fields\nfkEntity:\"employee\",preload:false//XXXXXX Set this to true for small tables like designations\n}};//Callback for child components (Foreign Keys)\nvar callback=function callback(childData){setEntity(function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},childData.fk,childData.entity));});setValue(childData.fk,childData.entity);//console.log(errors);\n// console.log(childData.fk+\"--\"+childData.entity.id);\nif(childData.fk==='employee')setEmpId(childData.entity.id);clearErrors(childData.fk);};var errorCallback=function errorCallback(err){//console.log(err);\nsetServerErrors(err);};var handleButtonClick=function handleButtonClick(e){history.push(\"/demandRegisters\");};var handleInputChange=function handleInputChange(e){console.log(e.target.value);//\tconsole.log(\"handle input change\");\n};var handleInputCdrChange=function handleInputCdrChange(e){console.log(e.target.value);setValue('cdrNo',e.target.value);//\tconsole.log(\"handle input change\");\n};var handleInputDemandOriginChange=function handleInputDemandOriginChange(e){console.log(e.target.value);setValue('demandOrigin',e.target.value);//\tconsole.log(\"handle input change\");\n};return/*#__PURE__*/_jsx(\"div\",{className:\"max-w-xl mx-auto \",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-full w-3/4  mx-auto \",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit,onError),children:[/*#__PURE__*/_jsxs(\"h1\",{children:[id==='new'?'Add':'Edit',\" Demand Register\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:serverErrors}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-0 \",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(LiveSearch,{name:\"employee\",onChange:handleInputChange,parentData:parentData.employee,parentCallback:callback,fkEntity:entity.employee,errCallback:errorCallback}),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500 \",children:(_errors$employee=errors.employee)===null||_errors$employee===void 0?void 0:_errors$employee.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"VR No\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"text\",name:\"authorityNo\"},register(\"authorityNo\"))),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$authorityNo=errors.authorityNo)===null||_errors$authorityNo===void 0?void 0:_errors$authorityNo.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"VR Date\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"date\",name:\"authorityDate\"},register(\"authorityDate\")),{},{className:\"form-control py-0\"})),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$authorityDate=errors.authorityDate)===null||_errors$authorityDate===void 0?void 0:_errors$authorityDate.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Type of Demand\"}),/*#__PURE__*/_jsxs(\"select\",_objectSpread(_objectSpread({name:\"cdrNo\",className:\"form-control py-0\",onChange:handleInputCdrChange},register(\"cdrNo\")),{},{children:[/*#__PURE__*/_jsx(\"option\",{value:\"select\",children:\"--Select--\"}),/*#__PURE__*/_jsx(\"option\",{value:\"TADATD\",children:\"Temporary Duty\"},\"1\"),/*#__PURE__*/_jsx(\"option\",{value:\"TADAPT\",children:\"Permanent Duty\"},\"2\"),/*#__PURE__*/_jsx(\"option\",{value:\"LTC\",children:\"LTC\"},\"3\")]}))]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"From Date\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"date\",name:\"journeyFromDate\"},register(\"journeyFromDate\")),{},{className:\"form-control py-0\"})),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$journeyFromDa=errors.journeyFromDate)===null||_errors$journeyFromDa===void 0?void 0:_errors$journeyFromDa.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Advance Amount\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"text\",name:\"amount\"},register(\"amount\"))),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$amount=errors.amount)===null||_errors$amount===void 0?void 0:_errors$amount.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"From Station\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"text\",name:\"value1\"},register(\"value1\"))),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$value=errors.value1)===null||_errors$value===void 0?void 0:_errors$value.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"To Station\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"text\",name:\"value2\"},register(\"value2\"))),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$value2=errors.value2)===null||_errors$value2===void 0?void 0:_errors$value2.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Demand Origin\"}),/*#__PURE__*/_jsxs(\"select\",_objectSpread(_objectSpread({name:\"demandOrigin\",className:\"form-control py-0\",onChange:handleInputDemandOriginChange},register(\"demandOrigin\")),{},{children:[/*#__PURE__*/_jsx(\"option\",{value:\"select\",children:\"--Select--\"}),/*#__PURE__*/_jsx(\"option\",{value:\"PCDA Hqrs\",children:\"PCDA Hqrs\"},\"1\"),/*#__PURE__*/_jsx(\"option\",{value:\"LPC\",children:\"LPC\"},\"2\"),/*#__PURE__*/_jsx(\"option\",{value:\"OTHERS\",children:\"Others\"},\"3\")]}))]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Date of Advance\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"date\",name:\"demandDate\"},register(\"demandDate\")),{},{className:\"form-control py-0\"})),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$demandDate=errors.demandDate)===null||_errors$demandDate===void 0?void 0:_errors$demandDate.message})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-0\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-2\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Save\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"px-2\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleButtonClick,children:\"Cancel\"})})]})]})})});};export default withRouter(DemandRegisterManualEdit);","map":{"version":3,"sources":["/home/itsdcsec/falconws/falcon_face/src/components/DemandRegisterManualEdit.js"],"names":["useState","useEffect","useRef","withRouter","useParams","useHistory","useForm","axios","yup","yupResolver","LiveSearch","DatePicker","addDays","Tabs","Tab","schema","object","employee","required","demandDate","date","DemandRegisterManualEdit","resolver","register","handleSubmit","setValue","errors","formState","clearErrors","id","history","serverErrors","setServerErrors","entity","setEntity","state","setState","loading","setLoading","empId","setEmpId","isCancelled","console","log","fetchData","record","get","then","response","data","catch","error","Error","fields","forEach","field","prev","onSubmit","event","preventDefault","put","push","onError","e","parentData","title","url","searchList","fkEntity","preload","callback","childData","fk","errorCallback","err","handleButtonClick","handleInputChange","target","value","handleInputCdrChange","handleInputDemandOriginChange","message","authorityNo","authorityDate","journeyFromDate","amount","value1","value2"],"mappings":"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","sourcesContent":["/**\n * Code generated using Python\n * @author Raja Reddy\n * Date : 17 Oct 2021\n *\n * Modified By : \n */\n\nimport { useState, useEffect, useRef } from \"react\";\nimport { withRouter, useParams, useHistory } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport axios from 'axios';\nimport * as yup from \"yup\";\n\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport LiveSearch from '../utils/LiveSearch';\n\nimport DatePicker from 'react-datepicker';\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport addDays from 'date-fns/addDays'\n\nimport Tabs from 'react-bootstrap/Tabs'\nimport Tab from 'react-bootstrap/Tab'\n\n\nconst schema = yup.object({\n\t \n\temployee: yup.object().required('Required'),\n\tdemandDate:yup.date().required('Required'), \n\t \n});\n\n \n\nconst DemandRegisterManualEdit = () => {\n\tconst { register, handleSubmit, setValue, formState: { errors }, clearErrors } = useForm({\n\t\tresolver: yupResolver(schema)\n\t});\n\n\tlet { id } = useParams();\n\t//console.log(id);\n\n\tlet history = useHistory();\n \n\tconst [serverErrors, setServerErrors] = useState([]);\n\tconst [entity, setEntity] = useState({});\n\tconst [state, setState] = useState({});\n\tconst [loading, setLoading] = useState(true);\n\tconst [empId,setEmpId]=useState(0);\n\t \n \n\t\n\n\tuseEffect(() => {\n\t\tlet isCancelled = false;\n\t\tconsole.log(id);\n\t\tif (id !== 'new') {\n\t\t\tasync function fetchData() {\n\t\t\t\tlet record = '';\n\t\t\t\tawait axios.get('/demandRegisters/manualDemand/' + id)\n\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\trecord = response.data;\n\t\t\t\t\t})\n\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t//console.log(error);\n\t\t\t\t\t\t//console.log(error.response.status);\n\t\t\t\t\t\t//console.log(error.response.headers);\n\t\t\t\t\t\tif (error.response)\n\t\t\t\t\t\t\tsetServerErrors(error.response.data.error);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tsetServerErrors(error.Error);\n\t\t\t\t\t});\n   \n     \n\t\t\t\tconst fields = [\n\t\t\t\t\t'id', 'dak', 'employee', 'cdaoNo', 'checkDigit', 'settlementDak', 'unit', 'advanceType',\n\t\t\t\t\t'amount', 'demandDate', 'demandMonth', 'demandOrigin', 'authorityNo','value1','value2',\n\t\t\t\t\t'authorityDate', 'cdrNo', 'demandApproved', 'reason', 'settled', 'journeyStartDate',\n\t\t\t\t\t'email', 'auditorDemandDate', 'aaoDemandDate', 'aoDemandDate', 'recordStatus'\n\t\t\t\t];\n\t\t\t\t\n\t\t\t\t \n\t\t\t\t \n\t\t\t\tfields.forEach(field => setValue(field, record[field]));\n\t\t\t\tif (!isCancelled) {\n\t\t\t\t\tsetEntity(record);\n\t\t\t\t\t \n\t\t\t\t\tsetState(prev => ({ ...prev, state: record }));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfetchData();\n\t\t\treturn () => {\n\t\t\t\tisCancelled = true;\n\t\t\t};\n\t\t}\n\n\t}, [id, setValue]);\n\n\n\t \n\tconst onSubmit = (data, event,) => {\n\t\tevent.preventDefault();\n\t\tconsole.log(\"777777777:\"+data);\n\t\tif (data.id) {\n\t\t\taxios.put(\"/demandRegisters/newDemand/\" + data.id, data)\n\t\t\t\t.then((response) => { \n\t\t\t\t\t history.push(\"/demandRegisters/newDemand/showManual\");\n\t\t\t\t\t \n\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\t//console.log(error.response.data);\n\t\t\t\t\t//console.log(\"response--------\"+error.response.status);\n\t\t\t\t \n\t\t\t\t\tsetServerErrors(error.response.data['reason']);\n\t\t\t\t});\n\t \n\t\t} \n\n\t\t \n\t}\n\n\t \n\n\tconst onError = (errors, e) => console.log(errors, e);\n\n\t//All foreign keys. \n\t// XXXXXX Add search fields and adjust the values as necessary\n\tconst parentData = {\n\n\t\t \n\t\t \n\t\t \n\t\temployee: {\n\t\t\ttitle: \"Employee\",\n\t\t\turl: \"employees\",\n\t\t\tsearchList: ['cdaoNo', 'officerName'], //XXXXXXXXX Add search fields\n\t\t\tfkEntity: \"employee\",\n\t\t\tpreload: false, //XXXXXX Set this to true for small tables like designations\n\t\t},\n\t\t\n\t\t \n\t\t \n\t}\n \n\t//Callback for child components (Foreign Keys)\n\t \n\tconst callback = (childData) => {\n\t\t\n\t\tsetEntity(prev => ({ ...prev, [childData.fk]: childData.entity }));\n\t\tsetValue(childData.fk, childData.entity);\n\t\t//console.log(errors);\n\t\t// console.log(childData.fk+\"--\"+childData.entity.id);\n\t\t \n\t\tif(childData.fk==='employee')\n\t\t\tsetEmpId(childData.entity.id)\n\t\t\t\n\t\t \n\t\t\t\n\t\tclearErrors(childData.fk);\n\t\t \n\t};\n\n\tconst errorCallback = (err) => {\n\t\t//console.log(err);\n\t\tsetServerErrors(err);\n\t}\n\t\n\tconst handleButtonClick = (e) =>{\n\t\thistory.push(\"/demandRegisters\");\n\t}\n\t\n\t \n\n\tconst handleInputChange = (e) => {\n\t\tconsole.log(e.target.value);\n\t//\tconsole.log(\"handle input change\");\n\t\t \n\t\t\n\t};\n\t\n\tconst handleInputCdrChange = (e) => {\n\t\tconsole.log(e.target.value);\n\t\tsetValue('cdrNo',e.target.value);\n\t//\tconsole.log(\"handle input change\");\n\t\t \n\t\t\n\t};\t \n\t\n\tconst handleInputDemandOriginChange = (e) => {\n\t\tconsole.log(e.target.value);\n\t\tsetValue('demandOrigin',e.target.value);\n\t//\tconsole.log(\"handle input change\");\n\t\t \n\t\t\n\t}; \n\t   \n\treturn (\n\t\t<div className=\"max-w-xl mx-auto \">\n\t\t\t<div className=\"w-full w-3/4  mx-auto \" >\n\n\t\t\t\t<form onSubmit={handleSubmit(onSubmit, onError)}>\n\t\t\t\t\t<h1 >{id === 'new' ? 'Add' : 'Edit'} Demand Register</h1>\n\t\t\t\t\t<div className=\"text-red-500\">{serverErrors}</div>\n\t\t\t\t\t \n\n\t\t\t\t\t \n\t\t\t\t\t\t\t<div className=\"grid grid-cols-2 gap-0 \">\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t  \n\n\t\t\t\t\t\t\t\t<div >\n\t\t\t\t\t\t\t\t\t<LiveSearch name=\"employee\" onChange={handleInputChange}\n\t\t\t\t\t\t\t\t\t\tparentData={parentData.employee} parentCallback={callback}\n\t\t\t\t\t\t\t\t\t\tfkEntity={entity.employee} errCallback={errorCallback} />\n\t\t\t\t\t\t\t\t\t<div className=\"text-red-500 \">{errors.employee?.message}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t <div>\n\t\t\t\t\t\t\t\t\t<label>VR No</label>\n\t\t\t\t\t\t\t\t\t<input type=\"text\"    name=\"authorityNo\" {...register(\"authorityNo\")}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<div className=\"text-red-500\">{errors.authorityNo?.message}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<label>VR Date</label>\n\t\t\t\t\t\t\t\t\t<input type=\"date\" name=\"authorityDate\" {...register(\"authorityDate\")}\n\t\t\t\t\t\t\t\t\t\tclassName=\"form-control py-0\"/>\n\t\t\t\t\t\t\t\t\t<div className=\"text-red-500\">{errors.authorityDate?.message}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<label>Type of Demand</label>\n\t\t\t\t\t\t\t\t\t\t<select name=\"cdrNo\" className=\"form-control py-0\" onChange={handleInputCdrChange} {...register(\"cdrNo\")}>\n\t\t\t\t\t\t\t\t\t\t\t<option value=\"select\">--Select--</option>\n\t\t\t\t\t\t\t\t\t\t\t<option key=\"1\" value=\"TADATD\">Temporary Duty</option>\n\t\t\t\t\t\t\t\t\t\t\t<option key=\"2\" value=\"TADAPT\">Permanent Duty</option>\n\t\t\t\t\t\t\t\t\t\t\t<option key=\"3\" value=\"LTC\">LTC</option>\n\t\t\t\t\t\t\t\t\t\t\t{/* <option key=\"4\" value=\"TAPTREC\">Recovery-Permanent Transfer</option>\n\t\t\t\t\t\t\t\t\t\t\t<option key=\"5\" value=\"TADAREC\">Recovery-Temporary Duty</option>\n\t\t\t\t\t\t\t\t\t\t\t<option key=\"5\" value=\"LTCREC\">Recovery-LTC</option> */}\n\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t  \n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t \t<div>\n\t\t\t\t\t\t\t\t\t<label>From Date</label>\n\t\t\t\t\t\t\t\t\t<input type=\"date\" name=\"journeyFromDate\" {...register(\"journeyFromDate\")}\n\t\t\t\t\t\t\t\t\t\tclassName=\"form-control py-0\"/>\n\t\t\t\t\t\t\t\t\t<div className=\"text-red-500\">{errors.journeyFromDate?.message}</div>\n\t\t\t\t\t\t\t\t</div>\t\t \n\t\t\t\t\t\t\t\t  \n \t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<label>Advance Amount</label>\n\t\t\t\t\t\t\t\t\t<input type=\"text\"    name=\"amount\" {...register(\"amount\")}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<div className=\"text-red-500\">{errors.amount?.message}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<label>From Station</label>\n\t\t\t\t\t\t\t\t\t<input type=\"text\"    name=\"value1\" {...register(\"value1\")}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<div className=\"text-red-500\">{errors.value1?.message}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<label>To Station</label>\n\t\t\t\t\t\t\t\t\t<input type=\"text\"    name=\"value2\" {...register(\"value2\")}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<div className=\"text-red-500\">{errors.value2?.message}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<label>Demand Origin</label>\n\t\t\t\t\t\t\t\t\t\t<select name=\"demandOrigin\" className=\"form-control py-0\" onChange={handleInputDemandOriginChange} {...register(\"demandOrigin\")}>\n\t\t\t\t\t\t\t\t\t\t\t<option value=\"select\">--Select--</option>\n\t\t\t\t\t\t\t\t\t\t\t<option key=\"1\" value=\"PCDA Hqrs\">PCDA Hqrs</option>\n\t\t\t\t\t\t\t\t\t\t\t<option key=\"2\" value=\"LPC\">LPC</option>\n\t\t\t\t\t\t\t\t\t\t\t<option key=\"3\" value=\"OTHERS\">Others</option>\n\t\t\t\t\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<label>Date of Advance</label>\n\t\t\t\t\t\t\t\t\t<input type=\"date\" name=\"demandDate\" {...register(\"demandDate\")}\n\t\t\t\t\t\t\t\t\t\tclassName=\"form-control py-0\"/>\n\t\t\t\t\t\t\t\t\t<div className=\"text-red-500\">{errors.demandDate?.message}</div>\n\t\t\t\t\t\t\t\t</div>\t\t\n\t\t\t\t\t\t\t \n</div>\n\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t<div className=\"grid grid-cols-2 gap-0\">\n\t\t\t\t\t\t\t\t<div className=\"px-2\">\n\t\t\t\t\t\t<button type=\"submit\" >Save</button>   \n\t\t\t\t\t</div>\n\t\t\t\t\t\t \n\t\t\t\t<div className=\"px-2\">\n\t\t\t\t<button type=\"button\" onClick={handleButtonClick} >Cancel</button>\n\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t \n\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n \n\nexport default withRouter(DemandRegisterManualEdit);"]},"metadata":{},"sourceType":"module"}