{"ast":null,"code":"var _jsxFileName = \"/home/itsdcsec/falconws/falcon_face/src/components/UsrEdit.js\";\n\n/**\n Code generated using Python\n @author Raja Reddy\n Date : 13 Oct 2021\n\n */\nimport { useState, useEffect } from \"react\";\nimport { withRouter, useParams, useHistory } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport axios from \"axios\";\nimport * as yup from \"yup\";\nimport { yupResolver } from \"@hookform/resolvers/yup\";\nimport LiveSearch from \"../utils/LiveSearch\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst schema = yup.object({\n  usrName: yup.string().required(\"User Name is required.\"),\n  accountNo: yup.string().required(\"Account no. is required\"),\n  loginName: yup.string().required(\"Login Name is required\"),\n  designation: yup.object().required(\"Designation is required\") //password: yup.string(),\n  //password2: yup.mixed().oneOf([yup.ref('password'), null], 'Passwords must match')\n  //age: yup.number().positive().integer().required(),\n\n}).required();\n\nconst UsrEdit = () => {\n  var _errors$usrName, _errors$accountNo, _errors$loginName, _errors$designation, _errors$section, _errors$phone, _errors$phone2, _errors$email;\n\n  //const { register, handleSubmit, reset, setValue, getValues, formState: { errors }, clearErrors } = useForm({\n  const {\n    register,\n    handleSubmit,\n    setValue,\n    formState: {\n      errors\n    },\n    clearErrors\n  } = useForm({\n    resolver: yupResolver(schema)\n  });\n  let {\n    id\n  } = useParams(); //console.log(id);\n\n  let history = useHistory();\n  const [serverErrors, setServerErrors] = useState([]);\n  const [entity, setEntity] = useState({});\n  const [state, setState] = useState({});\n  useEffect(() => {\n    let isCancelled = false;\n    console.log(id);\n\n    if (id !== \"new\") {\n      async function fetchData() {\n        let record = \"\";\n        await axios.get(\"/usrs/\" + id).then(response => {\n          record = response.data;\n        }).catch(error => {\n          //console.log(error);\n          //console.log(error.response.status);\n          //console.log(error.response.headers);\n          if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n        });\n        const fields = [\"id\", \"usrName\", \"accountNo\", \"loginName\", \"designation\", \"gender\", \"section\", \"phone1\", \"phone2\", \"phone3\", \"email\", \"enabled\"];\n        fields.forEach(field => setValue(field, record[field]));\n\n        if (!isCancelled) {\n          setEntity(record);\n          setState(prev => ({ ...prev,\n            state: record\n          }));\n        }\n      }\n\n      fetchData();\n      return () => {\n        isCancelled = true;\n      };\n    }\n  }, [id]);\n\n  const onSubmit = (data, event) => {\n    event.preventDefault();\n    console.log(data);\n\n    if (data.id) {\n      axios.put(\"/usrs/\" + data.id, data).then(response => {\n        if (response.status === 200) history.push(\"/usrs\");\n      }).catch(error => {\n        //console.log(error.response.data);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        setServerErrors(error.response.data);\n      });\n    } else {\n      axios.post(\"/usrs\", data).then(response => {\n        if (response.status === 200) history.push(\"/usrs\");\n      }).catch(error => {\n        if (error.response.status == 400) setServerErrors(\"Record already exists\"); //console.log(error.response.data);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        else setServerErrors(error.response.data);\n      });\n    }\n  };\n\n  const onError = (errors, e) => console.log(errors, e); //All foreign keys\n\n\n  const parentData = {\n    designation: {\n      title: \"Designation\",\n      url: \"designations\",\n      searchList: [\"abbr\"],\n      fkEntity: \"designation\",\n      preload: false\n    },\n    section: {\n      title: \"Section\",\n      url: \"sections\",\n      searchList: [\"sectionName\"],\n      fkEntity: \"section\",\n      preload: false\n    }\n  }; //Callback for child components (Foreign Keys)\n\n  const callback = childData => {\n    //console.log(\"Parent Callback\");\n    setEntity(prev => ({ ...prev,\n      [childData.fk]: childData.entity\n    }));\n    setValue(childData.fk, childData.entity);\n    console.log(errors);\n    clearErrors(childData.fk);\n  };\n\n  const errorCallback = err => {\n    //console.log(err);\n    setServerErrors(err);\n  }; //console.log(entity);\n\n\n  const handleInputChange = e => {\n    console.log(e.target.value);\n    console.log(entity.gender); //console.log(gender);\n\n    setValue(\"entity.gender\", e.target.value);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-xl mx-auto \",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full w-3/4  mx-auto \",\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit(onSubmit, onError),\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: [id === \"new\" ? \"Add\" : \"Edit\", \" User \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-red-500\",\n          children: serverErrors\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-2 gap-0\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"User Name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 181,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"usrName\",\n              ...register(\"usrName\"),\n              className: \"form-control py-0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 182,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-red-500\",\n              children: (_errors$usrName = errors.usrName) === null || _errors$usrName === void 0 ? void 0 : _errors$usrName.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 188,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \" \",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Account No.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 192,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"accountNo\",\n              ...register(\"accountNo\"),\n              className: \"form-control py-0 \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 193,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-red-500\",\n              children: (_errors$accountNo = errors.accountNo) === null || _errors$accountNo === void 0 ? void 0 : _errors$accountNo.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 199,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Login Name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 203,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"loginName\",\n              ...register(\"loginName\"),\n              className: \"form-control py-0 \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-red-500\",\n              children: (_errors$loginName = errors.loginName) === null || _errors$loginName === void 0 ? void 0 : _errors$loginName.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 210,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(LiveSearch, {\n              name: \"designation\",\n              onChange: handleInputChange,\n              parentData: parentData.designation,\n              parentCallback: callback,\n              fkEntity: entity.designation,\n              errCallback: errorCallback\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 214,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-red-500 \",\n              children: (_errors$designation = errors.designation) === null || _errors$designation === void 0 ? void 0 : _errors$designation.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 222,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 213,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(LiveSearch, {\n              name: \"section\",\n              onChange: handleInputChange,\n              parentData: parentData.section,\n              parentCallback: callback,\n              fkEntity: entity.section,\n              errCallback: errorCallback\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-red-500\",\n              children: (_errors$section = errors.section) === null || _errors$section === void 0 ? void 0 : _errors$section.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 234,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Gender\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 238,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"radio\",\n              value: \"F\",\n              name: \"gender\",\n              ...register(\"gender\"),\n              onChange: handleInputChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 239,\n              columnNumber: 15\n            }, this), \" \", \"Female \", /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"\\xA0 \\xA0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 246,\n              columnNumber: 22\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"radio\",\n              value: \"M\",\n              name: \"gender\",\n              ...register(\"gender\"),\n              onChange: handleInputChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 247,\n              columnNumber: 15\n            }, this), \" \", \"Male \", /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"\\xA0 \\xA0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 254,\n              columnNumber: 20\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Phone 1\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 258,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"phone1\",\n              ...register(\"phone1\"),\n              className: \"form-control py-0 \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 259,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-red-500\",\n              children: (_errors$phone = errors.phone1) === null || _errors$phone === void 0 ? void 0 : _errors$phone.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 265,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Phone 2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 269,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"phone2\",\n              ...register(\"phone2\"),\n              className: \"form-control py-0 \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 270,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-red-500\",\n              children: (_errors$phone2 = errors.phone2) === null || _errors$phone2 === void 0 ? void 0 : _errors$phone2.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 276,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 268,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Email\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 280,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"email\",\n              ...register(\"email\"),\n              className: \"form-control py-0 \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 281,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-red-500\",\n              children: (_errors$email = errors.email) === null || _errors$email === void 0 ? void 0 : _errors$email.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 287,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 279,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              value: \"true\",\n              name: \"enabled\",\n              ...register(\"enabled\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 290,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \" text-sm font-bold\",\n              children: \" Enabled \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 296,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 289,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"px-4\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            children: \"Save\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 173,\n    columnNumber: 5\n  }, this);\n};\n\nexport default withRouter(UsrEdit);","map":{"version":3,"sources":["/home/itsdcsec/falconws/falcon_face/src/components/UsrEdit.js"],"names":["useState","useEffect","withRouter","useParams","useHistory","useForm","axios","yup","yupResolver","LiveSearch","schema","object","usrName","string","required","accountNo","loginName","designation","UsrEdit","register","handleSubmit","setValue","formState","errors","clearErrors","resolver","id","history","serverErrors","setServerErrors","entity","setEntity","state","setState","isCancelled","console","log","fetchData","record","get","then","response","data","catch","error","Error","fields","forEach","field","prev","onSubmit","event","preventDefault","put","status","push","post","onError","e","parentData","title","url","searchList","fkEntity","preload","section","callback","childData","fk","errorCallback","err","handleInputChange","target","value","gender","message","phone1","phone2","email"],"mappings":"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","sourcesContent":["/**\n Code generated using Python\n @author Raja Reddy\n Date : 13 Oct 2021\n\n */\n\nimport { useState, useEffect } from \"react\";\nimport { withRouter, useParams, useHistory } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport axios from \"axios\";\nimport * as yup from \"yup\";\n\nimport { yupResolver } from \"@hookform/resolvers/yup\";\nimport LiveSearch from \"../utils/LiveSearch\";\n\nconst schema = yup\n  .object({\n    usrName: yup.string().required(\"User Name is required.\"),\n    accountNo: yup.string().required(\"Account no. is required\"),\n    loginName: yup.string().required(\"Login Name is required\"),\n    designation: yup.object().required(\"Designation is required\"),\n    //password: yup.string(),\n    //password2: yup.mixed().oneOf([yup.ref('password'), null], 'Passwords must match')\n    //age: yup.number().positive().integer().required(),\n  })\n  .required();\n\nconst UsrEdit = () => {\n  //const { register, handleSubmit, reset, setValue, getValues, formState: { errors }, clearErrors } = useForm({\n  const {\n    register,\n    handleSubmit,\n    setValue,\n    formState: { errors },\n    clearErrors,\n  } = useForm({\n    resolver: yupResolver(schema),\n  });\n\n  let { id } = useParams();\n  //console.log(id);\n\n  let history = useHistory();\n  const [serverErrors, setServerErrors] = useState([]);\n  const [entity, setEntity] = useState({});\n  const [state, setState] = useState({});\n\n  useEffect(() => {\n    let isCancelled = false;\n    console.log(id);\n    if (id !== \"new\") {\n      async function fetchData() {\n        let record = \"\";\n        await axios\n          .get(\"/usrs/\" + id)\n          .then((response) => {\n            record = response.data;\n          })\n          .catch((error) => {\n            //console.log(error);\n            //console.log(error.response.status);\n            //console.log(error.response.headers);\n            if (error.response) setServerErrors(error.response.data.error);\n            else setServerErrors(error.Error);\n          });\n\n        const fields = [\n          \"id\",\n          \"usrName\",\n          \"accountNo\",\n          \"loginName\",\n          \"designation\",\n          \"gender\",\n          \"section\",\n          \"phone1\",\n          \"phone2\",\n          \"phone3\",\n          \"email\",\n          \"enabled\",\n        ];\n        fields.forEach((field) => setValue(field, record[field]));\n        if (!isCancelled) {\n          setEntity(record);\n          setState((prev) => ({ ...prev, state: record }));\n        }\n      }\n\n      fetchData();\n      return () => {\n        isCancelled = true;\n      };\n    }\n  }, [id]);\n\n  const onSubmit = (data, event) => {\n    event.preventDefault();\n    console.log(data);\n    if (data.id) {\n      axios\n        .put(\"/usrs/\" + data.id, data)\n        .then((response) => {\n          if (response.status === 200) history.push(\"/usrs\");\n        })\n        .catch((error) => {\n          //console.log(error.response.data);\n          //console.log(error.response.status);\n          //console.log(error.response.headers);\n          setServerErrors(error.response.data);\n        });\n    } else {\n      axios\n        .post(\"/usrs\", data)\n        .then((response) => {\n          if (response.status === 200) history.push(\"/usrs\");\n        })\n        .catch((error) => {\n          if (error.response.status == 400)\n            setServerErrors(\"Record already exists\");\n          //console.log(error.response.data);\n          //console.log(error.response.status);\n          //console.log(error.response.headers);\n          else setServerErrors(error.response.data);\n        });\n    }\n  };\n\n  const onError = (errors, e) => console.log(errors, e);\n\n  //All foreign keys\n  const parentData = {\n    designation: {\n      title: \"Designation\",\n      url: \"designations\",\n      searchList: [\"abbr\"],\n      fkEntity: \"designation\",\n      preload: false,\n    },\n\n    section: {\n      title: \"Section\",\n      url: \"sections\",\n      searchList: [\"sectionName\"],\n      fkEntity: \"section\",\n      preload: false,\n    },\n  };\n\n  //Callback for child components (Foreign Keys)\n  const callback = (childData) => {\n    //console.log(\"Parent Callback\");\n    setEntity((prev) => ({ ...prev, [childData.fk]: childData.entity }));\n    setValue(childData.fk, childData.entity);\n    console.log(errors);\n    clearErrors(childData.fk);\n  };\n\n  const errorCallback = (err) => {\n    //console.log(err);\n    setServerErrors(err);\n  };\n\n  //console.log(entity);\n\n  const handleInputChange = (e) => {\n    console.log(e.target.value);\n    console.log(entity.gender);\n    //console.log(gender);\n    setValue(\"entity.gender\", e.target.value);\n  };\n\n  return (\n    <div className=\"max-w-xl mx-auto \">\n      <div className=\"w-full w-3/4  mx-auto \">\n        <form onSubmit={handleSubmit(onSubmit, onError)}>\n          <h1>{id === \"new\" ? \"Add\" : \"Edit\"} User </h1>\n          <div className=\"text-red-500\">{serverErrors}</div>\n\n          <div className=\"grid grid-cols-2 gap-0\">\n            <div>\n              <label>User Name</label>\n              <input\n                type=\"text\"\n                name=\"usrName\"\n                {...register(\"usrName\")}\n                className=\"form-control py-0\"\n              />\n              <div className=\"text-red-500\">{errors.usrName?.message}</div>\n            </div>\n\n            <div className=\" \">\n              <label>Account No.</label>\n              <input\n                type=\"text\"\n                name=\"accountNo\"\n                {...register(\"accountNo\")}\n                className=\"form-control py-0 \"\n              />\n              <div className=\"text-red-500\">{errors.accountNo?.message}</div>\n            </div>\n\n            <div>\n              <label>Login Name</label>\n              <input\n                type=\"text\"\n                name=\"loginName\"\n                {...register(\"loginName\")}\n                className=\"form-control py-0 \"\n              />\n              <div className=\"text-red-500\">{errors.loginName?.message}</div>\n            </div>\n\n            <div>\n              <LiveSearch\n                name=\"designation\"\n                onChange={handleInputChange}\n                parentData={parentData.designation}\n                parentCallback={callback}\n                fkEntity={entity.designation}\n                errCallback={errorCallback}\n              />\n              <div className=\"text-red-500 \">{errors.designation?.message}</div>\n            </div>\n\n            <div>\n              <LiveSearch\n                name=\"section\"\n                onChange={handleInputChange}\n                parentData={parentData.section}\n                parentCallback={callback}\n                fkEntity={entity.section}\n                errCallback={errorCallback}\n              />\n              <div className=\"text-red-500\">{errors.section?.message}</div>\n            </div>\n\n            <div className=\"\">\n              <label>Gender</label>\n              <input\n                type=\"radio\"\n                value=\"F\"\n                name=\"gender\"\n                {...register(\"gender\")}\n                onChange={handleInputChange}\n              />{\" \"}\n              Female <span>&nbsp; &nbsp;</span>\n              <input\n                type=\"radio\"\n                value=\"M\"\n                name=\"gender\"\n                {...register(\"gender\")}\n                onChange={handleInputChange}\n              />{\" \"}\n              Male <span>&nbsp; &nbsp;</span>\n            </div>\n\n            <div>\n              <label>Phone 1</label>\n              <input\n                type=\"text\"\n                name=\"phone1\"\n                {...register(\"phone1\")}\n                className=\"form-control py-0 \"\n              />\n              <div className=\"text-red-500\">{errors.phone1?.message}</div>\n            </div>\n\n            <div>\n              <label>Phone 2</label>\n              <input\n                type=\"text\"\n                name=\"phone2\"\n                {...register(\"phone2\")}\n                className=\"form-control py-0 \"\n              />\n              <div className=\"text-red-500\">{errors.phone2?.message}</div>\n            </div>\n\n            <div>\n              <label>Email</label>\n              <input\n                type=\"text\"\n                name=\"email\"\n                {...register(\"email\")}\n                className=\"form-control py-0 \"\n              />\n              <div className=\"text-red-500\">{errors.email?.message}</div>\n            </div>\n            <div>\n              <input\n                type=\"checkbox\"\n                value=\"true\"\n                name=\"enabled\"\n                {...register(\"enabled\")}\n              />\n              <span className=\" text-sm font-bold\"> Enabled </span>\n            </div>\n          </div>\n          <div className=\"px-4\">\n            <button type=\"submit\">Save</button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default withRouter(UsrEdit);\n"]},"metadata":{},"sourceType":"module"}