{"ast":null,"code":"var _jsxFileName = \"/home/itsdcsec/falconws/falcon_face/src/components/TwingReport.js\";\nimport { useState, useEffect, useMemo } from \"react\";\nimport { withRouter, useParams, useHistory, Link } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport axios from \"axios\";\nimport TablePage, { SelectColumnFilter } from \"../utils/TablePage\";\nimport { BasicLoadingIcon } from \"../utils/Icons\";\nimport { useCurrentDateInYYYYMMDD } from \"../utils/Hooks\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst TwingReport = () => {\n  let {\n    id\n  } = useParams();\n  let history = useHistory();\n  const [data, setData] = useState([]);\n  const [serverErrors, setServerErrors] = useState(\"\");\n  const [fromDateStr, setFromDateStr] = useState(useCurrentDateInYYYYMMDD());\n  const [toDateStr, setToDateStr] = useState(useCurrentDateInYYYYMMDD());\n  const [loading, setLoading] = useState(false);\n  const [totalCount, setTotalCount] = useState(0);\n  const [showOldestDate, setShowOldestDate] = useState(false);\n  const [reportType, setReportType] = useState(\"\");\n  const [showSelectMenu, setShowSelectMenu] = useState(false);\n  const [ssUser, setSSUser] = useState(false);\n  const [usrLevel, setUsrLevel] = useState(0);\n  useEffect(() => {\n    function isSSUser() {\n      let usr = JSON.parse(sessionStorage.getItem(\"usr\"));\n      setUsrLevel(usr === null || usr === void 0 ? void 0 : usr.designation.designationLevel);\n\n      if ((usr === null || usr === void 0 ? void 0 : usr.usrName) === \"SysAdmin\") {\n        setSSUser(true);\n      } else {\n        var _usr$sectionList;\n\n        usr === null || usr === void 0 ? void 0 : (_usr$sectionList = usr.sectionList) === null || _usr$sectionList === void 0 ? void 0 : _usr$sectionList.forEach(section => {\n          if (section.sectionName === \"TSS\") {\n            setSSUser(true);\n          }\n        });\n      }\n    }\n\n    isSSUser();\n  }, []);\n\n  async function generateReport() {\n    setServerErrors(\"\");\n\n    try {\n      setLoading(true);\n      const response = await axios.get(`/reports/twing/${reportType}?fromDateStr=${fromDateStr}&toDateStr=${toDateStr}`);\n\n      if (reportType === \"rejectionReport\") {\n        console.log(\"fileName\", response.data);\n        window.open(`${process.env.REACT_APP_BASE_URL}/files/${response.data}`);\n      } else {\n        setData(response.data);\n        if (reportType != \"billPunched\") setShowOldestDate(true);else setShowOldestDate(false);\n        setTotalCount(response.data.reduce(function (accumulator, newValue) {\n          return accumulator + newValue.count;\n        }, 0));\n      }\n    } catch (error) {\n      if (error.response) setServerErrors(error.response.status + \" -- \" + error.response.statusText + \". Please Contact EDP\");\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  const fontStyle = {\n    fontFamily: \"Helvetica\",\n    fontSize: 17\n  };\n  let totalCounter = 0;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"text-gray-900 bg-white\",\n    children: [serverErrors && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"font-semibold text-red-500 text-xl text-center my-2\",\n      children: serverErrors\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"pt-4\",\n      style: loading ? {\n        pointerEvents: \"none\",\n        opacity: \"0.4\"\n      } : {},\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col items-start sticky top-24 ml-36 p-2 w-96\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col items-center p-2 bg-white rounded-3xl shadow-2xl\",\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            className: \"\",\n            style: {\n              fontFamily: \"Helvetica\"\n            },\n            children: \"Reports\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"From Date\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 104,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"date\",\n                  name: \"FromDate\",\n                  placeholder: \"dd-mm-yyyy\",\n                  onChange: e => setFromDateStr(e.target.value),\n                  value: fromDateStr,\n                  readOnly: reportType === \"billPendency\" ? true : false\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 105,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 103,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"To date\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 115,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"date\",\n                  name: \"ToDate\",\n                  placeholder: \"dd-mm-yyyy\",\n                  onChange: e => setToDateStr(e.target.value),\n                  value: toDateStr,\n                  readOnly: reportType === \"billPendency\" ? true : false\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 116,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 114,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 102,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-col items-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"select\", {\n              className: \"bg-gray-100  text-gray-900 rounded-lg w-72 p-1 mt-2 text-lg\",\n              onChange: e => {\n                if (e.target.value === \"billPendency\") {\n                  setFromDateStr(useCurrentDateInYYYYMMDD);\n                  setToDateStr(useCurrentDateInYYYYMMDD);\n                }\n\n                setReportType(e.target.value);\n                setData([]);\n              },\n              style: fontStyle,\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: 0,\n                className: \"bg-green-200 \",\n                children: \"-select-\"\n              }, 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 140,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"billPendency\",\n                className: \"bg-green-200\",\n                children: \"Bill Pendency\"\n              }, 1, false, {\n                fileName: _jsxFileName,\n                lineNumber: 143,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"billPunched\",\n                className: \"bg-green-200 \",\n                children: \"Bill Punched\"\n              }, 2, false, {\n                fileName: _jsxFileName,\n                lineNumber: 146,\n                columnNumber: 17\n              }, this), ssUser ? /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"rejectionReport\",\n                className: \"bg-green-200 \",\n                children: \"Rejection Report\"\n              }, 3, false, {\n                fileName: _jsxFileName,\n                lineNumber: 150,\n                columnNumber: 19\n              }, this) : \"\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 128,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              onClick: generateReport,\n              className: \"w-32\",\n              children: \"Generate\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 184,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"-mt-48 p-0 shadow-lg rounded-xl noScrollBar scro\",\n        style: {\n          marginLeft: \"650px\",\n          maxHeight: \"670px\",\n          overflow: \"auto\"\n        },\n        children: data.length > 0 ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"w-full  text-sm text-left  text-gray-500 shadow-lg bg-white \",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              className: \" text-xs text-white uppercase bg-green-500 sticky top-0\",\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  scope: \"col\",\n                  class: \"px-10 py-2 text-lg\",\n                  style: fontStyle,\n                  children: \"Taskholder\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 200,\n                  columnNumber: 21\n                }, this), reportType === \"billPunched\" ? /*#__PURE__*/_jsxDEV(\"th\", {\n                  scope: \"col\",\n                  class: \"px-10 py-2 text-lg text-center\",\n                  style: fontStyle,\n                  children: \"Present Section\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 208,\n                  columnNumber: 23\n                }, this) : /*#__PURE__*/_jsxDEV(\"th\", {\n                  scope: \"col\",\n                  class: \"px-10 py-2 text-lg text-center\",\n                  style: fontStyle,\n                  children: \"Section\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 216,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  scope: \"col\",\n                  class: \"px-10 py-2 text-lg text-center\",\n                  style: fontStyle,\n                  children: \"Task No\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 224,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  scope: \"col\",\n                  class: \"px-10 py-2 text-lg text-center\",\n                  style: fontStyle,\n                  children: \"Count\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 232,\n                  columnNumber: 21\n                }, this), showOldestDate && /*#__PURE__*/_jsxDEV(\"th\", {\n                  scope: \"col\",\n                  class: \"px-10 py-2 text-lg text-center\",\n                  style: fontStyle,\n                  children: \"Oldest Date\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 240,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 199,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 198,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: [data.map((row, index) => /*#__PURE__*/_jsxDEV(\"tr\", {\n                className: \"tr-even-white-bg border-b hover:bg-gray-100\",\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"px-10 py-2 text-gray-700 \",\n                  style: fontStyle,\n                  children: row.usrName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 256,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"px-10 py-2 text-center\",\n                  style: fontStyle,\n                  children: row.sectionname\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 262,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"px-10 py-2 text-center\",\n                  style: fontStyle,\n                  children: row.task\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 265,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"px-10 py-2 text-center\",\n                  style: fontStyle,\n                  children: row.count\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 268,\n                  columnNumber: 23\n                }, this), showOldestDate && /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"px-10 py-2 text-center\",\n                  style: fontStyle,\n                  children: row.oldestDate\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 272,\n                  columnNumber: 25\n                }, this)]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 252,\n                columnNumber: 21\n              }, this)), /*#__PURE__*/_jsxDEV(\"tr\", {\n                className: \"bg-gray-200 sticky bottom-0 font-bold\",\n                children: [/*#__PURE__*/_jsxDEV(\"td\", {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 283,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 284,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"px-6 py-2 text-center text-black\",\n                  style: fontStyle,\n                  children: \"TOTAL\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 285,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"px-6 py-2 text-center text-black\",\n                  style: fontStyle,\n                  children: totalCount\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 291,\n                  columnNumber: 21\n                }, this), showOldestDate && /*#__PURE__*/_jsxDEV(\"td\", {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 297,\n                  columnNumber: 40\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 282,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 250,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 15\n          }, this)\n        }, void 0, false) : \"\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }, this), reportType === \"billPunched\" ? /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"text-red-500 italic mt-4 mr-4 text-right\",\n      children: \"** Note: the data is shown wrt user irrespective of sections\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 9\n    }, this) : \"\"]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 86,\n    columnNumber: 5\n  }, this);\n};\n\nexport default withRouter(TwingReport);","map":{"version":3,"sources":["/home/itsdcsec/falconws/falcon_face/src/components/TwingReport.js"],"names":["useState","useEffect","useMemo","withRouter","useParams","useHistory","Link","useForm","axios","TablePage","SelectColumnFilter","BasicLoadingIcon","useCurrentDateInYYYYMMDD","TwingReport","id","history","data","setData","serverErrors","setServerErrors","fromDateStr","setFromDateStr","toDateStr","setToDateStr","loading","setLoading","totalCount","setTotalCount","showOldestDate","setShowOldestDate","reportType","setReportType","showSelectMenu","setShowSelectMenu","ssUser","setSSUser","usrLevel","setUsrLevel","isSSUser","usr","JSON","parse","sessionStorage","getItem","designation","designationLevel","usrName","sectionList","forEach","section","sectionName","generateReport","response","get","console","log","window","open","process","env","REACT_APP_BASE_URL","reduce","accumulator","newValue","count","error","status","statusText","fontStyle","fontFamily","fontSize","totalCounter","pointerEvents","opacity","e","target","value","marginLeft","maxHeight","overflow","length","map","row","index","sectionname","task","oldestDate"],"mappings":";AAAA,SAASA,QAAT,EAAmBC,SAAnB,EAA8BC,OAA9B,QAA6C,OAA7C;AACA,SAASC,UAAT,EAAqBC,SAArB,EAAgCC,UAAhC,EAA4CC,IAA5C,QAAwD,kBAAxD;AACA,SAASC,OAAT,QAAwB,iBAAxB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,SAAP,IAAoBC,kBAApB,QAA8C,oBAA9C;AACA,SAASC,gBAAT,QAAiC,gBAAjC;AACA,SAASC,wBAAT,QAAyC,gBAAzC;;;;AAEA,MAAMC,WAAW,GAAG,MAAM;AACxB,MAAI;AAAEC,IAAAA;AAAF,MAASV,SAAS,EAAtB;AAEA,MAAIW,OAAO,GAAGV,UAAU,EAAxB;AAEA,QAAM,CAACW,IAAD,EAAOC,OAAP,IAAkBjB,QAAQ,CAAC,EAAD,CAAhC;AACA,QAAM,CAACkB,YAAD,EAAeC,eAAf,IAAkCnB,QAAQ,CAAC,EAAD,CAAhD;AAEA,QAAM,CAACoB,WAAD,EAAcC,cAAd,IAAgCrB,QAAQ,CAACY,wBAAwB,EAAzB,CAA9C;AACA,QAAM,CAACU,SAAD,EAAYC,YAAZ,IAA4BvB,QAAQ,CAACY,wBAAwB,EAAzB,CAA1C;AAEA,QAAM,CAACY,OAAD,EAAUC,UAAV,IAAwBzB,QAAQ,CAAC,KAAD,CAAtC;AACA,QAAM,CAAC0B,UAAD,EAAaC,aAAb,IAA8B3B,QAAQ,CAAC,CAAD,CAA5C;AACA,QAAM,CAAC4B,cAAD,EAAiBC,iBAAjB,IAAsC7B,QAAQ,CAAC,KAAD,CAApD;AACA,QAAM,CAAC8B,UAAD,EAAaC,aAAb,IAA8B/B,QAAQ,CAAC,EAAD,CAA5C;AACA,QAAM,CAACgC,cAAD,EAAiBC,iBAAjB,IAAsCjC,QAAQ,CAAC,KAAD,CAApD;AACA,QAAM,CAACkC,MAAD,EAASC,SAAT,IAAsBnC,QAAQ,CAAC,KAAD,CAApC;AACA,QAAM,CAACoC,QAAD,EAAWC,WAAX,IAA0BrC,QAAQ,CAAC,CAAD,CAAxC;AAEAC,EAAAA,SAAS,CAAC,MAAM;AACd,aAASqC,QAAT,GAAoB;AAClB,UAAIC,GAAG,GAAGC,IAAI,CAACC,KAAL,CAAWC,cAAc,CAACC,OAAf,CAAuB,KAAvB,CAAX,CAAV;AACAN,MAAAA,WAAW,CAACE,GAAD,aAACA,GAAD,uBAACA,GAAG,CAAEK,WAAL,CAAiBC,gBAAlB,CAAX;;AACA,UAAI,CAAAN,GAAG,SAAH,IAAAA,GAAG,WAAH,YAAAA,GAAG,CAAEO,OAAL,MAAiB,UAArB,EAAiC;AAC/BX,QAAAA,SAAS,CAAC,IAAD,CAAT;AACD,OAFD,MAEO;AAAA;;AACLI,QAAAA,GAAG,SAAH,IAAAA,GAAG,WAAH,gCAAAA,GAAG,CAAEQ,WAAL,sEAAkBC,OAAlB,CAA2BC,OAAD,IAAa;AACrC,cAAIA,OAAO,CAACC,WAAR,KAAwB,KAA5B,EAAmC;AACjCf,YAAAA,SAAS,CAAC,IAAD,CAAT;AACD;AACF,SAJD;AAKD;AACF;;AACDG,IAAAA,QAAQ;AACT,GAfQ,EAeN,EAfM,CAAT;;AAiBA,iBAAea,cAAf,GAAgC;AAC9BhC,IAAAA,eAAe,CAAC,EAAD,CAAf;;AACA,QAAI;AACFM,MAAAA,UAAU,CAAC,IAAD,CAAV;AACA,YAAM2B,QAAQ,GAAG,MAAM5C,KAAK,CAAC6C,GAAN,CACpB,kBAAiBvB,UAAW,gBAAeV,WAAY,cAAaE,SAAU,EAD1D,CAAvB;;AAGA,UAAIQ,UAAU,KAAK,iBAAnB,EAAsC;AACpCwB,QAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBH,QAAQ,CAACpC,IAAjC;AACAwC,QAAAA,MAAM,CAACC,IAAP,CAAa,GAAEC,OAAO,CAACC,GAAR,CAAYC,kBAAmB,UAASR,QAAQ,CAACpC,IAAK,EAArE;AACD,OAHD,MAGO;AACLC,QAAAA,OAAO,CAACmC,QAAQ,CAACpC,IAAV,CAAP;AACA,YAAIc,UAAU,IAAI,aAAlB,EAAiCD,iBAAiB,CAAC,IAAD,CAAjB,CAAjC,KACKA,iBAAiB,CAAC,KAAD,CAAjB;AACLF,QAAAA,aAAa,CACXyB,QAAQ,CAACpC,IAAT,CAAc6C,MAAd,CAAqB,UAAUC,WAAV,EAAuBC,QAAvB,EAAiC;AACpD,iBAAOD,WAAW,GAAGC,QAAQ,CAACC,KAA9B;AACD,SAFD,EAEG,CAFH,CADW,CAAb;AAKD;AACF,KAlBD,CAkBE,OAAOC,KAAP,EAAc;AACd,UAAIA,KAAK,CAACb,QAAV,EACEjC,eAAe,CACb8C,KAAK,CAACb,QAAN,CAAec,MAAf,GACE,MADF,GAEED,KAAK,CAACb,QAAN,CAAee,UAFjB,GAGE,sBAJW,CAAf;AAMH,KA1BD,SA0BU;AACR1C,MAAAA,UAAU,CAAC,KAAD,CAAV;AACD;AACF;;AAED,QAAM2C,SAAS,GAAG;AAChBC,IAAAA,UAAU,EAAE,WADI;AAEhBC,IAAAA,QAAQ,EAAE;AAFM,GAAlB;AAKA,MAAIC,YAAY,GAAG,CAAnB;AAEA,sBACE;AAAK,IAAA,SAAS,EAAC,wBAAf;AAAA,eACGrD,YAAY,iBACX;AAAG,MAAA,SAAS,EAAC,qDAAb;AAAA,gBACGA;AADH;AAAA;AAAA;AAAA;AAAA,YAFJ,eAME;AACE,MAAA,SAAS,EAAC,MADZ;AAEE,MAAA,KAAK,EAAEM,OAAO,GAAG;AAAEgD,QAAAA,aAAa,EAAE,MAAjB;AAAyBC,QAAAA,OAAO,EAAE;AAAlC,OAAH,GAA+C,EAF/D;AAAA,8BAIE;AAAK,QAAA,SAAS,EAAC,wDAAf;AAAA,+BACE;AAAK,UAAA,SAAS,EAAC,gEAAf;AAAA,kCACE;AAAI,YAAA,SAAS,EAAC,EAAd;AAAiB,YAAA,KAAK,EAAE;AAAEJ,cAAAA,UAAU,EAAE;AAAd,aAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAIE;AAAK,YAAA,SAAS,EAAC,EAAf;AAAA,mCACE;AAAK,cAAA,SAAS,EAAC,MAAf;AAAA,sCACE;AAAA,wCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,eAEE;AACE,kBAAA,IAAI,EAAC,MADP;AAEE,kBAAA,IAAI,EAAC,UAFP;AAGE,kBAAA,WAAW,EAAC,YAHd;AAIE,kBAAA,QAAQ,EAAGK,CAAD,IAAOrD,cAAc,CAACqD,CAAC,CAACC,MAAF,CAASC,KAAV,CAJjC;AAKE,kBAAA,KAAK,EAAExD,WALT;AAME,kBAAA,QAAQ,EAAEU,UAAU,KAAK,cAAf,GAAgC,IAAhC,GAAuC;AANnD;AAAA;AAAA;AAAA;AAAA,wBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,eAYE;AAAA,wCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,eAEE;AACE,kBAAA,IAAI,EAAC,MADP;AAEE,kBAAA,IAAI,EAAC,QAFP;AAGE,kBAAA,WAAW,EAAC,YAHd;AAIE,kBAAA,QAAQ,EAAG4C,CAAD,IAAOnD,YAAY,CAACmD,CAAC,CAACC,MAAF,CAASC,KAAV,CAJ/B;AAKE,kBAAA,KAAK,EAAEtD,SALT;AAME,kBAAA,QAAQ,EAAEQ,UAAU,KAAK,cAAf,GAAgC,IAAhC,GAAuC;AANnD;AAAA;AAAA;AAAA;AAAA,wBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,sBAZF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,kBAJF,eA8BE;AAAK,YAAA,SAAS,EAAC,4BAAf;AAAA,oCACE;AACE,cAAA,SAAS,EAAC,6DADZ;AAEE,cAAA,QAAQ,EAAG4C,CAAD,IAAO;AACf,oBAAIA,CAAC,CAACC,MAAF,CAASC,KAAT,KAAmB,cAAvB,EAAuC;AACrCvD,kBAAAA,cAAc,CAACT,wBAAD,CAAd;AACAW,kBAAAA,YAAY,CAACX,wBAAD,CAAZ;AACD;;AACDmB,gBAAAA,aAAa,CAAC2C,CAAC,CAACC,MAAF,CAASC,KAAV,CAAb;AACA3D,gBAAAA,OAAO,CAAC,EAAD,CAAP;AACD,eATH;AAUE,cAAA,KAAK,EAAEmD,SAVT;AAAA,sCAYE;AAAgB,gBAAA,KAAK,EAAE,CAAvB;AAA0B,gBAAA,SAAS,EAAC,eAApC;AAAA;AAAA,iBAAa,CAAb;AAAA;AAAA;AAAA;AAAA,sBAZF,eAeE;AAAgB,gBAAA,KAAK,EAAC,cAAtB;AAAqC,gBAAA,SAAS,EAAC,cAA/C;AAAA;AAAA,iBAAa,CAAb;AAAA;AAAA;AAAA;AAAA,sBAfF,eAkBE;AAAgB,gBAAA,KAAK,EAAC,aAAtB;AAAoC,gBAAA,SAAS,EAAC,eAA9C;AAAA;AAAA,iBAAa,CAAb;AAAA;AAAA;AAAA;AAAA,sBAlBF,EAqBGlC,MAAM,gBACL;AAEE,gBAAA,KAAK,EAAC,iBAFR;AAGE,gBAAA,SAAS,EAAC,eAHZ;AAAA;AAAA,iBACO,CADP;AAAA;AAAA;AAAA;AAAA,sBADK,GASL,EA9BJ;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,eAyDE;AAAQ,cAAA,IAAI,EAAC,QAAb;AAAsB,cAAA,OAAO,EAAEiB,cAA/B;AAA+C,cAAA,SAAS,EAAC,MAAzD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAzDF;AAAA;AAAA;AAAA;AAAA;AAAA,kBA9BF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cAJF,eAmGE;AACE,QAAA,SAAS,EAAC,kDADZ;AAEE,QAAA,KAAK,EAAE;AAAE0B,UAAAA,UAAU,EAAE,OAAd;AAAuBC,UAAAA,SAAS,EAAE,OAAlC;AAA2CC,UAAAA,QAAQ,EAAE;AAArD,SAFT;AAAA,kBAIG/D,IAAI,CAACgE,MAAL,GAAc,CAAd,gBACC;AAAA,iCACE;AAAO,YAAA,SAAS,EAAC,8DAAjB;AAAA,oCACE;AAAO,cAAA,SAAS,EAAC,yDAAjB;AAAA,qCACE;AAAA,wCACE;AACE,kBAAA,KAAK,EAAC,KADR;AAEE,kBAAA,KAAK,EAAC,oBAFR;AAGE,kBAAA,KAAK,EAAEZ,SAHT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,EAQGtC,UAAU,KAAK,aAAf,gBACC;AACE,kBAAA,KAAK,EAAC,KADR;AAEE,kBAAA,KAAK,EAAC,gCAFR;AAGE,kBAAA,KAAK,EAAEsC,SAHT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADD,gBASC;AACE,kBAAA,KAAK,EAAC,KADR;AAEE,kBAAA,KAAK,EAAC,gCAFR;AAGE,kBAAA,KAAK,EAAEA,SAHT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAjBJ,eAyBE;AACE,kBAAA,KAAK,EAAC,KADR;AAEE,kBAAA,KAAK,EAAC,gCAFR;AAGE,kBAAA,KAAK,EAAEA,SAHT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAzBF,eAiCE;AACE,kBAAA,KAAK,EAAC,KADR;AAEE,kBAAA,KAAK,EAAC,gCAFR;AAGE,kBAAA,KAAK,EAAEA,SAHT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAjCF,EAwCGxC,cAAc,iBACb;AACE,kBAAA,KAAK,EAAC,KADR;AAEE,kBAAA,KAAK,EAAC,gCAFR;AAGE,kBAAA,KAAK,EAAEwC,SAHT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAzCJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,oBADF,eAqDE;AAAA,yBACGpD,IAAI,CAACiE,GAAL,CAAS,CAACC,GAAD,EAAMC,KAAN,kBACR;AACE,gBAAA,SAAS,EAAC,6CADZ;AAAA,wCAIE;AACE,kBAAA,SAAS,EAAC,2BADZ;AAEE,kBAAA,KAAK,EAAEf,SAFT;AAAA,4BAIGc,GAAG,CAACpC;AAJP;AAAA;AAAA;AAAA;AAAA,wBAJF,eAUE;AAAI,kBAAA,SAAS,EAAC,wBAAd;AAAuC,kBAAA,KAAK,EAAEsB,SAA9C;AAAA,4BACGc,GAAG,CAACE;AADP;AAAA;AAAA;AAAA;AAAA,wBAVF,eAaE;AAAI,kBAAA,SAAS,EAAC,wBAAd;AAAuC,kBAAA,KAAK,EAAEhB,SAA9C;AAAA,4BACGc,GAAG,CAACG;AADP;AAAA;AAAA;AAAA;AAAA,wBAbF,eAgBE;AAAI,kBAAA,SAAS,EAAC,wBAAd;AAAuC,kBAAA,KAAK,EAAEjB,SAA9C;AAAA,4BACGc,GAAG,CAAClB;AADP;AAAA;AAAA;AAAA;AAAA,wBAhBF,EAmBGpC,cAAc,iBACb;AACE,kBAAA,SAAS,EAAC,wBADZ;AAEE,kBAAA,KAAK,EAAEwC,SAFT;AAAA,4BAIGc,GAAG,CAACI;AAJP;AAAA;AAAA;AAAA;AAAA,wBApBJ;AAAA,iBAEOH,KAFP;AAAA;AAAA;AAAA;AAAA,sBADD,CADH,eAgCE;AAAI,gBAAA,SAAS,EAAC,uCAAd;AAAA,wCACE;AAAA;AAAA;AAAA;AAAA,wBADF,eAEE;AAAA;AAAA;AAAA;AAAA,wBAFF,eAGE;AACE,kBAAA,SAAS,EAAC,kCADZ;AAEE,kBAAA,KAAK,EAAEf,SAFT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAHF,eASE;AACE,kBAAA,SAAS,EAAC,kCADZ;AAEE,kBAAA,KAAK,EAAEA,SAFT;AAAA,4BAIG1C;AAJH;AAAA;AAAA;AAAA;AAAA,wBATF,EAeGE,cAAc,iBAAI;AAAA;AAAA;AAAA;AAAA,wBAfrB;AAAA;AAAA;AAAA;AAAA;AAAA,sBAhCF;AAAA;AAAA;AAAA;AAAA;AAAA,oBArDF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF,yBADD,GA4GC;AAhHJ;AAAA;AAAA;AAAA;AAAA,cAnGF;AAAA;AAAA;AAAA;AAAA;AAAA,YANF,EA6NGE,UAAU,KAAK,aAAf,gBACC;AAAG,MAAA,SAAS,EAAC,0CAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADD,GAKC,EAlOJ;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AAuOD,CAnTD;;AAqTA,eAAe3B,UAAU,CAACU,WAAD,CAAzB","sourcesContent":["import { useState, useEffect, useMemo } from \"react\";\nimport { withRouter, useParams, useHistory, Link } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport axios from \"axios\";\nimport TablePage, { SelectColumnFilter } from \"../utils/TablePage\";\nimport { BasicLoadingIcon } from \"../utils/Icons\";\nimport { useCurrentDateInYYYYMMDD } from \"../utils/Hooks\";\n\nconst TwingReport = () => {\n  let { id } = useParams();\n\n  let history = useHistory();\n\n  const [data, setData] = useState([]);\n  const [serverErrors, setServerErrors] = useState(\"\");\n\n  const [fromDateStr, setFromDateStr] = useState(useCurrentDateInYYYYMMDD());\n  const [toDateStr, setToDateStr] = useState(useCurrentDateInYYYYMMDD());\n\n  const [loading, setLoading] = useState(false);\n  const [totalCount, setTotalCount] = useState(0);\n  const [showOldestDate, setShowOldestDate] = useState(false);\n  const [reportType, setReportType] = useState(\"\");\n  const [showSelectMenu, setShowSelectMenu] = useState(false);\n  const [ssUser, setSSUser] = useState(false);\n  const [usrLevel, setUsrLevel] = useState(0);\n\n  useEffect(() => {\n    function isSSUser() {\n      let usr = JSON.parse(sessionStorage.getItem(\"usr\"));\n      setUsrLevel(usr?.designation.designationLevel);\n      if (usr?.usrName === \"SysAdmin\") {\n        setSSUser(true);\n      } else {\n        usr?.sectionList?.forEach((section) => {\n          if (section.sectionName === \"TSS\") {\n            setSSUser(true);\n          }\n        });\n      }\n    }\n    isSSUser();\n  }, []);\n\n  async function generateReport() {\n    setServerErrors(\"\");\n    try {\n      setLoading(true);\n      const response = await axios.get(\n        `/reports/twing/${reportType}?fromDateStr=${fromDateStr}&toDateStr=${toDateStr}`\n      );\n      if (reportType === \"rejectionReport\") {\n        console.log(\"fileName\", response.data);\n        window.open(`${process.env.REACT_APP_BASE_URL}/files/${response.data}`);\n      } else {\n        setData(response.data);\n        if (reportType != \"billPunched\") setShowOldestDate(true);\n        else setShowOldestDate(false);\n        setTotalCount(\n          response.data.reduce(function (accumulator, newValue) {\n            return accumulator + newValue.count;\n          }, 0)\n        );\n      }\n    } catch (error) {\n      if (error.response)\n        setServerErrors(\n          error.response.status +\n            \" -- \" +\n            error.response.statusText +\n            \". Please Contact EDP\"\n        );\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  const fontStyle = {\n    fontFamily: \"Helvetica\",\n    fontSize: 17,\n  };\n\n  let totalCounter = 0;\n\n  return (\n    <div className=\"text-gray-900 bg-white\">\n      {serverErrors && (\n        <p className=\"font-semibold text-red-500 text-xl text-center my-2\">\n          {serverErrors}\n        </p>\n      )}\n      <main\n        className=\"pt-4\"\n        style={loading ? { pointerEvents: \"none\", opacity: \"0.4\" } : {}}\n      >\n        <div className=\"flex flex-col items-start sticky top-24 ml-36 p-2 w-96\">\n          <div className=\"flex flex-col items-center p-2 bg-white rounded-3xl shadow-2xl\">\n            <h1 className=\"\" style={{ fontFamily: \"Helvetica\" }}>\n              Reports\n            </h1>\n            <div className=\"\">\n              <div className=\"flex\">\n                <div>\n                  <label>From Date</label>\n                  <input\n                    type=\"date\"\n                    name=\"FromDate\"\n                    placeholder=\"dd-mm-yyyy\"\n                    onChange={(e) => setFromDateStr(e.target.value)}\n                    value={fromDateStr}\n                    readOnly={reportType === \"billPendency\" ? true : false}\n                  />\n                </div>\n                <div>\n                  <label>To date</label>\n                  <input\n                    type=\"date\"\n                    name=\"ToDate\"\n                    placeholder=\"dd-mm-yyyy\"\n                    onChange={(e) => setToDateStr(e.target.value)}\n                    value={toDateStr}\n                    readOnly={reportType === \"billPendency\" ? true : false}\n                  />\n                </div>\n              </div>\n            </div>\n            <div className=\"flex flex-col items-center\">\n              <select\n                className=\"bg-gray-100  text-gray-900 rounded-lg w-72 p-1 mt-2 text-lg\"\n                onChange={(e) => {\n                  if (e.target.value === \"billPendency\") {\n                    setFromDateStr(useCurrentDateInYYYYMMDD);\n                    setToDateStr(useCurrentDateInYYYYMMDD);\n                  }\n                  setReportType(e.target.value);\n                  setData([]);\n                }}\n                style={fontStyle}\n              >\n                <option key={0} value={0} className=\"bg-green-200 \">\n                  -select-\n                </option>\n                <option key={1} value=\"billPendency\" className=\"bg-green-200\">\n                  Bill Pendency\n                </option>\n                <option key={2} value=\"billPunched\" className=\"bg-green-200 \">\n                  Bill Punched\n                </option>\n                {ssUser ? (\n                  <option\n                    key={3}\n                    value=\"rejectionReport\"\n                    className=\"bg-green-200 \"\n                  >\n                    Rejection Report\n                  </option>\n                ) : (\n                  \"\"\n                )}\n              </select>\n              {/* <div className=\"w-full cursor-pointer\">\n                <div>\n                  <li\n                    className=\"list-none hover:bg-green-500\"\n                    //onClick={setShowSelectMenu(true)}\n                  >\n                    --Select--\n                  </li>\n                </div>\n                {true && (\n                  <div>\n                    <li\n                      className=\"list-none hover:bg-green-500\"\n                      onClick={(e) => setReportType(\"billPendency\")}\n                    >\n                      Bill Pending\n                    </li>\n                    <li className=\"list-none hover:bg-green-500\">\n                      Bill Punched\n                    </li>\n                  </div>\n                )}\n              </div> */}\n              <button type=\"submit\" onClick={generateReport} className=\"w-32\">\n                Generate\n              </button>\n            </div>\n          </div>\n        </div>\n\n        <div\n          className=\"-mt-48 p-0 shadow-lg rounded-xl noScrollBar scro\"\n          style={{ marginLeft: \"650px\", maxHeight: \"670px\", overflow: \"auto\" }}\n        >\n          {data.length > 0 ? (\n            <>\n              <table className=\"w-full  text-sm text-left  text-gray-500 shadow-lg bg-white \">\n                <thead className=\" text-xs text-white uppercase bg-green-500 sticky top-0\">\n                  <tr>\n                    <th\n                      scope=\"col\"\n                      class=\"px-10 py-2 text-lg\"\n                      style={fontStyle}\n                    >\n                      Taskholder\n                    </th>\n                    {reportType === \"billPunched\" ? (\n                      <th\n                        scope=\"col\"\n                        class=\"px-10 py-2 text-lg text-center\"\n                        style={fontStyle}\n                      >\n                        Present Section\n                      </th>\n                    ) : (\n                      <th\n                        scope=\"col\"\n                        class=\"px-10 py-2 text-lg text-center\"\n                        style={fontStyle}\n                      >\n                        Section\n                      </th>\n                    )}\n                    <th\n                      scope=\"col\"\n                      class=\"px-10 py-2 text-lg text-center\"\n                      style={fontStyle}\n                    >\n                      Task No\n                    </th>\n\n                    <th\n                      scope=\"col\"\n                      class=\"px-10 py-2 text-lg text-center\"\n                      style={fontStyle}\n                    >\n                      Count\n                    </th>\n                    {showOldestDate && (\n                      <th\n                        scope=\"col\"\n                        class=\"px-10 py-2 text-lg text-center\"\n                        style={fontStyle}\n                      >\n                        Oldest Date\n                      </th>\n                    )}\n                  </tr>\n                </thead>\n                <tbody>\n                  {data.map((row, index) => (\n                    <tr\n                      className=\"tr-even-white-bg border-b hover:bg-gray-100\"\n                      key={index}\n                    >\n                      <td\n                        className=\"px-10 py-2 text-gray-700 \"\n                        style={fontStyle}\n                      >\n                        {row.usrName}\n                      </td>\n                      <td className=\"px-10 py-2 text-center\" style={fontStyle}>\n                        {row.sectionname}\n                      </td>\n                      <td className=\"px-10 py-2 text-center\" style={fontStyle}>\n                        {row.task}\n                      </td>\n                      <td className=\"px-10 py-2 text-center\" style={fontStyle}>\n                        {row.count}\n                      </td>\n                      {showOldestDate && (\n                        <td\n                          className=\"px-10 py-2 text-center\"\n                          style={fontStyle}\n                        >\n                          {row.oldestDate}\n                        </td>\n                      )}\n                    </tr>\n                  ))}\n\n                  <tr className=\"bg-gray-200 sticky bottom-0 font-bold\">\n                    <td></td>\n                    <td></td>\n                    <td\n                      className=\"px-6 py-2 text-center text-black\"\n                      style={fontStyle}\n                    >\n                      TOTAL\n                    </td>\n                    <td\n                      className=\"px-6 py-2 text-center text-black\"\n                      style={fontStyle}\n                    >\n                      {totalCount}\n                    </td>\n                    {showOldestDate && <td></td>}\n                  </tr>\n                </tbody>\n              </table>\n            </>\n          ) : (\n            \"\"\n          )}\n        </div>\n      </main>\n      {reportType === \"billPunched\" ? (\n        <p className=\"text-red-500 italic mt-4 mr-4 text-right\">\n          ** Note: the data is shown wrt user irrespective of sections\n        </p>\n      ) : (\n        \"\"\n      )}\n    </div>\n  );\n};\n\nexport default withRouter(TwingReport);\n"]},"metadata":{},"sourceType":"module"}