{"ast":null,"code":"import _toConsumableArray from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect,useMemo}from\"react\";import Table,{SelectColumnFilter}from\"../utils/Table\";//\nimport axios from\"axios\";import{withRouter,Link,useLocation}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function OmroList(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),update=_useState4[0],setUpdate=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),serverErrors=_useState6[0],setServerErrors=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),search=_useState8[0],setSearch=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),inputText=_useState10[0],setInputText=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),cdaoNo=_useState12[0],setCdaoNo=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),name=_useState14[0],setName=_useState14[1];var _useState15=useState(\"\"),_useState16=_slicedToArray(_useState15,2),empId=_useState16[0],setEmpId=_useState16[1];var _useState17=useState(\"\"),_useState18=_slicedToArray(_useState17,2),selectionType=_useState18[0],setSelectionType=_useState18[1];var location=useLocation();useEffect(function(){var fetching=false;function fetchData(){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(fetching){_context.next=8;break;}if(!(selectionType===\"approved\")){_context.next=6;break;}_context.next=4;return axios.get(\"/omros?filter=approved&search=\"+search).then(function(response){setData(response.data);setSelectionType(\"pending\");}).catch(function(error){//console.log(error);\n//console.log(error.response.status);\n//console.log(error.response.headers);\nif(error.response)setServerErrors(error.response.data.error);else setServerErrors(error.Error);});case 4:_context.next=8;break;case 6:_context.next=8;return axios.get(\"/omros?search=\"+search).then(function(response){setData(response.data);setSelectionType(\"pending\");}).catch(function(error){//console.log(error);\n//console.log(error.response.status);\n//console.log(error.response.headers);\nif(error.response)setServerErrors(error.response.data.error);else setServerErrors(error.Error);});case 8:case\"end\":return _context.stop();}}},_callee);}));return _fetchData.apply(this,arguments);}fetchData();return function(){fetching=true;};},[update,search]);function submitMro(_x){return _submitMro.apply(this,arguments);}function _submitMro(){_submitMro=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return axios.put(\"/omros/\".concat(id,\"/submitMro\")).then(function(){//console.log(data);\nvar updatedRecords=_toConsumableArray(data).filter(function(i){return i.id!==id;});console.log(updatedRecords);setData(updatedRecords);setUpdate(!update);}).catch(function(error){console.log(error);//console.log(error.response.status);\n//console.log(error.response.headers);\nif(error.response)setServerErrors(error.response.data.error);else setServerErrors(error.Error);});case 2:case\"end\":return _context3.stop();}}},_callee3);}));return _submitMro.apply(this,arguments);}function approveMro(_x2){return _approveMro.apply(this,arguments);}function _approveMro(){_approveMro=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(id){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return axios.put(\"/omros/\".concat(id,\"/approveMro\")).then(function(){//console.log(data);\nvar updatedRecords=_toConsumableArray(data).filter(function(i){return i.id!==id;});console.log(updatedRecords);setData(updatedRecords);setUpdate(!update);}).catch(function(error){console.log(error);//console.log(error.response.status);\n//console.log(error.response.headers);\nif(error.response)setServerErrors(error.response.data.error);else setServerErrors(error.Error);});case 2:case\"end\":return _context4.stop();}}},_callee4);}));return _approveMro.apply(this,arguments);}function remove(_x3){return _remove.apply(this,arguments);}function _remove(){_remove=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(id){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return axios.delete(\"/omros/\".concat(id)).then(function(){//console.log(data);\nvar updatedRecords=_toConsumableArray(data).filter(function(i){return i.id!==id;});console.log(updatedRecords);setData(updatedRecords);setUpdate(!update);}).catch(function(error){console.log(error);//console.log(error.response.status);\n//console.log(error.response.headers);\nif(error.response)setServerErrors(error.response.data.error);else setServerErrors(error.Error);});case 2:case\"end\":return _context5.stop();}}},_callee5);}));return _remove.apply(this,arguments);}var handleClick=function handleClick(){var fetching=false;function fetchData(){return _fetchData2.apply(this,arguments);}function _fetchData2(){_fetchData2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(fetching){_context2.next=3;break;}_context2.next=3;return axios.get(\"/omros?filter=approved\").then(function(response){console.log(response.data);setData(response.data);setSelectionType(\"approved\");}).catch(function(error){//console.log(error);\n//console.log(error.response.status);\n//console.log(error.response.headers);\nif(error.response)setServerErrors(error.response.data.error);else setServerErrors(error.Error);});case 3:case\"end\":return _context2.stop();}}},_callee2);}));return _fetchData2.apply(this,arguments);}fetchData();return function(){fetching=true;};};var handleSubmit=function handleSubmit(event){event.preventDefault();console.log(inputText);setSearch(inputText);};var handleKeyPress=function handleKeyPress(event){// look for the `Enter` keyCode\nif(event.keyCode===13||event.which===13){handleSubmit(event);}};var columns=useMemo(function(){return[{Header:\"Action\",Cell:function Cell(_ref){var row=_ref.row;return/*#__PURE__*/_jsxs(\"div\",{children:[row.original.action!=null&&!row.original.action.includes(\"Subm\")&&!row.original.action.includes(\"Appr\")&&/*#__PURE__*/_jsx(Link,{to:\"/omros/\"+row.original.id,children:/*#__PURE__*/_jsx(\"button\",{className:\" w-16 m-0 p-0 \",children:\" Edit \"})}),\" \",row.original.action===\"Submission by AAO.\"&&/*#__PURE__*/_jsxs(\"button\",{className:\"w-16 m-0 p-0 bg-red-500 hover:bg-red-700 \",onClick:function onClick(){return submitMro(row.original.id);},children:[\" \",\"Submit\",\" \"]}),\" \",row.original.action===\"Approval by AO.\"&&/*#__PURE__*/_jsxs(\"button\",{className:\"w-16 m-0 p-0 bg-red-500 hover:bg-red-700 \",onClick:function onClick(){return approveMro(row.original.id);},children:[\" \",\"Approve\",\" \"]}),\" \",row.original.reason!=null&&(row.original.reason.includes(\"Subm\")||row.original.reason.includes(\"Appr\"))&&/*#__PURE__*/_jsx(Link,{to:\"/omros/\"+row.original.id+\"/viewPm\",children:/*#__PURE__*/_jsx(\"button\",{className:\" w-16 m-0 p-0 \",children:\" View PM \"})})]});}},{Header:\"Dak\",accessor:\"dak.dakidNo\"// Change this\n},{Header:\"Officer Name\",accessor:\"employee.officerName\",// Change this\nCell:function Cell(_ref2){var row=_ref2.row;return/*#__PURE__*/_jsx(\"div\",{children:row.original.employee!=null&&/*#__PURE__*/_jsxs(\"label\",{children:[row.original.employee.officerName,/*#__PURE__*/_jsx(\"br\",{}),row.original.employee.cdaoNo,row.original.employee.checkDigit]})});}},{Header:\"Min No\",accessor:\"minNo\"},{Header:\"MRO Date\",accessor:\"mroDate\"},{Header:\"MRO Amount\",accessor:\"amount\"},{Header:\"Record Status\",accessor:\"recordStatus\"},{Header:\"Reason\",accessor:\"reason\"}];},[data]);return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-100 text-gray-900\",children:/*#__PURE__*/_jsxs(\"main\",{className:\"max-w-8xl mx-auto px-4 sm:px-6 lg:px-8 pt-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 ml-4\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-semibold\",children:\"Omros\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flexContainer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"search\",onChange:function onChange(e){return setInputText(e.target.value);},onKeyPress:handleKeyPress,className:\"pl-2 -ml-2 inputField flex-initial\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",onClick:handleSubmit,className:\"w-16 m-0 p-0\",children:\"Search\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Link,{to:\"/omros/approvedList\",children:/*#__PURE__*/_jsx(\"button\",{className:\" w-32 ml-8 p-0 h-6 -mt-2\",children:\"Processed \"})})})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-semibold\",children:location.state})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"-mt-2 max-h-1 py-0\",children:/*#__PURE__*/_jsx(Table,{columns:columns,data:data,className:\"table-auto\"})})]})});}export default withRouter(OmroList);","map":{"version":3,"sources":["/home/itsdcsec/falconws/falcon_face/src/components/OmroList.js"],"names":["useState","useEffect","useMemo","Table","SelectColumnFilter","axios","withRouter","Link","useLocation","OmroList","data","setData","update","setUpdate","serverErrors","setServerErrors","search","setSearch","inputText","setInputText","cdaoNo","setCdaoNo","name","setName","empId","setEmpId","selectionType","setSelectionType","location","fetching","fetchData","get","then","response","catch","error","Error","submitMro","id","put","updatedRecords","filter","i","console","log","approveMro","remove","delete","handleClick","handleSubmit","event","preventDefault","handleKeyPress","keyCode","which","columns","Header","Cell","row","original","action","includes","reason","accessor","employee","officerName","checkDigit","e","target","value","state"],"mappings":"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","sourcesContent":["import { useState, useEffect, useMemo } from \"react\";\nimport Table, { SelectColumnFilter } from \"../utils/Table\"; //\nimport axios from \"axios\";\n\nimport { withRouter, Link, useLocation } from \"react-router-dom\";\n\nfunction OmroList() {\n  const [data, setData] = useState([]);\n  const [update, setUpdate] = useState(false);\n  const [serverErrors, setServerErrors] = useState([]);\n  const [search, setSearch] = useState(\"\");\n  const [inputText, setInputText] = useState(\"\");\n\n  const [cdaoNo, setCdaoNo] = useState(\"\");\n  const [name, setName] = useState(\"\");\n  const [empId, setEmpId] = useState(\"\");\n  const [selectionType, setSelectionType] = useState(\"\");\n  const location = useLocation();\n\n  useEffect(() => {\n    let fetching = false;\n    async function fetchData() {\n      if (!fetching)\n        if (selectionType === \"approved\") {\n          await axios\n            .get(\"/omros?filter=approved&search=\" + search)\n            .then((response) => {\n              setData(response.data);\n              setSelectionType(\"pending\");\n            })\n            .catch((error) => {\n              //console.log(error);\n              //console.log(error.response.status);\n              //console.log(error.response.headers);\n              if (error.response) setServerErrors(error.response.data.error);\n              else setServerErrors(error.Error);\n            });\n        } else {\n          await axios\n            .get(\"/omros?search=\" + search)\n            .then((response) => {\n              setData(response.data);\n              setSelectionType(\"pending\");\n            })\n            .catch((error) => {\n              //console.log(error);\n              //console.log(error.response.status);\n              //console.log(error.response.headers);\n              if (error.response) setServerErrors(error.response.data.error);\n              else setServerErrors(error.Error);\n            });\n        }\n    }\n    fetchData();\n    return () => {\n      fetching = true;\n    };\n  }, [update, search]);\n\n  async function submitMro(id) {\n    await axios\n      .put(`/omros/${id}/submitMro`)\n      .then(() => {\n        //console.log(data);\n        let updatedRecords = [...data].filter((i) => i.id !== id);\n        console.log(updatedRecords);\n        setData(updatedRecords);\n        setUpdate(!update);\n      })\n      .catch((error) => {\n        console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        if (error.response) setServerErrors(error.response.data.error);\n        else setServerErrors(error.Error);\n      });\n  }\n\n  async function approveMro(id) {\n    await axios\n      .put(`/omros/${id}/approveMro`)\n      .then(() => {\n        //console.log(data);\n        let updatedRecords = [...data].filter((i) => i.id !== id);\n        console.log(updatedRecords);\n        setData(updatedRecords);\n        setUpdate(!update);\n      })\n      .catch((error) => {\n        console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        if (error.response) setServerErrors(error.response.data.error);\n        else setServerErrors(error.Error);\n      });\n  }\n  async function remove(id) {\n    await axios\n      .delete(`/omros/${id}`)\n      .then(() => {\n        //console.log(data);\n        let updatedRecords = [...data].filter((i) => i.id !== id);\n        console.log(updatedRecords);\n        setData(updatedRecords);\n        setUpdate(!update);\n      })\n      .catch((error) => {\n        console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        if (error.response) setServerErrors(error.response.data.error);\n        else setServerErrors(error.Error);\n      });\n  }\n\n  const handleClick = () => {\n    let fetching = false;\n    async function fetchData() {\n      if (!fetching)\n        await axios\n          .get(`/omros?filter=approved`)\n          .then((response) => {\n            console.log(response.data);\n            setData(response.data);\n            setSelectionType(\"approved\");\n          })\n          .catch((error) => {\n            //console.log(error);\n            //console.log(error.response.status);\n            //console.log(error.response.headers);\n            if (error.response) setServerErrors(error.response.data.error);\n            else setServerErrors(error.Error);\n          });\n    }\n    fetchData();\n    return () => {\n      fetching = true;\n    };\n  };\n  const handleSubmit = (event) => {\n    event.preventDefault();\n    console.log(inputText);\n    setSearch(inputText);\n  };\n\n  const handleKeyPress = (event) => {\n    // look for the `Enter` keyCode\n    if (event.keyCode === 13 || event.which === 13) {\n      handleSubmit(event);\n    }\n  };\n  const columns = useMemo(\n    () => [\n      {\n        Header: \"Action\",\n        Cell: ({ row }) => (\n          <div>\n            {row.original.action != null &&\n              !row.original.action.includes(\"Subm\") &&\n              !row.original.action.includes(\"Appr\") && (\n                <Link to={\"/omros/\" + row.original.id}>\n                  <button className=\" w-16 m-0 p-0 \"> Edit </button>\n                </Link>\n              )}{\" \"}\n            {row.original.action === \"Submission by AAO.\" && (\n              <button\n                className=\"w-16 m-0 p-0 bg-red-500 hover:bg-red-700 \"\n                onClick={() => submitMro(row.original.id)}\n              >\n                {\" \"}\n                Submit{\" \"}\n              </button>\n            )}{\" \"}\n            {row.original.action === \"Approval by AO.\" && (\n              <button\n                className=\"w-16 m-0 p-0 bg-red-500 hover:bg-red-700 \"\n                onClick={() => approveMro(row.original.id)}\n              >\n                {\" \"}\n                Approve{\" \"}\n              </button>\n            )}{\" \"}\n            {row.original.reason != null &&\n              (row.original.reason.includes(\"Subm\") ||\n                row.original.reason.includes(\"Appr\")) && (\n                <Link to={\"/omros/\" + row.original.id + \"/viewPm\"}>\n                  <button className=\" w-16 m-0 p-0 \"> View PM </button>\n                </Link>\n              )}\n          </div>\n        ),\n      },\n      {\n        Header: \"Dak\",\n        accessor: \"dak.dakidNo\", // Change this\n      },\n\n      {\n        Header: \"Officer Name\",\n        accessor: \"employee.officerName\", // Change this\n        Cell: ({ row }) => (\n          <div>\n           {row.original.employee!=null &&\n            <label>\n              {row.original.employee.officerName}\n              <br />\n              {row.original.employee.cdaoNo}\n              {row.original.employee.checkDigit}\n            </label>\n            }\n          </div>\n        ),\n      },\n\n      {\n        Header: \"Min No\",\n        accessor: \"minNo\",\n      },\n\n      {\n        Header: \"MRO Date\",\n        accessor: \"mroDate\",\n      },\n\n      {\n        Header: \"MRO Amount\",\n        accessor: \"amount\",\n      },\n\n      {\n        Header: \"Record Status\",\n        accessor: \"recordStatus\",\n      },\n\n      {\n        Header: \"Reason\",\n        accessor: \"reason\",\n      },\n    ],\n    [data]\n  );\n\n  return (\n    <div className=\"min-h-screen bg-gray-100 text-gray-900\">\n      <main className=\"max-w-8xl mx-auto px-4 sm:px-6 lg:px-8 pt-4\">\n        <div className=\"mt-2 ml-4\">\n          <h1 className=\"text-xl font-semibold\">Omros</h1>\n          <div className=\"flexContainer\">\n            <input\n              type=\"text\"\n              name=\"search\"\n              onChange={(e) => setInputText(e.target.value)}\n              onKeyPress={handleKeyPress}\n              className=\"pl-2 -ml-2 inputField flex-initial\"\n            />\n            <button\n              type=\"submit\"\n              onClick={handleSubmit}\n              className=\"w-16 m-0 p-0\"\n            >\n              Search\n            </button>\n\n            <div>\n              <Link to={\"/omros/approvedList\"}>\n                <button className=\" w-32 ml-8 p-0 h-6 -mt-2\">Processed </button>\n              </Link>\n            </div>\n          </div>\n\n          <div>\n            <h1 className=\"text-xl font-semibold\">{location.state}</h1>\n          </div>\n        </div>\n\n        <div className=\"-mt-2 max-h-1 py-0\">\n          <Table columns={columns} data={data} className=\"table-auto\" />\n        </div>\n      </main>\n    </div>\n  );\n}\n\nexport default withRouter(OmroList);\n"]},"metadata":{},"sourceType":"module"}