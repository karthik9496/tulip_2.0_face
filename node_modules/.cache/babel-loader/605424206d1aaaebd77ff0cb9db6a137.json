{"ast":null,"code":"import _toConsumableArray from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/**\n * Code generated using Python\n * @author Raja Reddy\n * Date : 17 Oct 2021\n *\n * Modified By :\n */import{useState,useEffect,useRef,useMemo}from\"react\";import{withRouter,useParams,useHistory}from\"react-router-dom\";import{useForm}from\"react-hook-form\";import axios from\"axios\";import*as yup from\"yup\";import{yupResolver}from\"@hookform/resolvers/yup\";import LiveSearch from\"../utils/LiveSearch\";import DatePicker from\"react-datepicker\";import\"react-datepicker/dist/react-datepicker.css\";import addDays from\"date-fns/addDays\";import Tabs from\"react-bootstrap/Tabs\";import Tab from\"react-bootstrap/Tab\";//import TablePage from '../utils/TablePage';\nimport Table,{SelectColumnFilter}from'../utils/Table';import TablePage from\"../utils/TablePage\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var schema=yup.object({});var DsopAllocation=function DsopAllocation(){var _useForm=useForm({resolver:yupResolver(schema)}),register=_useForm.register,handleSubmit=_useForm.handleSubmit,setValue=_useForm.setValue,errors=_useForm.formState.errors,clearErrors=_useForm.clearErrors;var _useParams=useParams(),id=_useParams.id;//console.log(id);\nvar history=useHistory();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),serverErrors=_useState2[0],setServerErrors=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),entity=_useState4[0],setEntity=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),state=_useState6[0],setState=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),pendingList=_useState8[0],setPendingList=_useState8[1];var _useState9=useState(true),_useState10=_slicedToArray(_useState9,2),loading=_useState10[0],setLoading=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),mesg=_useState12[0],setMesg=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),taskList=_useState14[0],setTaskList=_useState14[1];var _useState15=useState(\"\"),_useState16=_slicedToArray(_useState15,2),taskNo=_useState16[0],setTaskNo=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),disabled=_useState18[0],setDisabled=_useState18[1];var _useState19=useState(\"Page1\"),_useState20=_slicedToArray(_useState19,2),key=_useState20[0],setKey=_useState20[1];var _useState21=useState(0),_useState22=_slicedToArray(_useState21,2),page=_useState22[0],setPage=_useState22[1];//pcdao -- for TablePage\nvar _useState23=useState(0),_useState24=_slicedToArray(_useState23,2),pageSize=_useState24[0],setPageSize=_useState24[1];useEffect(function(){var fetching=false;var unmounted=false;function fetchTaskData(){return _fetchTaskData.apply(this,arguments);}function _fetchTaskData(){_fetchTaskData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(fetching){_context.next=3;break;}_context.next=3;return axios.get(\"/tasks/taskList/dsopAllocate\").then(function(response){console.log(\"response section codce >>\"+response.data);setTaskList(response.data);if(!unmounted){setLoading(false);}}).catch(function(error){//console.log(error);\n//console.log(error.response.status);\n//console.log(error.response.headers);\nif(error.response)setServerErrors(error.response.data.error);else setServerErrors(error.Error);});case 3:case\"end\":return _context.stop();}}},_callee);}));return _fetchTaskData.apply(this,arguments);}fetchTaskData();return function(){fetching=true;unmounted=true;};// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);useEffect(function(){var fetching=false;var unmounted=false;function fetchPendingBillsForDsop(){return _fetchPendingBillsForDsop.apply(this,arguments);}function _fetchPendingBillsForDsop(){_fetchPendingBillsForDsop=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(fetching){_context2.next=3;break;}_context2.next=3;return axios.get(\"/tasks/pendingDsop/allocation\").then(function(response){setPendingList(response.data);if(!unmounted){setLoading(false);}}).catch(function(error){//console.log(error);\n//console.log(error.response.status);\n//console.log(error.response.headers);\nif(error.response)setServerErrors(error.response.data.error);else setServerErrors(error.Error);});case 3:case\"end\":return _context2.stop();}}},_callee2);}));return _fetchPendingBillsForDsop.apply(this,arguments);}fetchPendingBillsForDsop();return function(){fetching=true;unmounted=true;};// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);var allocateDsopBills=function allocateDsopBills(){if(disabled)return;//\tconsole.log(data);\n// console.log(\"data id--------------\" + reallocateTaskNo);\nsetDisabled(true);axios.put(\"/tasks/dsop/allocateBills\",taskList).then(function(response){if(response.status===200){setMesg(response.data);setPendingList([]);}}).catch(function(error){if(error.response)setServerErrors(error.response.data);else setServerErrors(error);});};var onError=function onError(errors,e){return console.log(errors,e);};//All foreign keys.\n// XXXXXX Add search fields and adjust the values as necessary\nvar errorCallback=function errorCallback(err){//console.log(err);\nsetServerErrors(err);};var handleCheckBox=function handleCheckBox(index){return function(e){//console.log(Table.page)\nconsole.log(e.target.checked+\"--\"+index);//csList[index].select=e.target.checked;\nconsole.log(e.target.checked);var item=taskList[index];item[\"select\"]=e.target.checked;var newData=_toConsumableArray(taskList);newData[index]=item;setTaskList(newData);//console.log(csList);\n};};var updateCheckBoxAll=function updateCheckBoxAll(e){// console.log(\"...\"+e.target.checked+\"--\"+index);\nvar newData=_toConsumableArray(taskList);for(var k in newData){newData[k].select=e.target.checked;}setTaskList(newData);};var handleInputChange=function handleInputChange(e){console.log(e.target.value);//\tconsole.log(\"handle input change\");\n};var callback=function callback(e){console.log(e);};var ShowTaskList=function ShowTaskList(){return/*#__PURE__*/_jsx(\"div\",{className:\"h-auto bg-green-100 text-gray-700\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-5xl mx-auto px-2 sm:px-6 lg:px-8 pt-0\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 ml-4\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Task List\"}),/*#__PURE__*/_jsxs(\"table\",{className:\"table table-striped table-bordered\",children:[/*#__PURE__*/_jsxs(\"thead\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Action\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Task No\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Pending\"})]}),/*#__PURE__*/_jsx(\"tbody\",{children:taskList&&taskList.map(function(d,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",onChange:handleCheckBox(index),checked:taskList[index]['select']})}),/*#__PURE__*/_jsx(\"td\",{children:d.taskNo}),/*#__PURE__*/_jsx(\"td\",{children:d.usrName}),/*#__PURE__*/_jsx(\"td\",{children:d.value1})]},d.id);})})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:allocateDsopBills,className:\"w-24 m-2 p-0\",children:\"Allocate Dsop Bills\"})]})})});};var ShowDsop=function ShowDsop(){var handleP=function handleP(pp){console.log(pp);setPage(pp);};//pcdao added below method for TablePage\nvar handlePageSize=function handlePageSize(pp){console.log(pp);setPageSize(pp);};var columns=useMemo(function(){return[{Header:\"CDAONo\",accessor:\"cdaoNo\",Cell:function Cell(_ref){var row=_ref.row;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"label\",{children:row.original.employee.cdaoNo})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"label\",{children:[\" \",row.original.employee.officerName]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"label\",{children:[\" \",row.original.employee.rank.rankName]})})]});}},{Header:\"Approval Amount\",accessor:\"approvalAmount\",Cell:function Cell(_ref2){var row=_ref2.row;return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"label\",{children:[\" \",row.original.approvalAmount]})});}}];},[pendingList,page,setPage]);return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-green-100\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"p-3  text-xl font-bold\",children:\"Dsop Pending List\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-5xl mx-auto px-6 sm:px-6 lg:px-4 pt-0\",children:[/*#__PURE__*/_jsx(\"div\",{className:\" \"}),/*#__PURE__*/_jsx(\"div\",{className:\"-mt-2 max-h-10 py-0 ml-0\",children:/*#__PURE__*/_jsx(TablePage,{columns:columns,data:pendingList,newpage:page,parentCallback:handleP,newPageSize:pageSize,parentCallbackPageSize:handlePageSize,className:\"table-auto\"})})]})]});};return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-100 text-gray-500\",children:/*#__PURE__*/_jsxs(\"main\",{className:\"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 pt-0\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 ml-4\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-semibold ml-4\",children:\"Dsop Bill Allocation\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:mesg}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 ml-4\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-semibold ml-4\",children:\"Task List\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 ml-4\",children:/*#__PURE__*/_jsx(ShowTaskList,{})}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 ml-4\",children:/*#__PURE__*/_jsx(ShowDsop,{})})]})});};export default withRouter(DsopAllocation);","map":{"version":3,"sources":["/home/itsdcsec/falconws/falcon_face/src/components/DsopAllocation.js"],"names":["useState","useEffect","useRef","useMemo","withRouter","useParams","useHistory","useForm","axios","yup","yupResolver","LiveSearch","DatePicker","addDays","Tabs","Tab","Table","SelectColumnFilter","TablePage","schema","object","DsopAllocation","resolver","register","handleSubmit","setValue","errors","formState","clearErrors","id","history","serverErrors","setServerErrors","entity","setEntity","state","setState","pendingList","setPendingList","loading","setLoading","mesg","setMesg","taskList","setTaskList","taskNo","setTaskNo","disabled","setDisabled","key","setKey","page","setPage","pageSize","setPageSize","fetching","unmounted","fetchTaskData","get","then","response","console","log","data","catch","error","Error","fetchPendingBillsForDsop","allocateDsopBills","put","status","onError","e","errorCallback","err","handleCheckBox","index","target","checked","item","newData","updateCheckBoxAll","k","select","handleInputChange","value","callback","ShowTaskList","map","d","usrName","value1","ShowDsop","handleP","pp","handlePageSize","columns","Header","accessor","Cell","row","original","employee","cdaoNo","officerName","rank","rankName","approvalAmount"],"mappings":"6mBAAA;AACA;AACA;AACA;AACA;AACA;AACA,GAEA,OAASA,QAAT,CAAmBC,SAAnB,CAA8BC,MAA9B,CAAsCC,OAAtC,KAAqD,OAArD,CACA,OAASC,UAAT,CAAqBC,SAArB,CAAgCC,UAAhC,KAAkD,kBAAlD,CACA,OAASC,OAAT,KAAwB,iBAAxB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAO,GAAKC,CAAAA,GAAZ,KAAqB,KAArB,CAEA,OAASC,WAAT,KAA4B,yBAA5B,CACA,MAAOC,CAAAA,UAAP,KAAuB,qBAAvB,CAEA,MAAOC,CAAAA,UAAP,KAAuB,kBAAvB,CACA,MAAO,4CAAP,CACA,MAAOC,CAAAA,OAAP,KAAoB,kBAApB,CAEA,MAAOC,CAAAA,IAAP,KAAiB,sBAAjB,CACA,MAAOC,CAAAA,GAAP,KAAgB,qBAAhB,CACA;AACA,MAAOC,CAAAA,KAAP,EAAeC,kBAAf,KAAyC,gBAAzC,CACA,MAAOC,CAAAA,SAAP,KAAsB,oBAAtB,C,wFAEA,GAAMC,CAAAA,MAAM,CAAGV,GAAG,CAACW,MAAJ,CAAW,EAAX,CAAf,CAEA,GAAMC,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,EAAM,cAOvBd,OAAO,CAAC,CACVe,QAAQ,CAAEZ,WAAW,CAACS,MAAD,CADX,CAAD,CAPgB,CAEzBI,QAFyB,UAEzBA,QAFyB,CAGzBC,YAHyB,UAGzBA,YAHyB,CAIzBC,QAJyB,UAIzBA,QAJyB,CAKZC,MALY,UAKzBC,SALyB,CAKZD,MALY,CAMzBE,WANyB,UAMzBA,WANyB,gBAWdvB,SAAS,EAXK,CAWrBwB,EAXqB,YAWrBA,EAXqB,CAY3B;AAEA,GAAIC,CAAAA,OAAO,CAAGxB,UAAU,EAAxB,CAd2B,cAgBaN,QAAQ,CAAC,EAAD,CAhBrB,wCAgBpB+B,YAhBoB,eAgBNC,eAhBM,8BAiBChC,QAAQ,CAAC,EAAD,CAjBT,yCAiBpBiC,MAjBoB,eAiBZC,SAjBY,8BAkBDlC,QAAQ,CAAC,EAAD,CAlBP,yCAkBpBmC,KAlBoB,eAkBbC,QAlBa,8BAqBWpC,QAAQ,CAAC,EAAD,CArBnB,yCAqBpBqC,WArBoB,eAqBPC,cArBO,8BAuBGtC,QAAQ,CAAC,IAAD,CAvBX,0CAuBpBuC,OAvBoB,gBAuBXC,UAvBW,gCAwBHxC,QAAQ,EAxBL,2CAwBpByC,IAxBoB,gBAwBdC,OAxBc,gCAyBK1C,QAAQ,CAAC,EAAD,CAzBb,2CAyBpB2C,QAzBoB,gBAyBVC,WAzBU,gCA2BC5C,QAAQ,CAAC,EAAD,CA3BT,2CA2BpB6C,MA3BoB,gBA2BZC,SA3BY,gCA8BK9C,QAAQ,CAAC,KAAD,CA9Bb,2CA8BpB+C,QA9BoB,gBA8BVC,WA9BU,gCAgCLhD,QAAQ,CAAC,OAAD,CAhCH,2CAgCpBiD,GAhCoB,gBAgCfC,MAhCe,gCAkCHlD,QAAQ,CAAC,CAAD,CAlCL,2CAkCpBmD,IAlCoB,gBAkCdC,OAlCc,gBAoC3B;AApC2B,gBAqCKpD,QAAQ,CAAC,CAAD,CArCb,2CAqCpBqD,QArCoB,gBAqCVC,WArCU,gBA0C3BrD,SAAS,CAAC,UAAM,CACd,GAAIsD,CAAAA,QAAQ,CAAG,KAAf,CACA,GAAIC,CAAAA,SAAS,CAAG,KAAhB,CAFc,QAICC,CAAAA,aAJD,iJAId,sIAEOF,QAFP,+CAIU/C,CAAAA,KAAK,CACRkD,GADG,iCAEHC,IAFG,CAEE,SAACC,QAAD,CAAc,CAClBC,OAAO,CAACC,GAAR,CAAY,4BAA8BF,QAAQ,CAACG,IAAnD,EACAnB,WAAW,CAACgB,QAAQ,CAACG,IAAV,CAAX,CAGA,GAAI,CAACP,SAAL,CAAgB,CACdhB,UAAU,CAAC,KAAD,CAAV,CACD,CACF,CAVG,EAWHwB,KAXG,CAWG,SAACC,KAAD,CAAW,CAChB;AACA;AACA;AACA,GAAIA,KAAK,CAACL,QAAV,CAAoB5B,eAAe,CAACiC,KAAK,CAACL,QAAN,CAAeG,IAAf,CAAoBE,KAArB,CAAf,CAApB,IACKjC,CAAAA,eAAe,CAACiC,KAAK,CAACC,KAAP,CAAf,CACN,CAjBG,CAJV,uDAJc,gDA2BdT,aAAa,GAEb,MAAO,WAAM,CACXF,QAAQ,CAAG,IAAX,CACAC,SAAS,CAAG,IAAZ,CACD,CAHD,CAIA;AACD,CAlCQ,CAkCN,EAlCM,CAAT,CAoCAvD,SAAS,CAAC,UAAM,CACd,GAAIsD,CAAAA,QAAQ,CAAG,KAAf,CACA,GAAIC,CAAAA,SAAS,CAAG,KAAhB,CAFc,QAICW,CAAAA,wBAJD,kLAId,2IAEOZ,QAFP,iDAGU/C,CAAAA,KAAK,CACRkD,GADG,kCAEHC,IAFG,CAEE,SAACC,QAAD,CAAc,CACjBtB,cAAc,CAACsB,QAAQ,CAACG,IAAV,CAAd,CAED,GAAI,CAACP,SAAL,CAAgB,CACdhB,UAAU,CAAC,KAAD,CAAV,CACD,CACF,CARG,EASHwB,KATG,CASG,SAACC,KAAD,CAAW,CAChB;AACA;AACA;AACA,GAAIA,KAAK,CAACL,QAAV,CAAoB5B,eAAe,CAACiC,KAAK,CAACL,QAAN,CAAeG,IAAf,CAAoBE,KAArB,CAAf,CAApB,IACKjC,CAAAA,eAAe,CAACiC,KAAK,CAACC,KAAP,CAAf,CACN,CAfG,CAHV,yDAJc,2DAyBdC,wBAAwB,GAExB,MAAO,WAAM,CACXZ,QAAQ,CAAG,IAAX,CACAC,SAAS,CAAG,IAAZ,CACD,CAHD,CAIA;AACD,CAhCQ,CAgCN,EAhCM,CAAT,CAmCA,GAAMY,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,EAAM,CAC9B,GAAIrB,QAAJ,CAAc,OACd;AACD;AACCC,WAAW,CAAC,IAAD,CAAX,CACAxC,KAAK,CAAC6D,GAAN,6BAAuC1B,QAAvC,EACGgB,IADH,CACQ,SAACC,QAAD,CAAc,CAElB,GAAIA,QAAQ,CAACU,MAAT,GAAoB,GAAxB,CAA6B,CAC3B5B,OAAO,CAACkB,QAAQ,CAACG,IAAV,CAAP,CACAzB,cAAc,CAAC,EAAD,CAAd,CACD,CACF,CAPH,EAQG0B,KARH,CAQS,SAACC,KAAD,CAAW,CAEhB,GAAIA,KAAK,CAACL,QAAV,CAAoB5B,eAAe,CAACiC,KAAK,CAACL,QAAN,CAAeG,IAAhB,CAAf,CAApB,IACK/B,CAAAA,eAAe,CAACiC,KAAD,CAAf,CACN,CAZH,EAeD,CApBD,CAsBA,GAAMM,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,CAAC7C,MAAD,CAAS8C,CAAT,QAAeX,CAAAA,OAAO,CAACC,GAAR,CAAYpC,MAAZ,CAAoB8C,CAApB,CAAf,EAAhB,CAEA;AACA;AAEA,GAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACC,GAAD,CAAS,CAC7B;AACA1C,eAAe,CAAC0C,GAAD,CAAf,CACD,CAHD,CAKA,GAAMC,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAACC,KAAD,QAAW,UAACJ,CAAD,CAAO,CACvC;AACAX,OAAO,CAACC,GAAR,CAAYU,CAAC,CAACK,MAAF,CAASC,OAAT,CAAmB,IAAnB,CAA0BF,KAAtC,EACA;AAEAf,OAAO,CAACC,GAAR,CAAYU,CAAC,CAACK,MAAF,CAASC,OAArB,EACA,GAAIC,CAAAA,IAAI,CAAGpC,QAAQ,CAACiC,KAAD,CAAnB,CAEAG,IAAI,CAAC,QAAD,CAAJ,CAAiBP,CAAC,CAACK,MAAF,CAASC,OAA1B,CACA,GAAIE,CAAAA,OAAO,oBAAOrC,QAAP,CAAX,CACAqC,OAAO,CAACJ,KAAD,CAAP,CAAiBG,IAAjB,CACAnC,WAAW,CAACoC,OAAD,CAAX,CACA;AACD,CAbsB,EAAvB,CAqBA,GAAMC,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,CAACT,CAAD,CAAO,CAC/B;AAEA,GAAIQ,CAAAA,OAAO,oBAAOrC,QAAP,CAAX,CACA,IAAK,GAAIuC,CAAAA,CAAT,GAAcF,CAAAA,OAAd,CAAuB,CACrBA,OAAO,CAACE,CAAD,CAAP,CAAWC,MAAX,CAAoBX,CAAC,CAACK,MAAF,CAASC,OAA7B,CACD,CACDlC,WAAW,CAACoC,OAAD,CAAX,CACD,CARD,CAWA,GAAMI,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,CAACZ,CAAD,CAAO,CAC/BX,OAAO,CAACC,GAAR,CAAYU,CAAC,CAACK,MAAF,CAASQ,KAArB,EACA;AACD,CAHD,CAKA,GAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACd,CAAD,CAAO,CACtBX,OAAO,CAACC,GAAR,CAAYU,CAAZ,EACD,CAFD,CAMC,GAAMe,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CAE7B,mBACK,YAAK,SAAS,CAAC,mCAAf,uBACH,YAAK,SAAS,CAAC,6CAAf,uBACC,aAAK,SAAS,CAAC,WAAf,wBACC,iCADD,cAEC,eAAO,SAAS,CAAC,oCAAjB,wBACA,sCACA,8BADA,cAEA,+BAFA,cAGA,4BAHA,cAIA,+BAJA,GADA,cAQA,uBACE5C,QAAQ,EAAIA,QAAQ,CAAC6C,GAAT,CAAa,SAACC,CAAD,CAAGb,KAAH,qBACD,mCACA,iCAAI,cAAO,IAAI,CAAC,UAAZ,CAAuB,QAAQ,CAAED,cAAc,CAACC,KAAD,CAA/C,CAAyD,OAAO,CAAEjC,QAAQ,CAACiC,KAAD,CAAR,CAAgB,QAAhB,CAAlE,EAAJ,EADA,cAEE,oBAAKa,CAAC,CAAC5C,MAAP,EAFF,cAGE,oBAAK4C,CAAC,CAACC,OAAP,EAHF,cAIE,oBAAKD,CAAC,CAACE,MAAP,EAJF,GAASF,CAAC,CAAC5D,EAAX,CADC,EAAb,CADd,EARA,GAFD,cAsBC,eACW,IAAI,CAAC,QADhB,CAEW,OAAO,CAAEuC,iBAFpB,CAGW,SAAS,CAAC,cAHrB,iCAtBD,GADD,EADG,EADL,CAwCE,CA1CA,CA2CA,GAAMwB,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,EAAM,CACtB,GAAMC,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,CAACC,EAAD,CAAQ,CACtBjC,OAAO,CAACC,GAAR,CAAYgC,EAAZ,EACA1C,OAAO,CAAC0C,EAAD,CAAP,CACD,CAHD,CAMH;AACG,GAAMC,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAACD,EAAD,CAAQ,CACjCjC,OAAO,CAACC,GAAR,CAAYgC,EAAZ,EACAxC,WAAW,CAACwC,EAAD,CAAX,CACE,CAHA,CAKA,GAAME,CAAAA,OAAO,CAAG7F,OAAO,CACrB,iBAAM,CAGJ,CACE8F,MAAM,CAAE,QADV,CAEJC,QAAQ,CAAE,QAFN,CAGEC,IAAI,CAAE,uBAAGC,CAAAA,GAAH,MAAGA,GAAH,oBACJ,oCACE,kCAEE,uBAAQA,GAAG,CAACC,QAAJ,CAAaC,QAAb,CAAsBC,MAA9B,EAFF,EADF,cAKE,kCACE,6BAASH,GAAG,CAACC,QAAJ,CAAaC,QAAb,CAAsBE,WAA/B,GADF,EALF,cAQE,kCACE,6BAASJ,GAAG,CAACC,QAAJ,CAAaC,QAAb,CAAsBG,IAAtB,CAA2BC,QAApC,GADF,EARF,GADI,EAHR,CAHI,CAsBJ,CACET,MAAM,CAAE,iBADV,CAEEC,QAAQ,CAAE,gBAFZ,CAGEC,IAAI,CAAE,wBAAGC,CAAAA,GAAH,OAAGA,GAAH,oBACN,kCACM,6BAASA,GAAG,CAACC,QAAJ,CAAaM,cAAtB,GADN,EADM,EAHR,CAtBI,CAAN,EADqB,CAmCrB,CAACtE,WAAD,CAAcc,IAAd,CAAoBC,OAApB,CAnCqB,CAAvB,CAqCJ,mBACE,aAAK,SAAS,CAAC,2BAAf,wBACC,WAAI,SAAS,CAAC,wBAAd,+BADD,cAEC,aAAK,SAAS,CAAC,6CAAf,wBACC,YAAK,SAAS,CAAC,GAAf,EADD,cAGC,YAAK,SAAS,CAAC,0BAAf,uBACC,KAAC,SAAD,EAAW,OAAO,CAAE4C,OAApB,CAA6B,IAAI,CAAE3D,WAAnC,CAAgD,OAAO,CAAEc,IAAzD,CACS,cAAc,CAAE0C,OADzB,CACmC,WAAW,CAAExC,QADhD,CAES,sBAAsB,CAAE0C,cAFjC,CAGS,SAAS,CAAC,YAHnB,EADD,EAHD,GAFD,GADF,CAmBG,CArEA,CAsED,mBAEE,YAAK,SAAS,CAAC,wCAAf,uBACD,cAAM,SAAS,CAAC,6CAAhB,wBAEH,YAAK,SAAS,CAAC,WAAf,uBACQ,WAAI,SAAS,CAAC,4BAAd,kCADR,EAFG,cAKA,YAAK,SAAS,CAAC,cAAf,UAA+BtD,IAA/B,EALA,cAMA,YAAK,SAAS,CAAC,WAAf,uBACK,WAAI,SAAS,CAAC,4BAAd,uBADL,EANA,cAWK,YAAK,SAAS,CAAC,WAAf,uBACE,KAAC,YAAD,IADF,EAXL,cAeM,YAAK,SAAS,CAAC,WAAf,uBAEE,KAAC,QAAD,IAFF,EAfN,GADC,EAFF,CA4BD,CAzUD,CA2UA,cAAerC,CAAAA,UAAU,CAACiB,cAAD,CAAzB","sourcesContent":["/**\n * Code generated using Python\n * @author Raja Reddy\n * Date : 17 Oct 2021\n *\n * Modified By :\n */\n\nimport { useState, useEffect, useRef, useMemo } from \"react\";\nimport { withRouter, useParams, useHistory } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport axios from \"axios\";\nimport * as yup from \"yup\";\n\nimport { yupResolver } from \"@hookform/resolvers/yup\";\nimport LiveSearch from \"../utils/LiveSearch\";\n\nimport DatePicker from \"react-datepicker\";\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport addDays from \"date-fns/addDays\";\n\nimport Tabs from \"react-bootstrap/Tabs\";\nimport Tab from \"react-bootstrap/Tab\";\n//import TablePage from '../utils/TablePage';\nimport Table,{ SelectColumnFilter } from '../utils/Table';\nimport TablePage from \"../utils/TablePage\";\n\nconst schema = yup.object({});\n\nconst DsopAllocation = () => {\n  const {\n    register,\n    handleSubmit,\n    setValue,\n    formState: { errors },\n    clearErrors,\n  } = useForm({\n    resolver: yupResolver(schema),\n  });\n\n  let { id } = useParams();\n  //console.log(id);\n\n  let history = useHistory();\n\n  const [serverErrors, setServerErrors] = useState([]);\n  const [entity, setEntity] = useState({});\n  const [state, setState] = useState({});\n\n   \n  const [pendingList, setPendingList] = useState([]);\n  \n  const [loading, setLoading] = useState(true);\n  const [mesg, setMesg] = useState();\n  const [taskList, setTaskList] = useState([]);\n  \n  const [taskNo, setTaskNo] = useState(\"\");\n  \n   \n  const [disabled, setDisabled] = useState(false);\n\n  const [key, setKey] = useState(\"Page1\");\n\n  const [page, setPage] = useState(0);\n\n  //pcdao -- for TablePage\n  const [pageSize, setPageSize] = useState(0);\n\n   \n   \n\n  useEffect(() => {\n    let fetching = false;\n    let unmounted = false;\n\n    async function fetchTaskData() {\n      \n      if (!fetching )\n        //console.log(secId);\n        await axios\n          .get(`/tasks/taskList/dsopAllocate`)\n          .then((response) => {\n            console.log(\"response section codce >>\" + response.data);\n            setTaskList(response.data);\n             \n\n            if (!unmounted) {\n              setLoading(false);\n            }\n          })\n          .catch((error) => {\n            //console.log(error);\n            //console.log(error.response.status);\n            //console.log(error.response.headers);\n            if (error.response) setServerErrors(error.response.data.error);\n            else setServerErrors(error.Error);\n          });\n    }\n    fetchTaskData();\n\n    return () => {\n      fetching = true;\n      unmounted = true;\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useEffect(() => {\n    let fetching = false;\n    let unmounted = false;\n\n    async function fetchPendingBillsForDsop() {\n      \n      if (!fetching) {\n        await axios\n          .get(`/tasks/pendingDsop/allocation`)\n          .then((response) => {\n             setPendingList(response.data);\n  \n            if (!unmounted) {\n              setLoading(false);\n            }\n          })\n          .catch((error) => {\n            //console.log(error);\n            //console.log(error.response.status);\n            //console.log(error.response.headers);\n            if (error.response) setServerErrors(error.response.data.error);\n            else setServerErrors(error.Error);\n          });\n      }\n    }\n    fetchPendingBillsForDsop();\n\n    return () => {\n      fetching = true;\n      unmounted = true;\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n \n  const allocateDsopBills = () => {\n    if (disabled) return;\n    //\tconsole.log(data);\n   // console.log(\"data id--------------\" + reallocateTaskNo);\n    setDisabled(true);\n    axios.put(`/tasks/dsop/allocateBills`, taskList)\n      .then((response) => {\n        \n        if (response.status === 200) {\n          setMesg(response.data);\n          setPendingList([]);\n        }\n      })\n      .catch((error) => {\n        \n        if (error.response) setServerErrors(error.response.data);\n        else setServerErrors(error);\n      });\n\n     \n  };\n\n  const onError = (errors, e) => console.log(errors, e);\n\n  //All foreign keys.\n  // XXXXXX Add search fields and adjust the values as necessary\n\n  const errorCallback = (err) => {\n    //console.log(err);\n    setServerErrors(err);\n  };\n\n  const handleCheckBox = (index) => (e) => {\n    //console.log(Table.page)\n    console.log(e.target.checked + \"--\" + index);\n    //csList[index].select=e.target.checked;\n\n    console.log(e.target.checked);\n    let item = taskList[index];\n\n    item[\"select\"] = e.target.checked;\n    let newData = [...taskList];\n    newData[index] = item;\n    setTaskList(newData);\n    //console.log(csList);\n  };\n\n   \n\n   \n\n   \n\n  const updateCheckBoxAll = (e) => {\n    // console.log(\"...\"+e.target.checked+\"--\"+index);\n\n    let newData = [...taskList];\n    for (var k in newData) {\n      newData[k].select = e.target.checked;\n    }\n    setTaskList(newData);\n  };\n   \n\n  const handleInputChange = (e) => {\n    console.log(e.target.value);\n    //\tconsole.log(\"handle input change\");\n  };\n\n  const callback = (e) => {\n    console.log(e);\n  };\n\n \n  \n   const ShowTaskList = () => {\n     \n\treturn (\n\t\t \t\t <div className=\"h-auto bg-green-100 text-gray-700\">\n\t\t\t<div className=\"max-w-5xl mx-auto px-2 sm:px-6 lg:px-8 pt-0\">\n\t\t\t\t<div className=\"mt-2 ml-4\">\n\t\t\t\t\t<h1>Task List</h1>\n\t\t\t\t\t<table className=\"table table-striped table-bordered\">\n\t\t\t\t\t<thead>\n\t\t\t\t\t<th>Action</th>\n\t\t\t\t\t<th>Task No</th>\n\t\t\t\t\t<th>Name</th>\n\t\t\t\t\t<th>Pending</th>\n\t\t\t\t\t\n\t\t\t\t\t</thead>\n\t\t\t\t\t<tbody>\n\t\t\t\t\t {taskList && taskList.map((d,index) => (\n                               <tr key={d.id}>\n                               <td><input type=\"checkbox\" onChange={handleCheckBox(index)}  checked={taskList[index]['select']}  /></td>\n                                 <td>{d.taskNo}</td>\n                                 <td>{d.usrName}</td>                                                              \n                                 <td>{d.value1}</td>\n                                 \n                               </tr>\n                             ))}\n\t\t\t\t\t</tbody>\n\t\t\t\t\t</table>\n\t\t\t\t <button\n                type=\"button\"\n                onClick={allocateDsopBills}\n                className=\"w-24 m-2 p-0\"\n              >\n                Allocate Dsop Bills\n              </button>\n\t\t\t\t \n\t\t\t\t</div>\n\t\t\t\t \n\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t \n\t);\n \n  };\n\t  const ShowDsop = () => {\n    const handleP = (pp) => {\n      console.log(pp);\n      setPage(pp);\n    };\n\n\n\t//pcdao added below method for TablePage\n    const handlePageSize = (pp) => {\n\t\tconsole.log(pp);\n\t\tsetPageSize(pp);\n\t  };\n\n    const columns = useMemo(\n      () => [\n        \n         \n        {\n          Header: \"CDAONo\",\n\t\t  accessor: \"cdaoNo\",\n          Cell: ({ row }) => (\n            <div>\n              <div>\n\t\t\t\t{/* pcdao -- modified below so that cdao no is picked from dak instead of cbill */}\n                <label>{row.original.employee.cdaoNo}</label>\n              </div>\n              <div>\n                <label> {row.original.employee.officerName}</label>\n              </div>\n              <div>\n                <label> {row.original.employee.rank.rankName}</label>\n              </div>\n            </div>\n          ),\n        },\n          \n        {\n          Header: \"Approval Amount\",\n          accessor: \"approvalAmount\",\n          Cell: ({ row }) => (\n          <div>\n                <label> {row.original.approvalAmount}</label>\n              </div>\n          ),\n        },\n\n        \n      ],\n      [pendingList, page, setPage]\n    );\nreturn (\n\t\t<div className=\"min-h-screen bg-green-100\">\n\t\t <h3 className=\"p-3  text-xl font-bold\">Dsop Pending List</h3>\n\t\t\t<div className=\"max-w-5xl mx-auto px-6 sm:px-6 lg:px-4 pt-0\">\n\t\t\t\t<div className=\" \">\n\t\t\t\t</div>\n\t\t\t\t<div className=\"-mt-2 max-h-10 py-0 ml-0\">\n\t\t\t\t\t<TablePage columns={columns} data={pendingList} newpage={page}\n              parentCallback={handleP}  newPageSize={pageSize}\n              parentCallbackPageSize={handlePageSize}\n              className=\"table-auto\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t</div>\n\t);\n     \n       \n    \n  }\n  return (\n\t \n    <div className=\"min-h-screen bg-gray-100 text-gray-500\">\n\t\t\t<main className=\"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 pt-0\">\n        \n<div className=\"mt-2 ml-4\">\n        <h1 className=\"text-xl font-semibold ml-4\">Dsop Bill Allocation</h1>\n</div>\n   <div className=\"text-red-500\">{mesg}</div>\n   <div className=\"mt-2 ml-4\">\n        <h1 className=\"text-xl font-semibold ml-4\">Task List</h1>\n</div>\n\n       \n        <div className=\"mt-2 ml-4\">\n          <ShowTaskList />\n           \n        </div>\n         <div className=\"mt-2 ml-4\">\n         \n           <ShowDsop />\n        </div>\n           </main>\n\t\t</div>\n      \n\t\t \n    \n  );\n};\n\nexport default withRouter(DsopAllocation);\n"]},"metadata":{},"sourceType":"module"}