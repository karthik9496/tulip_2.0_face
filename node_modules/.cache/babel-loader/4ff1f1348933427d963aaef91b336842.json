{"ast":null,"code":"var _jsxFileName = \"/home/itsdc3/Imp Tulip files/falconws160424/falconws/falcon_face/src/components/AlertEdit.js\";\n\n/**\n * Code generated using Python\n * @author Raja Reddy\n * Date : 17 Oct 2021\n *\n * Modified By : \n */\nimport { useState, useEffect, useRef } from \"react\";\nimport { withRouter, useParams, useHistory } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport axios from 'axios';\nimport * as yup from \"yup\";\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport LiveSearch from '../utils/LiveSearch';\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst schema = yup.object({\n  //employee: yup.object().required('Required'),\n  //nameOfMember: yup.string().required('Required'),\n  //dateOfBirth: yup.string().required('Required'),\n  //relation: yup.object().required('Required'),\n  //gender: yup.string().required('Required'),\n  priority: yup.number().required('Required'),\n  priority: yup.number().min(1).max(10),\n  alertMsg: yup.string().required('Required')\n});\n\nconst AlertEdit = () => {\n  var _errors$unit, _errors$priority, _errors$alertMsg;\n\n  const {\n    register,\n    handleSubmit,\n    setValue,\n    formState: {\n      errors\n    },\n    clearErrors\n  } = useForm({\n    resolver: yupResolver(schema)\n  });\n  let {\n    id\n  } = useParams(); //console.log(id);\n\n  let history = useHistory();\n  const [serverErrors, setServerErrors] = useState([]);\n  const [entity, setEntity] = useState({});\n  const [loading, setLoading] = useState(true);\n  const [empId, setEmpId] = useState(0);\n  const [key, setKey] = useState('Page1');\n  const [relationName, setRelationName] = useState(0);\n  const [fdId, setFdId] = useState();\n\n  const onSubmit = (data, event) => {\n    event.preventDefault();\n    console.log(data);\n\n    if (data.id) {\n      axios.put(\"/alerts/\" + data.id, data).then(response => {\n        if (response.status === 201) history.push(\"/alertList\");\n      }).catch(error => {\n        //console.log(error.response.data);\n        console.log(\"response--------\" + error.response.status); //console.log(error.response.headers);\n\n        setServerErrors(error.response.data);\n      });\n    } else {\n      axios.post(\"/alerts\", data).then(response => {\n        console.log(\"alert data sent\" + data);\n        console.log(\"reponse status--------------\" + response.status + \"--\" + response.statusText + \"----\" + \"-h--\" + response.headers + \"--\" + response.data);\n        if (response.status === 201) history.push(\"/alerts\");\n      }).catch(error => {\n        //console.log(error.response.data);\n        console.log(\"response--------\" + error.response.status);\n        if (error.response.status !== 201) history.push(\"/alerts\"); //console.log(error.response.headers);\n\n        if (error.response) setServerErrors(error.response.data);else setServerErrors(error);\n      });\n    } // history.push(\"/familyDetails\");\n\n  };\n\n  const onError = (errors, e) => console.log(errors, e);\n\n  const parentData = {\n    corps: {\n      title: \"Corps\",\n      url: \"corpss\",\n      searchList: ['unitCode', 'unitName'],\n      //XXXXXXXXX Add search fields here and also in the corresponding repository\n      fkEntity: \"corps\"\n    },\n    unit: {\n      title: \"Unit\",\n      url: \"units\",\n      searchList: ['unitCode', 'unitName'],\n      //XXXXXXXXX Add search fields here and also in the corresponding repository\n      fkEntity: \"unit\"\n    }\n  };\n\n  const callback = childData => {\n    setEntity(prev => ({ ...prev,\n      [childData.fk]: childData.entity\n    }));\n    setValue(childData.fk, childData.entity); //console.log(errors);\n    // console.log(childData.fk+\"--\"+childData.entity.id);\n\n    if (childData.fk === 'employee') setEmpId(childData.entity.id);\n    clearErrors(childData.fk);\n  };\n\n  const errorCallback = err => {\n    //console.log(err);\n    setServerErrors(err);\n  };\n\n  const handleButtonClick = e => {\n    history.push(\"/alerts\");\n  };\n\n  const handleInputChange = e => {\n    console.log(e.target.value); //\tconsole.log(\"handle input change\");\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-xl mx-auto \",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full w-3/4  mx-auto \",\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit(onSubmit, onError),\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: [id === 'new' ? 'Add' : 'Edit', \" Alert Message\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-red-500\",\n          children: serverErrors\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-2 gap-0 \",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(LiveSearch, {\n              name: \"corps\",\n              onChange: handleInputChange,\n              parentData: parentData.corps,\n              parentCallback: callback,\n              fkEntity: entity.corps,\n              errCallback: errorCallback\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 174,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(LiveSearch, {\n              name: \"unit\",\n              onChange: handleInputChange,\n              parentData: parentData.unit,\n              parentCallback: callback,\n              fkEntity: entity.unit,\n              errCallback: errorCallback\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 181,\n              columnNumber: 10\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-red-500 \",\n              children: (_errors$unit = errors.unit) === null || _errors$unit === void 0 ? void 0 : _errors$unit.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 184,\n              columnNumber: 10\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Priority (1-10) \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 188,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              name: \"priority\",\n              ...register(\"priority\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 189,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-red-500 \",\n              children: (_errors$priority = errors.priority) === null || _errors$priority === void 0 ? void 0 : _errors$priority.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 30\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-1 gap-0 \",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Alert Message\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n              rows: 3,\n              placeholder: \"Alert Message\",\n              className: \"form-control py-1\",\n              ...register(\"alertMsg\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-red-500 \",\n              children: (_errors$alertMsg = errors.alertMsg) === null || _errors$alertMsg === void 0 ? void 0 : _errors$alertMsg.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 212,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"px-2\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            children: \"Save\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 217,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"px-2\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: handleButtonClick,\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 221,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 159,\n    columnNumber: 9\n  }, this);\n};\n\nexport default withRouter(AlertEdit);","map":{"version":3,"sources":["/home/itsdc3/Imp Tulip files/falconws160424/falconws/falcon_face/src/components/AlertEdit.js"],"names":["useState","useEffect","useRef","withRouter","useParams","useHistory","useForm","axios","yup","yupResolver","LiveSearch","schema","object","priority","number","required","min","max","alertMsg","string","AlertEdit","register","handleSubmit","setValue","formState","errors","clearErrors","resolver","id","history","serverErrors","setServerErrors","entity","setEntity","loading","setLoading","empId","setEmpId","key","setKey","relationName","setRelationName","fdId","setFdId","onSubmit","data","event","preventDefault","console","log","put","then","response","status","push","catch","error","post","statusText","headers","onError","e","parentData","corps","title","url","searchList","fkEntity","unit","callback","childData","prev","fk","errorCallback","err","handleButtonClick","handleInputChange","target","value","message"],"mappings":"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","sourcesContent":["/**\n * Code generated using Python\n * @author Raja Reddy\n * Date : 17 Oct 2021\n *\n * Modified By : \n */\n\nimport { useState, useEffect, useRef } from \"react\";\nimport { withRouter, useParams, useHistory } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport axios from 'axios';\nimport * as yup from \"yup\";\n\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport LiveSearch from '../utils/LiveSearch';\n\nimport \"react-datepicker/dist/react-datepicker.css\";\n\nconst schema = yup.object({\n\n    //employee: yup.object().required('Required'),\n    //nameOfMember: yup.string().required('Required'),\n    //dateOfBirth: yup.string().required('Required'),\n    //relation: yup.object().required('Required'),\n    //gender: yup.string().required('Required'),\n    priority:yup.number().required('Required'),\n    priority:yup.number().min(1).max(10),\n   alertMsg:yup.string().required('Required'),\n\n});\n\n\n\nconst AlertEdit = () => {\n    const { register, handleSubmit, setValue, formState: { errors }, clearErrors } = useForm({\n        resolver: yupResolver(schema)\n    });\n\n    let { id } = useParams();\n    //console.log(id);\n\n    let history = useHistory();\n\n    const [serverErrors, setServerErrors] = useState([]);\n    const [entity, setEntity] = useState({});\n    const [loading, setLoading] = useState(true);\n    const [empId, setEmpId] = useState(0);\n    const [key, setKey] = useState('Page1');\n    const [relationName, setRelationName] = useState(0);\n    const [fdId, setFdId] = useState();\n\n\n    \n    const onSubmit = (data, event) => {\n        event.preventDefault();\n        console.log(data);\n        if (data.id) {\n            axios.put(\"/alerts/\" + data.id, data)\n                .then((response) => {\n                    if (response.status === 201)\n                        history.push(\"/alertList\");\n                })\n                .catch((error) => {\n                    //console.log(error.response.data);\n                    console.log(\"response--------\" + error.response.status);\n\n                    //console.log(error.response.headers);\n                    setServerErrors(error.response.data)\n                });\n        } else {\n            axios.post(\"/alerts\", data)\n                .then((response) => {\n                    console.log(\"alert data sent\"+data)\n                    console.log(\"reponse status--------------\" + response.status + \"--\" + response.statusText + \"----\" + \"-h--\" + response.headers + \"--\" + response.data);\n                    if (response.status === 201)\n                        history.push(\"/alerts\");\n\n                })\n                .catch((error) => {\n                    //console.log(error.response.data);\n                    console.log(\"response--------\" + error.response.status);\n                    if (error.response.status !== 201)\n                        history.push(\"/alerts\");\n                    //console.log(error.response.headers);\n                    if (error.response)\n                        setServerErrors(error.response.data);\n                    else\n                        setServerErrors(error);\n                });\n        }\n\n        // history.push(\"/familyDetails\");\n    }\n\n\n\n    const onError = (errors, e) => console.log(errors, e);\n\n    const parentData = {\n\n\n        corps: {\n            title: \"Corps\",\n            url: \"corpss\",\n            searchList: ['unitCode', 'unitName'], //XXXXXXXXX Add search fields here and also in the corresponding repository\n            fkEntity: \"corps\",\n        },\n\n        unit: {\n\t\t\ttitle: \"Unit\",\n\t\t\turl : \"units\",\n\t\t\tsearchList : ['unitCode','unitName'], //XXXXXXXXX Add search fields here and also in the corresponding repository\n\t\t\tfkEntity: \"unit\",\n\t\t},\n\n\n    }\n\n   \n\n    const callback = (childData) => {\n\n        setEntity(prev => ({ ...prev, [childData.fk]: childData.entity }));\n        setValue(childData.fk, childData.entity);\n        //console.log(errors);\n        // console.log(childData.fk+\"--\"+childData.entity.id);\n\n        if (childData.fk === 'employee')\n            setEmpId(childData.entity.id)\n\n\n\n        clearErrors(childData.fk);\n\n    };\n\n    const errorCallback = (err) => {\n        //console.log(err);\n        setServerErrors(err);\n    }\n\n    const handleButtonClick = (e) => {\n        history.push(\"/alerts\");\n    }\n\n\n\n    const handleInputChange = (e) => {\n        console.log(e.target.value);\n        //\tconsole.log(\"handle input change\");\n\n\n    };\n\n\n\n    return (\n        <div className=\"max-w-xl mx-auto \">\n            <div className=\"w-full w-3/4  mx-auto \" >\n\n                <form onSubmit={handleSubmit(onSubmit, onError)}>\n\n                    <h1 >{id === 'new' ? 'Add' : 'Edit'} Alert Message</h1>\n                    <div className=\"text-red-500\">{serverErrors}</div>\n\n\n\n                    <div className=\"grid grid-cols-2 gap-0 \">\n\n\n\n                        <div >\n                            <LiveSearch name=\"corps\" onChange={handleInputChange}\n                                parentData={parentData.corps} parentCallback={callback}\n                                fkEntity={entity.corps} errCallback={errorCallback} />\n\n                        </div>\n\n                        <div >\n\t\t\t\t\t\t\t\t\t<LiveSearch name=\"unit\" onChange={handleInputChange}\n\t\t\t\t\t\t\t\t\t\tparentData={parentData.unit} parentCallback={callback} \n\t\t\t\t\t\t\t\t\t\tfkEntity={entity.unit} errCallback={errorCallback} />\n\t\t\t\t\t\t\t\t\t<div className=\"text-red-500 \">{errors.unit?.message}</div>\n\t\t\t\t\t\t\t\t</div>\t\n\n                        <div>\n                            <label>Priority (1-10) </label>\n                            <input type=\"number\" name=\"priority\" {...register(\"priority\")}\n                            />\n                             <div className=\"text-red-500 \">{errors.priority?.message}</div>\n                        </div>\n\n\n\n\n\n\n\n\n                    </div>\n                    <div className=\"grid grid-cols-1 gap-0 \">\n                        <div>\n                            <label>Alert Message</label>\n                            <textarea\n                                rows={3}\n                                placeholder=\"Alert Message\"\n                                className=\"form-control py-1\"\n                                {...register(\"alertMsg\")}\n                                \n                            />\n                            <div className=\"text-red-500 \">{errors.alertMsg?.message}</div>\n                        </div>\n                    </div>\n\n                    <div className=\"px-2\">\n                        <button type=\"submit\" >Save</button>\n                    </div>\n\n                    <div className=\"px-2\">\n                        <button type=\"button\" onClick={handleButtonClick} >Cancel</button>\n                    </div>\n\n\n                </form>\n            </div>\n        </div>\n    );\n};\n\n\nexport default withRouter(AlertEdit);"]},"metadata":{},"sourceType":"module"}