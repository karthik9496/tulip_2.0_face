{"ast":null,"code":"var _jsxFileName = \"/home/itsdcsec/falconws/falcon_face/src/components/StipendList.js\";\nimport { useState, useEffect, useMemo } from \"react\";\nimport Table, { SelectColumnFilter } from \"../utils/Table\";\nimport axios from \"axios\";\nimport { withRouter, Link, useHistory } from \"react-router-dom\";\nimport { BasicLoadingIcon } from \"../utils/Icons\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction StipendList() {\n  const [data, setData] = useState([]);\n  const [update, setUpdate] = useState(false);\n  const [serverErrors, setServerErrors] = useState([]);\n  const [search, setSearch] = useState(\"\");\n  const [inputText, setInputText] = useState(\"\");\n  const [mesg, setMesg] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [loggedInUsr, setLoggedInUsr] = useState({});\n  const [disabled, setDisabled] = useState(false);\n  const [desgLevel, setDesgLevel] = useState(0);\n  const [dakid, setDakid] = useState('');\n  useEffect(() => {\n    function getSectionState() {\n      let usr = JSON.parse(sessionStorage.getItem(\"usr\"));\n      if (usr) setDesgLevel(usr.designation.designationLevel);\n      console.log(usr.designation.designationLevel);\n    }\n\n    getSectionState();\n  }, []);\n  useEffect(() => {\n    let fetching = false;\n\n    async function fetchData() {\n      setLoading(true);\n      if (!fetching) await axios.get(\"/stipends?search=\" + search).then(response => {\n        setLoading(false);\n        setData(response.data);\n      }).catch(error => {\n        setLoading(false); //console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n\n        if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n      });\n    }\n\n    fetchData();\n    return () => {\n      fetching = true;\n    };\n  }, [update, search]);\n\n  async function approve(id) {\n    await axios.put(`/stipends/${id}/approve`).then(response => {\n      setMesg(response.data);\n      setData([]);\n    }).catch(error => {\n      console.log(error); //console.log(error.response.status);\n      //console.log(error.response.headers);\n\n      if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n    });\n  }\n\n  async function print(id) {\n    await axios.get(`/stipends/printExtnSheet/${id}`).then(response => {\n      //console.log(data);\n      const url = window.open(`${process.env.REACT_APP_BASE_URL}/files/${response.data}`);\n    }).catch(error => {\n      console.log(error); //console.log(error.response.status);\n      //console.log(error.response.headers);\n\n      if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n    });\n  }\n\n  async function submit(id) {\n    await axios.put(`/stipends/submit/${id}`).then(response => {\n      //console.log(data);\n      setMesg(response.data);\n      let updatedRecords = [...data].filter(i => i.id !== id); //console.log(updatedRecords);\n\n      setData(updatedRecords);\n    }).catch(error => {\n      console.log(error); //console.log(error.response.status);\n      //console.log(error.response.headers);\n\n      if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n    });\n  }\n\n  async function rollBack(id) {\n    await axios.put(`/stipends/rollBack/${id}`).then(response => {\n      //console.log(data);\n      setMesg(response.data);\n      let updatedRecords = [...data];\n      console.log(updatedRecords);\n      setData(updatedRecords);\n      setUpdate(!update);\n    }).catch(error => {\n      console.log(error); //console.log(error.response.status);\n      //console.log(error.response.headers);\n\n      if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n    });\n  }\n\n  async function pm() {\n    console.log(\">>>>>>>>>>>:\" + search);\n\n    if (!dakid) {\n      alert(\"Enter dak id in search field.\");\n    }\n\n    await axios.get(`/stipends/pm/${dakid}`).then(response => {\n      //console.log(data);\n      setMesg(response.data);\n      setServerErrors(response.data);\n      setDisabled(false);\n    }).catch(error => {\n      console.log(error); //console.log(error.response.status);\n      //console.log(error.response.headers);\n\n      if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n    });\n  }\n\n  async function reempReport() {\n    console.log(\">>>>>>>>>>>:\" + search);\n\n    if (!dakid) {\n      alert(\"Enter dak id in search field.\");\n    }\n\n    await axios.get(`/stipends/nominalRoll/${dakid}`).then(response => {\n      //console.log(data);\n      setMesg(response.data);\n      let fname = response.data[0];\n      setServerErrors(response.data);\n      setDisabled(false);\n\n      if (fname != null && fname.length > 0) {\n        axios({\n          url: `/stipends/stipend/load/` + fname,\n          method: 'GET',\n          responseType: 'blob' // important\n\n        }).then(res => {\n          //console.log(response.data);\n          const url = URL.createObjectURL(new Blob([res.data], {\n            type: \"application/pdf\"\n          }));\n          const pdfWindow = window.open();\n          pdfWindow.location.href = url;\n          const link = pdfWindow.location.href;\n        });\n      }\n    }).catch(error => {\n      console.log(error); //console.log(error.response.status);\n      //console.log(error.response.headers);\n\n      if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n    });\n  }\n\n  async function approveBulk() {\n    let i = 0;\n    var selectedList = [];\n\n    for (i = 0; i < data.length; i++) {\n      if (data[i].select !== null && data[i].select === true) selectedList.push(data[i]);\n    }\n\n    console.log(selectedList);\n\n    if (selectedList.length === 0) {\n      alert(\"No selection done.\");\n      return;\n    }\n\n    let proceed = window.confirm(\"You are about to approve file containing \" + selectedList.length + \" records.\");\n    if (!proceed) return;\n    if (disabled) return;\n    setDisabled(true);\n    await axios.put(`/stipends/bulkApprove`, data).then(response => {\n      setDisabled(false);\n      let updatedRecords = [...data];\n      console.log(updatedRecords);\n      setData(updatedRecords);\n      setUpdate(!update);\n      setDisabled(false);\n    }).catch(error => {\n      //\tconsole.log(error);\n      //console.log(error.response.status);\n      //console.log(error.response.headers);\n      if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n    });\n  }\n\n  const updateCheckBoxAll = e => {\n    // console.log(\"...\"+e.target.checked+\"--\"+index);\n    let newData = [...data];\n\n    for (var k in newData) {\n      newData[k].select = e.target.checked;\n    }\n\n    setData(newData);\n  };\n\n  const handleCheckBox = index => e => {\n    //console.log(Table.page)\n    console.log(e.target.checked + \"--\" + index);\n    console.log(e.target.checked);\n    let item = data[index];\n    item['select'] = e.target.checked;\n    let newData = [...data];\n    newData[index] = item;\n    setData(newData);\n  };\n\n  const columns = useMemo(() => [{\n    Header: /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"checkbox\",\n      onChange: updateCheckBoxAll\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 276,\n      columnNumber: 12\n    }, this),\n    accessor: \"select\",\n    Cell: ({\n      row\n    }) => /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: desgLevel > 30 && /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"checkbox\",\n          onChange: handleCheckBox(row.index),\n          checked: data[row.index]['select']\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 5\n      }, this)\n    }, void 0, false)\n  }, {\n    Header: \"Action\",\n    Cell: ({\n      row\n    }) => /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [row.original.action != null && row.original.action.includes(\"edit\") && /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/stipends/\" + row.original.id,\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \" w-16 m-0 p-0 \",\n          children: \" Edit \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 19\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 17\n      }, this), \" \", row.original.action != null && row.original.action.includes(\"edit\") && row.original.recordStatus != null && row.original.recordStatus === \"V\" && /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"w-16 m-0 p-0 bg-red-500 hover:bg-red-700 \",\n        onClick: () => submit(row.original.id),\n        children: [\" \", \"Submit\", \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 17\n      }, this), \" \", row.original.action != null && row.original.action.includes(\"subm\") && /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"w-16 m-0 p-0 bg-red-500 hover:bg-red-700 \",\n        onClick: () => submit(row.original.id),\n        children: [\" \", \"Submit\", \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 17\n      }, this), \" \", desgLevel > 30 && /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"w-16 m-0 p-0 bg-red-500 hover:bg-red-700 \",\n        onClick: () => rollBack(row.original.id),\n        children: [\" \", \"Roll Back\", \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 325,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 11\n    }, this)\n  }, {\n    Header: \"DakId No\",\n    accessor: \"dak.dakidNo\",\n    Cell: ({\n      row\n    }) => /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"label\", {\n        children: row.original.dak.dakidNo\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 6\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 341,\n      columnNumber: 5\n    }, this)\n  }, {\n    Header: \"CDAONo\",\n    accessor: \"employee.cdaoNo\"\n  }, {\n    Header: \"IC No\",\n    accessor: \"employee.icNo\"\n  }, {\n    Header: \"Officer Name\",\n    accessor: \"employee.officerName\"\n  }, {\n    Header: \"Letter No\",\n    accessor: \"letterNo\" // Change this\n\n  }, {\n    Header: \"Letter Date\",\n    accessor: \"letterDate\"\n  }, {\n    Header: \"Mro No\",\n    accessor: \"mroNo\" // Change this\n\n  }, {\n    Header: \"Mro Date\",\n    accessor: \"mroDate\"\n  }, {\n    Header: \"Mro Type\",\n    accessor: \"mroNature\"\n  }, {\n    Header: \"Amount\",\n    accessor: \"amount\"\n  }, {\n    Header: \"From Date\",\n    accessor: \"fromDate\"\n  }, {\n    Header: \"To Date\",\n    accessor: \"toDate\"\n  }, {\n    Header: \"Record Status\",\n    accessor: \"recordStatus\"\n  }, {\n    Header: \"Section Remarks\",\n    accessor: \"sectionRemarks\"\n  }, {\n    Header: \"Reason\",\n    accessor: \"reason\"\n  }\n  /*\n  {\n  Header: \"Login Name\",\n  accessor: 'loginName',\n  Filter: SelectColumnFilter,  // new\n  filter: 'includes',\n  },\n  */\n  ], [data]);\n\n  const handleKeyPress = event => {\n    // look for the `Enter` keyCode\n    if (event.keyCode === 13 || event.which === 13) {\n      handleSubmit(event);\n    }\n  };\n\n  const handleSubmit = event => {\n    event.preventDefault();\n    console.log(inputText);\n    setSearch(inputText);\n  };\n\n  const handleBlur = e => setDakid(e.target.value);\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gray-100 text-gray-900\",\n    children: /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"max-w-8xl mx-auto px-4 sm:px-6 lg:px-8 pt-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-2 ml-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-xl font-semibold\",\n          children: \"Stipend\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 440,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flexContainer\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"search\",\n              placeholder: \"DakId No Starting with R\",\n              onChange: e => setInputText(e.target.value),\n              onBlur: handleBlur,\n              onKeyPress: handleKeyPress,\n              className: \"pl-2 -ml-2 inputField flex-initial\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 443,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              onClick: handleSubmit,\n              className: \" w-32 ml-8 p-0 h-6 -mt-2\",\n              children: \"Search\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 452,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 442,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              onClick: reempReport,\n              className: \" w-46 ml-8 p-0 h-6 -mt-2\",\n              children: \"Stipend Report\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 460,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 459,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              onClick: reempReport,\n              className: \" w-46 ml-8 p-0 h-6 -mt-2\",\n              children: \"Generate PM\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 466,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 465,\n            columnNumber: 14\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              to: \"/stipends/approvedList\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \" w-42 ml-8 p-0 h-6 -mt-2\",\n                children: \"Processed/Approved \"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 473,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 472,\n              columnNumber: 14\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 471,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 441,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 439,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-red-500\",\n        children: mesg\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 479,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"-mt-2 max-h-1 py-0\",\n        children: [/*#__PURE__*/_jsxDEV(Table, {\n          columns: columns,\n          data: data,\n          className: \"table-auto\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 483,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: desgLevel > 30 && /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: approveBulk,\n            className: \"w-36 m-2 p-0\",\n            children: \" Approve\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 487,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 485,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 482,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 438,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 437,\n    columnNumber: 5\n  }, this);\n}\n\nexport default withRouter(StipendList);","map":{"version":3,"sources":["/home/itsdcsec/falconws/falcon_face/src/components/StipendList.js"],"names":["useState","useEffect","useMemo","Table","SelectColumnFilter","axios","withRouter","Link","useHistory","BasicLoadingIcon","StipendList","data","setData","update","setUpdate","serverErrors","setServerErrors","search","setSearch","inputText","setInputText","mesg","setMesg","loading","setLoading","loggedInUsr","setLoggedInUsr","disabled","setDisabled","desgLevel","setDesgLevel","dakid","setDakid","getSectionState","usr","JSON","parse","sessionStorage","getItem","designation","designationLevel","console","log","fetching","fetchData","get","then","response","catch","error","Error","approve","id","put","print","url","window","open","process","env","REACT_APP_BASE_URL","submit","updatedRecords","filter","i","rollBack","pm","alert","reempReport","fname","length","method","responseType","res","URL","createObjectURL","Blob","type","pdfWindow","location","href","link","approveBulk","selectedList","select","push","proceed","confirm","updateCheckBoxAll","e","newData","k","target","checked","handleCheckBox","index","item","columns","Header","accessor","Cell","row","original","action","includes","recordStatus","dak","dakidNo","handleKeyPress","event","keyCode","which","handleSubmit","preventDefault","handleBlur","value"],"mappings":"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","sourcesContent":["import { useState, useEffect, useMemo } from \"react\";\n\nimport Table, { SelectColumnFilter } from \"../utils/Table\";\nimport axios from \"axios\";\nimport { withRouter, Link, useHistory } from \"react-router-dom\";\nimport { BasicLoadingIcon } from \"../utils/Icons\";\n\nfunction StipendList() {\n  const [data, setData] = useState([]);\n  const [update, setUpdate] = useState(false);\n  const [serverErrors, setServerErrors] = useState([]);\n  const [search, setSearch] = useState(\"\");\n  const [inputText, setInputText] = useState(\"\");\n  const [mesg, setMesg] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [loggedInUsr, setLoggedInUsr] = useState({});\n  const [disabled,setDisabled]=useState(false);\n  const [desgLevel,setDesgLevel]=useState(0);\n  const [dakid,setDakid]=useState('');\n\n\t useEffect(() => {\n    function getSectionState() {\n      let usr = JSON.parse(sessionStorage.getItem(\"usr\"));\n      if(usr)\n      \tsetDesgLevel(usr.designation.designationLevel);\n       \n      console.log(usr.designation.designationLevel);\n    }\n\n    getSectionState();\n  }, []);\n  \n  useEffect(() => {\n    let fetching = false;\n    async function fetchData() {\n      setLoading(true);\n      if (!fetching)\n        await axios\n          .get(\"/stipends?search=\" + search)\n          .then((response) => {\n            setLoading(false);\n            setData(response.data);\n            \n          })\n          .catch((error) => {\n            setLoading(false);\n            //console.log(error);\n            //console.log(error.response.status);\n            //console.log(error.response.headers);\n            if (error.response) setServerErrors(error.response.data.error);\n            else setServerErrors(error.Error);\n          });\n    }\n    fetchData();\n    return () => {\n      fetching = true;\n    };\n  }, [update, search]);\n\n  async function approve(id) {\n    await axios\n      .put(`/stipends/${id}/approve`)\n      .then((response) => {\n        setMesg(response.data);\n        setData([]);\n      })\n      .catch((error) => {\n        console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        if (error.response) setServerErrors(error.response.data.error);\n        else setServerErrors(error.Error);\n      });\n  }\n\n  async function print(id) {\n    await axios\n      .get(`/stipends/printExtnSheet/${id}`)\n      .then((response) => {\n        //console.log(data);\n        const url = window.open(\n          `${process.env.REACT_APP_BASE_URL}/files/${response.data}`\n        );\n      })\n      .catch((error) => {\n        console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        if (error.response) setServerErrors(error.response.data.error);\n        else setServerErrors(error.Error);\n      });\n  }\n  async function submit(id) {\n    await axios.put(`/stipends/submit/${id}`)\n      .then((response) => {\n        //console.log(data);\n        setMesg(response.data);\n        let updatedRecords = [...data].filter((i) => i.id !== id);\n        //console.log(updatedRecords);\n        setData(updatedRecords);\n      })\n      .catch((error) => {\n        console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        if (error.response) setServerErrors(error.response.data.error);\n        else setServerErrors(error.Error);\n      });\n  }\n  \n   async function rollBack(id) {\n    await axios.put(`/stipends/rollBack/${id}`)\n      .then((response) => {\n        //console.log(data);\n        setMesg(response.data);\n        let updatedRecords = [...data];\n\t\t\t\tconsole.log(updatedRecords);\n\t\t\t\tsetData(updatedRecords);\n\t\t\t\tsetUpdate(!update);\n        \n      })\n      .catch((error) => {\n        console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        if (error.response) setServerErrors(error.response.data.error);\n        else setServerErrors(error.Error);\n      });\n  }\n  \n   async function pm() {\n\tconsole.log(\">>>>>>>>>>>:\" + search);\n\tif(!dakid){\n\t\talert(\"Enter dak id in search field.\");\n\t}\n    await axios.get(`/stipends/pm/${dakid}`)\n      .then((response) => {\n        //console.log(data);\n        setMesg(response.data);\n        \t\t    \n\t\t\t  \tsetServerErrors(response.data);\n\t\t\t    setDisabled(false);\n\t\t\t    \n\t\t\t    \n       \n      })\n      .catch((error) => {\n        console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        if (error.response) setServerErrors(error.response.data.error);\n        else setServerErrors(error.Error);\n      });\n  }\n    \n   async function reempReport() {\n\tconsole.log(\">>>>>>>>>>>:\" + search);\n\tif(!dakid){\n\t\talert(\"Enter dak id in search field.\");\n\t}\n    await axios.get(`/stipends/nominalRoll/${dakid}`)\n      .then((response) => {\n        //console.log(data);\n        setMesg(response.data);\n        \t\t   let fname=response.data[0];\n\t\t\t  \tsetServerErrors(response.data);\n\t\t\t    setDisabled(false);\n\t\t\t    \n\t\t\t    if(fname!=null && fname.length>0){\n\t\t\taxios({\n\t\t\turl: `/stipends/stipend/load/` + fname, \n\t\t\tmethod: 'GET',\n\t\t\tresponseType: 'blob', // important\n\t\t}).then((res) => {\n\t\t\t//console.log(response.data);\n\t\t\tconst url =URL.createObjectURL(new Blob([res.data],{type:\"application/pdf\"}));\n\t\t\tconst pdfWindow=window.open();\n\t\t\tpdfWindow.location.href=url;\n\t\t\tconst link=pdfWindow.location.href;\n\t\t\t \n\t\t});\n\t\t}\n       \n      })\n      .catch((error) => {\n        console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        if (error.response) setServerErrors(error.response.data.error);\n        else setServerErrors(error.Error);\n      });\n  }\n  \n  \n\tasync function approveBulk() {\n\t \n\t let i=0;\n\t\tvar selectedList=[];\n\t\t \n\t\tfor(i=0;i<data.length;i++){\n\t\t\tif(data[i].select!==null && data[i].select===true)\n\t\t\t\tselectedList.push(data[i]);\n\t\t}\n\t\tconsole.log(selectedList);\n\t\t\n\t\tif(selectedList.length===0){\n\t\t\talert(\"No selection done.\");\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tlet proceed=window.confirm(\"You are about to approve file containing \"+selectedList.length+\" records.\");\n\t\tif(!proceed)\n\t\t\treturn;\n\t\t\n\t\tif(disabled)\n\t\t\treturn;\n\t\t\t\n\t\t\tsetDisabled(true);\n\t\tawait axios.put(`/stipends/bulkApprove`, data)\n\t\t\t.then((response) => {\n\t\t\t\t \n\t\t\t\tsetDisabled(false);\n\t\t\t\t \n\t\t\t \n\t\t\tlet updatedRecords = [...data];\n\t\t\t\tconsole.log(updatedRecords);\n\t\t\t\tsetData(updatedRecords);\n\t\t\t\tsetUpdate(!update);\n\t\t\t\tsetDisabled(false);\n\t\t\t\t\n\t\t\n\t\t \n\t\t\t\t \n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t//\tconsole.log(error);\n\t\t\t\t//console.log(error.response.status);\n\t\t\t\t//console.log(error.response.headers);\n\t\t\t\tif (error.response)\n\t\t\t\t\tsetServerErrors(error.response.data.error);\n\t\t\t\telse\n\t\t\t\t\tsetServerErrors(error.Error);\n\t\t\t});\n\t}\n\tconst updateCheckBoxAll = (e) => {\n\t\t// console.log(\"...\"+e.target.checked+\"--\"+index);\n\n\t\tlet newData = [...data];\n\t\tfor (var k in newData) {\n\t\t\tnewData[k].select = e.target.checked;\n\t\t}\n\t\tsetData(newData);\n\n\n\t}\n\tconst handleCheckBox = index => (e) => {\n\t\t//console.log(Table.page)\n\t\tconsole.log(e.target.checked + \"--\" + index);\n\n\n\n\t\tconsole.log(e.target.checked);\n\t\tlet item = data[index];\n\n\t\titem['select'] = e.target.checked;\n\t\tlet newData = [...data];\n\t\tnewData[index] = item;\n\t\tsetData(newData);\n\n\n\n\t}\n  const columns = useMemo(\n    () => [\n\t\t\t{\n\t\t\tHeader: <input type=\"checkbox\" onChange={updateCheckBoxAll} />,\n\t\t\taccessor: \"select\",\n\t\t\tCell: ({ row }) => (\n\t\t\t\t<>\n\t\t\t\t<div>\n\t\t\t\t\t{(desgLevel>30) &&\n\t\t\t\t\t\t<input type=\"checkbox\" onChange={handleCheckBox(row.index)} checked={data[row.index]['select']} />\n\t\t\t\t\t}\n\n\t\t\t\t</div>\n\t\t\t\t \n\t\t\t\t</>\n\n\t\t\t)\n\n\t\t},\n      {\n        Header: \"Action\",\n        Cell: ({ row }) => (\n          <div>\n            {row.original.action != null &&\n              row.original.action.includes(\"edit\") && (\n                <Link to={\"/stipends/\" + row.original.id}>\n                  <button className=\" w-16 m-0 p-0 \"> Edit </button>\n                </Link>\n              )}{\" \"}\n            {row.original.action != null &&\n              row.original.action.includes(\"edit\") &&\n              row.original.recordStatus != null &&\n              row.original.recordStatus === \"V\" && (\n                <button\n                  className=\"w-16 m-0 p-0 bg-red-500 hover:bg-red-700 \"\n                  onClick={() => submit(row.original.id)}\n                >\n                  {\" \"}\n                  Submit{\" \"}\n                </button>\n              )}{\" \"}\n            {row.original.action != null &&\n              row.original.action.includes(\"subm\") && (\n                <button\n                  className=\"w-16 m-0 p-0 bg-red-500 hover:bg-red-700 \"\n                  onClick={() => submit(row.original.id)}\n                >\n                  {\" \"}\n                  Submit{\" \"}\n                </button>\n              )}{\" \"}\n               {desgLevel>30 && \n                <button\n                  className=\"w-16 m-0 p-0 bg-red-500 hover:bg-red-700 \"\n                  onClick={() => rollBack(row.original.id)}\n                >\n                  {\" \"}\n                  Roll Back{\" \"}\n                </button>\n              }\n             \n          </div>\n        ),\n      },\n\t {\n        Header: \"DakId No\",\n        accessor: \"dak.dakidNo\",\n        Cell: ({ row }) => (\n\t\t\t\t<div>\n\n\t\t\t\t\t<label>{row.original.dak.dakidNo}</label>\n\t\t\t\t</div>\n\t\t\t)\n      },\t\n      {\n        Header: \"CDAONo\",\n        accessor: \"employee.cdaoNo\",\n      },\n      {\n        Header: \"IC No\",\n        accessor: \"employee.icNo\",\n      },\n      {\n        Header: \"Officer Name\",\n        accessor: \"employee.officerName\",\n      },\n\n      {\n        Header: \"Letter No\",\n        accessor: \"letterNo\", // Change this\n      },\n\n      {\n        Header: \"Letter Date\",\n        accessor: \"letterDate\",\n      },\n       {\n        Header: \"Mro No\",\n        accessor: \"mroNo\", // Change this\n      },\n\n      {\n        Header: \"Mro Date\",\n        accessor: \"mroDate\",\n      },\n      {\n        Header: \"Mro Type\",\n        accessor: \"mroNature\",\n      },\n       {\n        Header: \"Amount\",\n        accessor: \"amount\",\n      },\n      \n       {\n        Header: \"From Date\",\n        accessor: \"fromDate\",\n      },\n       {\n        Header: \"To Date\",\n        accessor: \"toDate\",\n      },\n\n      {\n        Header: \"Record Status\",\n        accessor: \"recordStatus\",\n      },\n      {\n        Header: \"Section Remarks\",\n        accessor: \"sectionRemarks\",\n      },\n       {\n        Header: \"Reason\",\n        accessor: \"reason\",\n      },\n      \n\n      /*\n\t\t{\n\t\t\tHeader: \"Login Name\",\n\t\t\taccessor: 'loginName',\n\t\t\tFilter: SelectColumnFilter,  // new\n\t\t\tfilter: 'includes',\n\t\t},\n\t\t*/\n    ],\n    [data]\n  );\n\n  const handleKeyPress = (event) => {\n    // look for the `Enter` keyCode\n    if (event.keyCode === 13 || event.which === 13) {\n      handleSubmit(event);\n    }\n  };\n\n  const handleSubmit = (event) => {\n    event.preventDefault();\n    console.log(inputText);\n    setSearch(inputText);\n  };\n  const handleBlur = (e) => setDakid(e.target.value);\n\n  return (\n    <div className=\"min-h-screen bg-gray-100 text-gray-900\">\n      <main className=\"max-w-8xl mx-auto px-4 sm:px-6 lg:px-8 pt-4\">\n        <div className=\"mt-2 ml-4\">\n          <h1 className=\"text-xl font-semibold\">Stipend</h1>\n          <div className=\"flexContainer\">\n          <div>\n            <input\n              type=\"text\"\n              name=\"search\"\n              placeholder=\"DakId No Starting with R\"\n              onChange={(e) => setInputText(e.target.value)}\n              onBlur={handleBlur}\n              onKeyPress={handleKeyPress}\n              className=\"pl-2 -ml-2 inputField flex-initial\"\n            />\n            <button type=\"submit\" onClick={handleSubmit} className=\" w-32 ml-8 p-0 h-6 -mt-2\" >\n              Search\n            </button>\n            </div>\n            \n            \n             \n            <div>\n            <button type=\"submit\" onClick={reempReport} className=\" w-46 ml-8 p-0 h-6 -mt-2\" >\n              Stipend Report\n            </button>\n            </div>\n            \n             <div>\n            <button type=\"submit\" onClick={reempReport} className=\" w-46 ml-8 p-0 h-6 -mt-2\" >\n              Generate PM\n            </button>\n            </div>\n            \n              <div>\n             <Link to={\"/stipends/approvedList\"}>\n                <button className=\" w-42 ml-8 p-0 h-6 -mt-2\">Processed/Approved </button>\n              </Link>\n            </div>\n             \n          </div>\n        </div>\n        <div className=\"text-red-500\">{mesg}</div>\n\n      \n          <div className=\"-mt-2 max-h-1 py-0\">\n            <Table columns={columns} data={data} className=\"table-auto\" />\n            \n            <div>\n          {(desgLevel>30) &&\n\t\t\t\t\t\t<button type=\"button\" onClick={approveBulk} className=\"w-36 m-2 p-0\"> Approve</button>\n\t\t\t\t\t\t}\n          </div>\n          </div>\n          \n         \n        \n      </main>\n       \n    </div>\n  );\n}\n\nexport default withRouter(StipendList);\n"]},"metadata":{},"sourceType":"module"}