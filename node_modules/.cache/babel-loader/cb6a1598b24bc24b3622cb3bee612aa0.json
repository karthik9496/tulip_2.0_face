{"ast":null,"code":"var _jsxFileName = \"/home/itsdc3/Imp Tulip files/falconws160424/falconws/falcon_face/src/components/StipendList.js\";\nimport { useState, useEffect, useMemo } from \"react\";\nimport Table, { SelectColumnFilter } from \"../utils/Table\";\nimport axios from \"axios\";\nimport { withRouter, Link, useHistory } from \"react-router-dom\";\nimport { BasicLoadingIcon } from \"../utils/Icons\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction StipendList() {\n  const [data, setData] = useState([]);\n  const [update, setUpdate] = useState(false);\n  const [serverErrors, setServerErrors] = useState([]);\n  const [search, setSearch] = useState(\"\");\n  const [inputText, setInputText] = useState(\"\");\n  const [mesg, setMesg] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [loggedInUsr, setLoggedInUsr] = useState({});\n  const [disabled, setDisabled] = useState(false);\n  const [desgLevel, setDesgLevel] = useState(0);\n  const [dakid, setDakid] = useState(\"\");\n  useEffect(() => {\n    function getSectionState() {\n      let usr = JSON.parse(sessionStorage.getItem(\"usr\"));\n      if (usr) setDesgLevel(usr.designation.designationLevel);\n      console.log(usr.designation.designationLevel);\n    }\n\n    getSectionState();\n  }, []);\n  useEffect(() => {\n    let fetching = false;\n\n    async function fetchData() {\n      setLoading(true);\n      if (!fetching) await axios.get(\"/stipends?search=\" + search).then(response => {\n        setLoading(false);\n        setData(response.data);\n      }).catch(error => {\n        setLoading(false); //console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n\n        if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n      });\n    }\n\n    fetchData();\n    return () => {\n      fetching = true;\n    };\n  }, [update, search]);\n\n  async function approve(id) {\n    await axios.put(`/stipends/${id}/approve`).then(response => {\n      setMesg(response.data);\n      setData([]);\n    }).catch(error => {\n      console.log(error); //console.log(error.response.status);\n      //console.log(error.response.headers);\n\n      if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n    });\n  }\n\n  async function print(id) {\n    await axios.get(`/stipends/printExtnSheet/${id}`).then(response => {\n      //console.log(data);\n      const url = window.open(`${process.env.REACT_APP_BASE_URL}/files/${response.data}`);\n    }).catch(error => {\n      console.log(error); //console.log(error.response.status);\n      //console.log(error.response.headers);\n\n      if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n    });\n  }\n\n  async function submit(id) {\n    await axios.put(`/stipends/submit/${id}`).then(response => {\n      //console.log(data);\n      setMesg(response.data);\n      let updatedRecords = [...data].filter(i => i.id !== id); //console.log(updatedRecords);\n\n      setData(updatedRecords);\n    }).catch(error => {\n      console.log(error); //console.log(error.response.status);\n      //console.log(error.response.headers);\n\n      if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n    });\n  }\n\n  async function rollBack(id) {\n    await axios.put(`/stipends/rollBack/${id}`).then(response => {\n      //console.log(data);\n      setMesg(response.data);\n      let updatedRecords = [...data];\n      console.log(updatedRecords);\n      setData(updatedRecords);\n      setUpdate(!update);\n    }).catch(error => {\n      console.log(error); //console.log(error.response.status);\n      //console.log(error.response.headers);\n\n      if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n    });\n  }\n\n  async function pm() {\n    console.log(\">>>>>>>>>>>:\" + search);\n\n    if (!dakid) {\n      alert(\"Enter dak id in search field.\");\n    }\n\n    await axios.post(`/stipends/pm/${dakid}`).then(response => {\n      //console.log(data);\n      setMesg(response.data);\n      setServerErrors(response.data);\n      setDisabled(false);\n    }).catch(error => {\n      console.log(error); //console.log(error.response.status);\n      //console.log(error.response.headers);\n\n      if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n    });\n  }\n\n  async function reempReport() {\n    console.log(\">>>>>>>>>>>:\" + search);\n\n    if (!dakid) {\n      alert(\"Enter dak id in search field.\");\n    }\n\n    await axios.get(`/stipends/nominalRoll/${dakid}`).then(response => {\n      //console.log(data);\n      setMesg(response.data);\n      let fname = response.data[0];\n      setServerErrors(response.data);\n      setDisabled(false);\n\n      if (fname != null && fname.length > 0) {\n        axios({\n          url: `/stipends/stipend/load/` + fname,\n          method: \"GET\",\n          responseType: \"blob\" // important\n\n        }).then(res => {\n          //console.log(response.data);\n          const url = URL.createObjectURL(new Blob([res.data], {\n            type: \"application/pdf\"\n          }));\n          const pdfWindow = window.open();\n          pdfWindow.location.href = url;\n          const link = pdfWindow.location.href;\n        });\n      }\n    }).catch(error => {\n      console.log(error); //console.log(error.response.status);\n      //console.log(error.response.headers);\n\n      if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n    });\n  }\n\n  async function approveBulk() {\n    let i = 0;\n    var selectedList = [];\n\n    for (i = 0; i < data.length; i++) {\n      if (data[i].select !== null && data[i].select === true) selectedList.push(data[i]);\n    }\n\n    console.log(selectedList);\n\n    if (selectedList.length === 0) {\n      alert(\"No selection done.\");\n      return;\n    }\n\n    let proceed = window.confirm(\"You are about to approve file containing \" + selectedList.length + \" records.\");\n    if (!proceed) return;\n    if (disabled) return;\n    setDisabled(true);\n    await axios.put(`/stipends/bulkApprove`, data).then(response => {\n      setDisabled(false);\n      let updatedRecords = [...data];\n      console.log(updatedRecords);\n      setData(updatedRecords);\n      setUpdate(!update);\n      setDisabled(false);\n    }).catch(error => {\n      //\tconsole.log(error);\n      //console.log(error.response.status);\n      //console.log(error.response.headers);\n      if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n    });\n  }\n\n  const updateCheckBoxAll = e => {\n    // console.log(\"...\"+e.target.checked+\"--\"+index);\n    let newData = [...data];\n\n    for (var k in newData) {\n      newData[k].select = e.target.checked;\n    }\n\n    setData(newData);\n  };\n\n  const handleCheckBox = index => e => {\n    //console.log(Table.page)\n    console.log(e.target.checked + \"--\" + index);\n    console.log(e.target.checked);\n    let item = data[index];\n    item[\"select\"] = e.target.checked;\n    let newData = [...data];\n    newData[index] = item;\n    setData(newData);\n  };\n\n  const columns = useMemo(() => [{\n    Header: /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"checkbox\",\n      onChange: updateCheckBoxAll\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 17\n    }, this),\n    accessor: \"select\",\n    Cell: ({\n      row\n    }) => /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: desgLevel > 30 && /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"checkbox\",\n          onChange: handleCheckBox(row.index),\n          checked: data[row.index][\"select\"]\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 13\n      }, this)\n    }, void 0, false)\n  }, {\n    Header: \"Action\",\n    Cell: ({\n      row\n    }) => /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [row.original.action != null && row.original.action.includes(\"edit\") && /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/stipends/\" + row.original.id,\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \" w-16 m-0 p-0 \",\n          children: \" Edit \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 283,\n          columnNumber: 19\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 282,\n        columnNumber: 17\n      }, this), \" \", row.original.action != null && row.original.action.includes(\"edit\") && /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/stipendsNew/\" + row.original.id,\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \" w-16 m-0 p-0 \",\n          children: \" Edit N \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 19\n        }, this), \"   \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 17\n      }, this), \" \", row.original.action != null && row.original.action.includes(\"edit\") && row.original.recordStatus != null && row.original.recordStatus === \"V\" && /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"w-16 m-0 p-0 bg-red-500 hover:bg-red-700 \",\n        onClick: () => submit(row.original.id),\n        children: [\" \", \"Submit\", \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 17\n      }, this), \" \", row.original.action != null && row.original.action.includes(\"subm\") && /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"w-16 m-0 p-0 bg-red-500 hover:bg-red-700 \",\n        onClick: () => submit(row.original.id),\n        children: [\" \", \"Submit\", \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 17\n      }, this), \" \", desgLevel > 30 && /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"w-16 m-0 p-0 bg-red-500 hover:bg-red-700 \",\n        onClick: () => rollBack(row.original.id),\n        children: [\" \", \"Roll Back\", \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 15\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 11\n    }, this)\n  }, {\n    Header: \"DakId No\",\n    accessor: \"dak.dakidNo\",\n    Cell: ({\n      row\n    }) => /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"label\", {\n        children: row.original.dak.dakidNo\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 331,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 330,\n      columnNumber: 11\n    }, this)\n  }, {\n    Header: \"CDAONo\",\n    accessor: \"employee.cdaoNo\"\n  }, {\n    Header: \"IC No\",\n    accessor: \"employee.icNo\"\n  }, {\n    Header: \"Officer Name\",\n    accessor: \"employee.officerName\"\n  }, {\n    Header: \"Letter No\",\n    accessor: \"letterNo\" // Change this\n\n  }, {\n    Header: \"Letter Date\",\n    accessor: \"letterDate\"\n  }, {\n    Header: \"Mro No\",\n    accessor: \"mroNo\" // Change this\n\n  }, {\n    Header: \"Mro Date\",\n    accessor: \"mroDate\"\n  }, {\n    Header: \"Mro Type\",\n    accessor: \"mroNature\"\n  }, {\n    Header: \"Amount\",\n    accessor: \"amount\"\n  }, {\n    Header: \"From Date\",\n    accessor: \"fromDate\"\n  }, {\n    Header: \"To Date\",\n    accessor: \"toDate\"\n  }, {\n    Header: \"Record Status\",\n    accessor: \"recordStatus\"\n  }, {\n    Header: \"Section Remarks\",\n    accessor: \"sectionRemarks\"\n  }, {\n    Header: \"Reason\",\n    accessor: \"reason\"\n  }\n  /*\n  {\n  Header: \"Login Name\",\n  accessor: 'loginName',\n  Filter: SelectColumnFilter,  // new\n  filter: 'includes',\n  },\n  */\n  ], [data]);\n\n  const handleKeyPress = event => {\n    // look for the `Enter` keyCode\n    if (event.keyCode === 13 || event.which === 13) {\n      handleSubmit(event);\n    }\n  };\n\n  const handleSubmit = event => {\n    event.preventDefault();\n    console.log(inputText);\n    setSearch(inputText);\n  };\n\n  const handleBlur = e => setDakid(e.target.value);\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gray-100 text-gray-900\",\n    children: /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"max-w-8xl mx-auto px-4 sm:px-6 lg:px-8 pt-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-2 ml-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-xl font-semibold\",\n          children: \"Stipend\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 427,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flexContainer\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"search\",\n              placeholder: \"DakId No Starting with R\",\n              onChange: e => setInputText(e.target.value),\n              onBlur: handleBlur,\n              onKeyPress: handleKeyPress,\n              className: \"pl-2 -ml-2 inputField flex-initial\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 430,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              onClick: handleSubmit,\n              className: \" w-32 ml-8 p-0 h-6 -mt-2\",\n              children: \"Search\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 439,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 429,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              onClick: reempReport,\n              className: \" w-46 ml-8 p-0 h-6 -mt-2\",\n              children: \"Stipend Report\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 449,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 448,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              onClick: pm,\n              className: \" w-46 ml-8 p-0 h-6 -mt-2\",\n              children: \"Generate PM\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 459,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 458,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              to: \"/stipends/approvedList\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \" w-42 ml-8 p-0 h-6 -mt-2\",\n                children: [\"Processed/Approved\", \" \"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 470,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 469,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 468,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 428,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 426,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-red-500\",\n        children: mesg\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 477,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"-mt-2 max-h-1 py-0\",\n        children: [/*#__PURE__*/_jsxDEV(Table, {\n          columns: columns,\n          data: data,\n          className: \"table-auto\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 480,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: desgLevel > 30 && /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: approveBulk,\n            className: \"w-36 m-2 p-0\",\n            children: [\" \", \"Approve\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 484,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 482,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 479,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 425,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 424,\n    columnNumber: 5\n  }, this);\n}\n\nexport default withRouter(StipendList);","map":{"version":3,"sources":["/home/itsdc3/Imp Tulip files/falconws160424/falconws/falcon_face/src/components/StipendList.js"],"names":["useState","useEffect","useMemo","Table","SelectColumnFilter","axios","withRouter","Link","useHistory","BasicLoadingIcon","StipendList","data","setData","update","setUpdate","serverErrors","setServerErrors","search","setSearch","inputText","setInputText","mesg","setMesg","loading","setLoading","loggedInUsr","setLoggedInUsr","disabled","setDisabled","desgLevel","setDesgLevel","dakid","setDakid","getSectionState","usr","JSON","parse","sessionStorage","getItem","designation","designationLevel","console","log","fetching","fetchData","get","then","response","catch","error","Error","approve","id","put","print","url","window","open","process","env","REACT_APP_BASE_URL","submit","updatedRecords","filter","i","rollBack","pm","alert","post","reempReport","fname","length","method","responseType","res","URL","createObjectURL","Blob","type","pdfWindow","location","href","link","approveBulk","selectedList","select","push","proceed","confirm","updateCheckBoxAll","e","newData","k","target","checked","handleCheckBox","index","item","columns","Header","accessor","Cell","row","original","action","includes","recordStatus","dak","dakidNo","handleKeyPress","event","keyCode","which","handleSubmit","preventDefault","handleBlur","value"],"mappings":"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","sourcesContent":["import { useState, useEffect, useMemo } from \"react\";\n\nimport Table, { SelectColumnFilter } from \"../utils/Table\";\nimport axios from \"axios\";\nimport { withRouter, Link, useHistory } from \"react-router-dom\";\nimport { BasicLoadingIcon } from \"../utils/Icons\";\n\nfunction StipendList() {\n  const [data, setData] = useState([]);\n  const [update, setUpdate] = useState(false);\n  const [serverErrors, setServerErrors] = useState([]);\n  const [search, setSearch] = useState(\"\");\n  const [inputText, setInputText] = useState(\"\");\n  const [mesg, setMesg] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [loggedInUsr, setLoggedInUsr] = useState({});\n  const [disabled, setDisabled] = useState(false);\n  const [desgLevel, setDesgLevel] = useState(0);\n  const [dakid, setDakid] = useState(\"\");\n\n  useEffect(() => {\n    function getSectionState() {\n      let usr = JSON.parse(sessionStorage.getItem(\"usr\"));\n      if (usr) setDesgLevel(usr.designation.designationLevel);\n\n      console.log(usr.designation.designationLevel);\n    }\n\n    getSectionState();\n  }, []);\n\n  useEffect(() => {\n    let fetching = false;\n    async function fetchData() {\n      setLoading(true);\n      if (!fetching)\n        await axios\n          .get(\"/stipends?search=\" + search)\n          .then((response) => {\n            setLoading(false);\n            setData(response.data);\n          })\n          .catch((error) => {\n            setLoading(false);\n            //console.log(error);\n            //console.log(error.response.status);\n            //console.log(error.response.headers);\n            if (error.response) setServerErrors(error.response.data.error);\n            else setServerErrors(error.Error);\n          });\n    }\n    fetchData();\n    return () => {\n      fetching = true;\n    };\n  }, [update, search]);\n\n  async function approve(id) {\n    await axios\n      .put(`/stipends/${id}/approve`)\n      .then((response) => {\n        setMesg(response.data);\n        setData([]);\n      })\n      .catch((error) => {\n        console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        if (error.response) setServerErrors(error.response.data.error);\n        else setServerErrors(error.Error);\n      });\n  }\n\n  async function print(id) {\n    await axios\n      .get(`/stipends/printExtnSheet/${id}`)\n      .then((response) => {\n        //console.log(data);\n        const url = window.open(\n          `${process.env.REACT_APP_BASE_URL}/files/${response.data}`\n        );\n      })\n      .catch((error) => {\n        console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        if (error.response) setServerErrors(error.response.data.error);\n        else setServerErrors(error.Error);\n      });\n  }\n  async function submit(id) {\n    await axios\n      .put(`/stipends/submit/${id}`)\n      .then((response) => {\n        //console.log(data);\n        setMesg(response.data);\n        let updatedRecords = [...data].filter((i) => i.id !== id);\n        //console.log(updatedRecords);\n        setData(updatedRecords);\n      })\n      .catch((error) => {\n        console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        if (error.response) setServerErrors(error.response.data.error);\n        else setServerErrors(error.Error);\n      });\n  }\n\n  async function rollBack(id) {\n    await axios\n      .put(`/stipends/rollBack/${id}`)\n      .then((response) => {\n        //console.log(data);\n        setMesg(response.data);\n        let updatedRecords = [...data];\n        console.log(updatedRecords);\n        setData(updatedRecords);\n        setUpdate(!update);\n      })\n      .catch((error) => {\n        console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        if (error.response) setServerErrors(error.response.data.error);\n        else setServerErrors(error.Error);\n      });\n  }\n\n  async function pm() {\n    console.log(\">>>>>>>>>>>:\" + search);\n    if (!dakid) {\n      alert(\"Enter dak id in search field.\");\n    }\n    await axios\n      .post(`/stipends/pm/${dakid}`)\n      .then((response) => {\n        //console.log(data);\n        setMesg(response.data);\n\n        setServerErrors(response.data);\n        setDisabled(false);\n      })\n      .catch((error) => {\n        console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        if (error.response) setServerErrors(error.response.data.error);\n        else setServerErrors(error.Error);\n      });\n  }\n\n  async function reempReport() {\n    console.log(\">>>>>>>>>>>:\" + search);\n    if (!dakid) {\n      alert(\"Enter dak id in search field.\");\n    }\n    await axios\n      .get(`/stipends/nominalRoll/${dakid}`)\n      .then((response) => {\n        //console.log(data);\n        setMesg(response.data);\n        let fname = response.data[0];\n        setServerErrors(response.data);\n        setDisabled(false);\n\n        if (fname != null && fname.length > 0) {\n          axios({\n            url: `/stipends/stipend/load/` + fname,\n            method: \"GET\",\n            responseType: \"blob\", // important\n          }).then((res) => {\n            //console.log(response.data);\n            const url = URL.createObjectURL(\n              new Blob([res.data], { type: \"application/pdf\" })\n            );\n            const pdfWindow = window.open();\n            pdfWindow.location.href = url;\n            const link = pdfWindow.location.href;\n          });\n        }\n      })\n      .catch((error) => {\n        console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        if (error.response) setServerErrors(error.response.data.error);\n        else setServerErrors(error.Error);\n      });\n  }\n\n  async function approveBulk() {\n    let i = 0;\n    var selectedList = [];\n\n    for (i = 0; i < data.length; i++) {\n      if (data[i].select !== null && data[i].select === true)\n        selectedList.push(data[i]);\n    }\n    console.log(selectedList);\n\n    if (selectedList.length === 0) {\n      alert(\"No selection done.\");\n      return;\n    }\n\n    let proceed = window.confirm(\n      \"You are about to approve file containing \" +\n        selectedList.length +\n        \" records.\"\n    );\n    if (!proceed) return;\n\n    if (disabled) return;\n\n    setDisabled(true);\n    await axios\n      .put(`/stipends/bulkApprove`, data)\n      .then((response) => {\n        setDisabled(false);\n\n        let updatedRecords = [...data];\n        console.log(updatedRecords);\n        setData(updatedRecords);\n        setUpdate(!update);\n        setDisabled(false);\n      })\n      .catch((error) => {\n        //\tconsole.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        if (error.response) setServerErrors(error.response.data.error);\n        else setServerErrors(error.Error);\n      });\n  }\n  const updateCheckBoxAll = (e) => {\n    // console.log(\"...\"+e.target.checked+\"--\"+index);\n\n    let newData = [...data];\n    for (var k in newData) {\n      newData[k].select = e.target.checked;\n    }\n    setData(newData);\n  };\n  const handleCheckBox = (index) => (e) => {\n    //console.log(Table.page)\n    console.log(e.target.checked + \"--\" + index);\n\n    console.log(e.target.checked);\n    let item = data[index];\n\n    item[\"select\"] = e.target.checked;\n    let newData = [...data];\n    newData[index] = item;\n    setData(newData);\n  };\n  const columns = useMemo(\n    () => [\n      {\n        Header: <input type=\"checkbox\" onChange={updateCheckBoxAll} />,\n        accessor: \"select\",\n        Cell: ({ row }) => (\n          <>\n            <div>\n              {desgLevel > 30 && (\n                <input\n                  type=\"checkbox\"\n                  onChange={handleCheckBox(row.index)}\n                  checked={data[row.index][\"select\"]}\n                />\n              )}\n            </div>\n          </>\n        ),\n      },\n      {\n        Header: \"Action\",\n        Cell: ({ row }) => (\n          <div>\n            {row.original.action != null &&\n              row.original.action.includes(\"edit\") && (\n                <Link to={\"/stipends/\" + row.original.id}>\n                  <button className=\" w-16 m-0 p-0 \"> Edit </button>\n                </Link>\n              )}{\" \"}\n            {row.original.action != null &&\n              row.original.action.includes(\"edit\") && (\n                <Link to={\"/stipendsNew/\" + row.original.id}>\n                  <button className=\" w-16 m-0 p-0 \"> Edit N </button>\t\t\t{/* PCDAO 26-03-24*/}\n                </Link>\n              )}{\" \"}\n            {row.original.action != null &&\n              row.original.action.includes(\"edit\") &&\n              row.original.recordStatus != null &&\n              row.original.recordStatus === \"V\" && (\n                <button\n                  className=\"w-16 m-0 p-0 bg-red-500 hover:bg-red-700 \"\n                  onClick={() => submit(row.original.id)}\n                >\n                  {\" \"}\n                  Submit{\" \"}\n                </button>\n              )}{\" \"}\n            {row.original.action != null &&\n              row.original.action.includes(\"subm\") && (\n                <button\n                  className=\"w-16 m-0 p-0 bg-red-500 hover:bg-red-700 \"\n                  onClick={() => submit(row.original.id)}\n                >\n                  {\" \"}\n                  Submit{\" \"}\n                </button>\n              )}{\" \"}\n            {desgLevel > 30 && (\n              <button\n                className=\"w-16 m-0 p-0 bg-red-500 hover:bg-red-700 \"\n                onClick={() => rollBack(row.original.id)}\n              >\n                {\" \"}\n                Roll Back{\" \"}\n              </button>\n            )}\n          </div>\n        ),\n      },\n      {\n        Header: \"DakId No\",\n        accessor: \"dak.dakidNo\",\n        Cell: ({ row }) => (\n          <div>\n            <label>{row.original.dak.dakidNo}</label>\n          </div>\n        ),\n      },\n      {\n        Header: \"CDAONo\",\n        accessor: \"employee.cdaoNo\",\n      },\n      {\n        Header: \"IC No\",\n        accessor: \"employee.icNo\",\n      },\n      {\n        Header: \"Officer Name\",\n        accessor: \"employee.officerName\",\n      },\n\n      {\n        Header: \"Letter No\",\n        accessor: \"letterNo\", // Change this\n      },\n\n      {\n        Header: \"Letter Date\",\n        accessor: \"letterDate\",\n      },\n      {\n        Header: \"Mro No\",\n        accessor: \"mroNo\", // Change this\n      },\n\n      {\n        Header: \"Mro Date\",\n        accessor: \"mroDate\",\n      },\n      {\n        Header: \"Mro Type\",\n        accessor: \"mroNature\",\n      },\n      {\n        Header: \"Amount\",\n        accessor: \"amount\",\n      },\n\n      {\n        Header: \"From Date\",\n        accessor: \"fromDate\",\n      },\n      {\n        Header: \"To Date\",\n        accessor: \"toDate\",\n      },\n\n      {\n        Header: \"Record Status\",\n        accessor: \"recordStatus\",\n      },\n      {\n        Header: \"Section Remarks\",\n        accessor: \"sectionRemarks\",\n      },\n      {\n        Header: \"Reason\",\n        accessor: \"reason\",\n      },\n\n      /*\n\t\t{\n\t\t\tHeader: \"Login Name\",\n\t\t\taccessor: 'loginName',\n\t\t\tFilter: SelectColumnFilter,  // new\n\t\t\tfilter: 'includes',\n\t\t},\n\t\t*/\n    ],\n    [data]\n  );\n\n  const handleKeyPress = (event) => {\n    // look for the `Enter` keyCode\n    if (event.keyCode === 13 || event.which === 13) {\n      handleSubmit(event);\n    }\n  };\n\n  const handleSubmit = (event) => {\n    event.preventDefault();\n    console.log(inputText);\n    setSearch(inputText);\n  };\n  const handleBlur = (e) => setDakid(e.target.value);\n\n  return (\n    <div className=\"min-h-screen bg-gray-100 text-gray-900\">\n      <main className=\"max-w-8xl mx-auto px-4 sm:px-6 lg:px-8 pt-4\">\n        <div className=\"mt-2 ml-4\">\n          <h1 className=\"text-xl font-semibold\">Stipend</h1>\n          <div className=\"flexContainer\">\n            <div>\n              <input\n                type=\"text\"\n                name=\"search\"\n                placeholder=\"DakId No Starting with R\"\n                onChange={(e) => setInputText(e.target.value)}\n                onBlur={handleBlur}\n                onKeyPress={handleKeyPress}\n                className=\"pl-2 -ml-2 inputField flex-initial\"\n              />\n              <button\n                type=\"submit\"\n                onClick={handleSubmit}\n                className=\" w-32 ml-8 p-0 h-6 -mt-2\"\n              >\n                Search\n              </button>\n            </div>\n\n            <div>\n              <button\n                type=\"submit\"\n                onClick={reempReport}\n                className=\" w-46 ml-8 p-0 h-6 -mt-2\"\n              >\n                Stipend Report\n              </button>\n            </div>\n\n            <div>\n              <button\n                type=\"submit\"\n                onClick={pm}\n                className=\" w-46 ml-8 p-0 h-6 -mt-2\"\n              >\n                Generate PM\n              </button>\n            </div>\n\n            <div>\n              <Link to={\"/stipends/approvedList\"}>\n                <button className=\" w-42 ml-8 p-0 h-6 -mt-2\">\n                  Processed/Approved{\" \"}\n                </button>\n              </Link>\n            </div>\n          </div>\n        </div>\n        <div className=\"text-red-500\">{mesg}</div>\n\n        <div className=\"-mt-2 max-h-1 py-0\">\n          <Table columns={columns} data={data} className=\"table-auto\" />\n\n          <div>\n            {desgLevel > 30 && (\n              <button\n                type=\"button\"\n                onClick={approveBulk}\n                className=\"w-36 m-2 p-0\"\n              >\n                {\" \"}\n                Approve\n              </button>\n            )}\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\n\nexport default withRouter(StipendList);\n"]},"metadata":{},"sourceType":"module"}