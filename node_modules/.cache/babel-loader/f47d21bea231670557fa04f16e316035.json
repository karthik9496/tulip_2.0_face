{"ast":null,"code":"import _defineProperty from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/**\n * Code generated using Python\n * @author Raja Reddy\n * Date : 17 Oct 2021\n *\n * Modified By :\n */import{useState,useEffect}from\"react\";import{withRouter,useParams,useHistory}from\"react-router-dom\";import{useForm}from\"react-hook-form\";import axios from\"axios\";import*as yup from\"yup\";import{yupResolver}from\"@hookform/resolvers/yup\";import LiveSearch from\"../utils/LiveSearch\";//import DatePicker  from 'react-datepicker';\n//import \"react-datepicker/dist/react-datepicker.css\";\n//import addDays from 'date-fns/addDays'\nimport Tabs from\"react-bootstrap/Tabs\";import Tab from\"react-bootstrap/Tab\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var schema=yup.object({//dak: yup.object().required('Required'),\n//ifsc: yup.string().required('Required'),\n});var AdrReviewEdit=function AdrReviewEdit(){var _errors$employee,_errors$cdrNo,_errors$amount,_errors$penalAmt,_errors$totalAdr,_errors$demandDate,_errors$adrReviewDate,_errors$demandOrigin,_errors$settlementRem;var _useForm=useForm({resolver:yupResolver(schema)}),register=_useForm.register,handleSubmit=_useForm.handleSubmit,getValues=_useForm.getValues,setValue=_useForm.setValue,errors=_useForm.formState.errors,clearErrors=_useForm.clearErrors;var _useParams=useParams(),id=_useParams.id;var history=useHistory();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),serverErrors=_useState2[0],setServerErrors=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),entity=_useState4[0],setEntity=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),state=_useState6[0],setState=_useState6[1];var _useState7=useState(\"page1\"),_useState8=_slicedToArray(_useState7,2),key=_useState8[0],setKey=_useState8[1];useEffect(function(){var isCancelled=false;console.log(id);if(id!==\"new\"){function fetchData(){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var record;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:record=\"\";_context.next=3;return axios.get(\"/demandRegisters/\"+id).then(function(response){record=response.data;var fields=[\"id\",\"dak\",\"cdaoNo\",\"checkDigit\",\"cdrNo\",\"advanceType\",\"amount\",\"penalAmt\",\"employee\",\"demandDate\",\"penalDays\",\"demandOrigin\",\"recordStatus\",\"approved\",\"auditorSettlementDate\",\"aaoSettlementDate\",\"aoSettlementDate\",\"totalAdr\",\"adrReviewDate\",//rahul\n\"settlementRemarks\"];fields.forEach(function(field){return setValue(field,record[field]);});}).catch(function(error){//console.log(error);\n//console.log(error.response.status);\n//console.log(error.response.headers);\nif(error.response)setServerErrors(error.response.data.error);else setServerErrors(error.Error);});case 3:if(!isCancelled){setEntity(record);setState(function(prev){return _objectSpread(_objectSpread({},prev),{},{state:record});});}case 4:case\"end\":return _context.stop();}}},_callee);}));return _fetchData.apply(this,arguments);}fetchData();return function(){isCancelled=true;};}},[id,setValue]);//rahul: new function ---------------------------\nvar reCalcTotalAdrByReviewdate=function reCalcTotalAdrByReviewdate(e){var adrReviewDate=e.target.value;console.log(adrReviewDate);setServerErrors(\"\");if(adrReviewDate){var record=null;axios.get(\"/demandRegisters/adr/totalAdr/\"+id+\"/\"+adrReviewDate).then(function(response){record=response.data;var fields=[\"totalAdr\",\"penalAmt\",\"penalDays\"];fields.forEach(function(field){return setValue(field,record[field]);});}).catch(function(error){console.log(error.response);setServerErrors(error.response.data[\"reason\"]);});}};//rahul: new function ---------------------------\nvar onSubmit=function onSubmit(data,event){event.preventDefault();console.log(data);if(data.id){axios.put(\"/demandRegisters/audSubmit/\"+data.id,data).then(function(response){if(response.status==200)history.push(\"/adrReviews\");else setServerErrors(response.data);}).catch(function(error){//console.log(error.response.data);\n//console.log(error.response.status);\n//console.log(error.response.headers);\nsetServerErrors(error.response.data);});}};var onError=function onError(errors,e){return console.log(errors,e);};//All foreign keys.\n// XXXXXX Add search fields and adjust the values as necessary\nvar parentData={dak:{title:\"Dak\",url:\"daks\",searchList:[\"dakidNo\"],//XXXXXXXXX Add search fields here and also in the corresponding repository\nfkEntity:\"dak\"},employee:{title:\"Employee\",url:\"employees\",searchList:[\"cdaoNo\",\"officerName\"],//XXXXXXXXX Add search fields here and also in the corresponding repository\nfkEntity:\"employee\"}};//Callback for child components (Foreign Keys)\nvar callback=function callback(childData){//console.log(\"Parent Callback\");\nsetEntity(function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},childData.fk,childData.entity));});setValue(childData.fk,childData.entity);//console.log(errors);\nclearErrors(childData.fk);};var errorCallback=function errorCallback(err){//console.log(err);\nsetServerErrors(err);};var handleInputChange=function handleInputChange(e){//console.log(e.target.value);\n};var handleButtonClick=function handleButtonClick(e){history.push(\"/adrReviews\");};return/*#__PURE__*/_jsx(\"div\",{className:\"max-w-xl mx-auto \",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-full w-3/4  mx-auto \",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit,onError),children:[/*#__PURE__*/_jsxs(\"h1\",{children:[id===\"new\"?\"Add\":\"Edit\",\" Advance Review\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:serverErrors}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-0 \",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(LiveSearch,{name:\"employee\",onChange:handleInputChange,parentData:parentData.employee,parentCallback:callback,fkEntity:entity.employee,errCallback:errorCallback}),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500 \",children:(_errors$employee=errors.employee)===null||_errors$employee===void 0?void 0:_errors$employee.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Advance Type\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"text\",name:\"cdrNo\"},register(\"cdrNo\")),{},{readOnly:true})),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$cdrNo=errors.cdrNo)===null||_errors$cdrNo===void 0?void 0:_errors$cdrNo.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Advance Amount\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"text\",name:\"amount\"},register(\"amount\")),{},{readOnly:true})),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$amount=errors.amount)===null||_errors$amount===void 0?void 0:_errors$amount.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Penal Interest\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"text\",name:\"penalAmt\",readOnly:true},register(\"penalAmt\"))),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$penalAmt=errors.penalAmt)===null||_errors$penalAmt===void 0?void 0:_errors$penalAmt.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Total Adr\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"text\",name:\"totalAdr\"},register(\"totalAdr\"))),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$totalAdr=errors.totalAdr)===null||_errors$totalAdr===void 0?void 0:_errors$totalAdr.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Demand Date\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"date\",name:\"demandDate\"},register(\"demandDate\")),{},{readOnly:true})),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$demandDate=errors.demandDate)===null||_errors$demandDate===void 0?void 0:_errors$demandDate.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Adr Review Date\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"date\",name:\"adrReviewDate\"},register(\"adrReviewDate\",//Rahul\n{onChange:function onChange(e){return reCalcTotalAdrByReviewdate(e);}}))),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$adrReviewDate=errors.adrReviewDate)===null||_errors$adrReviewDate===void 0?void 0:_errors$adrReviewDate.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Demand Origin\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"text\",name:\"demandOrigin\"},register(\"demandOrigin\")),{},{readOnly:true})),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$demandOrigin=errors.demandOrigin)===null||_errors$demandOrigin===void 0?void 0:_errors$demandOrigin.message})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Settlement Remarks\"}),/*#__PURE__*/_jsx(\"textarea\",_objectSpread({className:\"w-full h-24 px-2 mt-1\",type:\"text\",name:\"settlementRemarks\"},register(\"settlementRemarks\"))),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$settlementRem=errors.settlementRemarks)===null||_errors$settlementRem===void 0?void 0:_errors$settlementRem.message})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-0 \",children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-2\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Save\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"px-2\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleButtonClick,children:\"Cancel\"})})]})]})})});};export default withRouter(AdrReviewEdit);","map":{"version":3,"sources":["/home/itsdcsec/falconws/falcon_face/src/components/AdrReviewEdit.js"],"names":["useState","useEffect","withRouter","useParams","useHistory","useForm","axios","yup","yupResolver","LiveSearch","Tabs","Tab","schema","object","AdrReviewEdit","resolver","register","handleSubmit","getValues","setValue","errors","formState","clearErrors","id","history","serverErrors","setServerErrors","entity","setEntity","state","setState","key","setKey","isCancelled","console","log","fetchData","record","get","then","response","data","fields","forEach","field","catch","error","Error","prev","reCalcTotalAdrByReviewdate","e","adrReviewDate","target","value","onSubmit","event","preventDefault","put","status","push","onError","parentData","dak","title","url","searchList","fkEntity","employee","callback","childData","fk","errorCallback","err","handleInputChange","handleButtonClick","message","cdrNo","amount","penalAmt","totalAdr","demandDate","onChange","demandOrigin","settlementRemarks"],"mappings":"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","sourcesContent":["/**\n * Code generated using Python\n * @author Raja Reddy\n * Date : 17 Oct 2021\n *\n * Modified By :\n */\n\n import { useState, useEffect } from \"react\";\n import { withRouter, useParams, useHistory } from \"react-router-dom\";\n import { useForm } from \"react-hook-form\";\n import axios from \"axios\";\n import * as yup from \"yup\";\n \n import { yupResolver } from \"@hookform/resolvers/yup\";\n import LiveSearch from \"../utils/LiveSearch\";\n \n //import DatePicker  from 'react-datepicker';\n //import \"react-datepicker/dist/react-datepicker.css\";\n //import addDays from 'date-fns/addDays'\n \n import Tabs from \"react-bootstrap/Tabs\";\n import Tab from \"react-bootstrap/Tab\";\n \n const schema = yup.object({\n   //dak: yup.object().required('Required'),\n   //ifsc: yup.string().required('Required'),\n });\n \n const AdrReviewEdit = () => {\n   const {\n\t register,\n\t handleSubmit,\n\t getValues, //rahul: new parameter ---------------------------\n\t setValue,\n\t formState: { errors },\n\t clearErrors,\n   } = useForm({\n\t resolver: yupResolver(schema),\n   });\n \n   let { id } = useParams();\n \n   let history = useHistory();\n   const [serverErrors, setServerErrors] = useState([]);\n   const [entity, setEntity] = useState({});\n   const [state, setState] = useState({});\n   const [key, setKey] = useState(\"page1\");\n \n   useEffect(() => {\n\t let isCancelled = false;\n\t console.log(id);\n\t if (id !== \"new\") {\n\t   async function fetchData() {\n\t\t let record = \"\";\n\t\t await axios\n\t\t   .get(\"/demandRegisters/\" + id)\n\t\t   .then((response) => {\n\t\t\t record = response.data;\n \n\t\t\t const fields = [\n\t\t\t   \"id\",\n\t\t\t   \"dak\",\n\t\t\t   \"cdaoNo\",\n\t\t\t   \"checkDigit\",\n\t\t\t   \"cdrNo\",\n\t\t\t   \"advanceType\",\n\t\t\t   \"amount\",\n\t\t\t   \"penalAmt\",\n\t\t\t   \"employee\",\n\t\t\t   \"demandDate\",\n\t\t\t   \"penalDays\",\n\t\t\t   \"demandOrigin\",\n\t\t\t   \"recordStatus\",\n\t\t\t   \"approved\",\n\t\t\t   \"auditorSettlementDate\",\n\t\t\t   \"aaoSettlementDate\",\n\t\t\t   \"aoSettlementDate\",\n\t\t\t   \"totalAdr\",\n\t\t\t   \"adrReviewDate\", //rahul\n\t\t\t   \"settlementRemarks\",\n\t\t\t ];\n \n\t\t\t fields.forEach((field) => setValue(field, record[field]));\n \n \n\t\t   })\n\t\t   .catch((error) => {\n\t\t\t //console.log(error);\n\t\t\t //console.log(error.response.status);\n\t\t\t //console.log(error.response.headers);\n\t\t\t if (error.response) setServerErrors(error.response.data.error);\n\t\t\t else setServerErrors(error.Error);\n\t\t   });\n \n\t\t if (!isCancelled) {\n\t\t   setEntity(record);\n\t\t   setState((prev) => ({ ...prev, state: record }));\n\t\t }\n\t   }\n \n\t   fetchData();\n\t   return () => {\n\t\t isCancelled = true;\n\t   };\n\t }\n   }, [id, setValue]);\n \n \n //rahul: new function ---------------------------\n   \n   const reCalcTotalAdrByReviewdate = (e) =>{\n\t var adrReviewDate = e.target.value; \n\t console.log(adrReviewDate);\n\t setServerErrors(\"\");\n\t if (adrReviewDate) {\n\t   var record =null;\n\t   axios\n\t\t .get(\"/demandRegisters/adr/totalAdr/\"+id+\"/\" + adrReviewDate)\n\t\t .then((response) => {\n\t\t   record = response.data;\n \n\t\t   const fields = [\n\t\t\t \"totalAdr\",\n\t\t\t \"penalAmt\",\n\t\t\t \"penalDays\"\n\t\t   ];\n\t\t   fields.forEach((field) => setValue(field, record[field]));\n\t\t })\n\t\t .catch((error) => {\n\t\t   console.log(error.response);\n\t\t   setServerErrors(error.response.data[\"reason\"]);\n \n\t\t });\n\t } \n   }\n  //rahul: new function ---------------------------\n \n \n \n   const onSubmit = (data, event) => {\n\t event.preventDefault();\n\t console.log(data);\n\t if (data.id) {\n\t   axios\n\t\t .put(\"/demandRegisters/audSubmit/\" + data.id, data)\n\t\t .then((response) => {\n\t\t   if (response.status == 200) history.push(\"/adrReviews\");\n\t\t   else setServerErrors(response.data);\n\t\t })\n\t\t .catch((error) => {\n\t\t   //console.log(error.response.data);\n\t\t   //console.log(error.response.status);\n\t\t   //console.log(error.response.headers);\n\t\t   setServerErrors(error.response.data);\n\t\t });\n\t }\n   };\n \n   const onError = (errors, e) => console.log(errors, e);\n \n   //All foreign keys.\n   // XXXXXX Add search fields and adjust the values as necessary\n   const parentData = {\n\t dak: {\n\t   title: \"Dak\",\n\t   url: \"daks\",\n\t   searchList: [\"dakidNo\"], //XXXXXXXXX Add search fields here and also in the corresponding repository\n\t   fkEntity: \"dak\",\n\t },\n \n\t employee: {\n\t   title: \"Employee\",\n\t   url: \"employees\",\n\t   searchList: [\"cdaoNo\", \"officerName\"], //XXXXXXXXX Add search fields here and also in the corresponding repository\n\t   fkEntity: \"employee\",\n\t },\n   };\n \n   //Callback for child components (Foreign Keys)\n   const callback = (childData) => {\n\t //console.log(\"Parent Callback\");\n\t setEntity((prev) => ({ ...prev, [childData.fk]: childData.entity }));\n\t setValue(childData.fk, childData.entity);\n\t //console.log(errors);\n\t clearErrors(childData.fk);\n   };\n \n   const errorCallback = (err) => {\n\t //console.log(err);\n\t setServerErrors(err);\n   };\n \n   const handleInputChange = (e) => {\n\t //console.log(e.target.value);\n   };\n   const handleButtonClick = (e) => {\n\t history.push(\"/adrReviews\");\n   };\n \n   return (\n\t <div className=\"max-w-xl mx-auto \">\n\t   <div className=\"w-full w-3/4  mx-auto \">\n\t\t <form onSubmit={handleSubmit(onSubmit, onError)}>\n\t\t   <h1>{id === \"new\" ? \"Add\" : \"Edit\"} Advance Review</h1>\n\t\t   <div className=\"text-red-500\">{serverErrors}</div>\n \n\t\t   <div className=\"grid grid-cols-2 gap-0 \">\n\t\t\t <div>\n\t\t\t   <LiveSearch\n\t\t\t\t name=\"employee\"\n\t\t\t\t onChange={handleInputChange}\n\t\t\t\t parentData={parentData.employee}\n\t\t\t\t parentCallback={callback}\n\t\t\t\t fkEntity={entity.employee}\n\t\t\t\t errCallback={errorCallback}\n\t\t\t   />\n\t\t\t   <div className=\"text-red-500 \">{errors.employee?.message}</div>\n\t\t\t </div>\n \n\t\t\t <div>\n\t\t\t   <label>Advance Type</label>\n\t\t\t   <input type=\"text\" name=\"cdrNo\" {...register(\"cdrNo\")} readOnly />\n\t\t\t   <div className=\"text-red-500\">{errors.cdrNo?.message}</div>\n\t\t\t </div>\n\t\t\t <div>\n\t\t\t   <label>Advance Amount</label>\n\t\t\t   <input\n\t\t\t\t type=\"text\"\n\t\t\t\t name=\"amount\"\n\t\t\t\t {...register(\"amount\")}\n\t\t\t\t readOnly\n\t\t\t   />\n\t\t\t   <div className=\"text-red-500\">{errors.amount?.message}</div>\n\t\t\t </div>\n\t\t\t <div>\n\t\t\t   <label>Penal Interest</label>\n\t\t\t   <input type=\"text\" name=\"penalAmt\" readOnly {...register(\"penalAmt\")} />\n\t\t\t   \n\t\t\t   <div className=\"text-red-500\">{errors.penalAmt?.message}</div>\n\t\t\t </div>\n\t\t\t <div>\n\t\t\t   <label>Total Adr</label>\n\t\t\t   <input type=\"text\" name=\"totalAdr\" {...register(\"totalAdr\")} />\n\t\t\t   <div className=\"text-red-500\">{errors.totalAdr?.message}</div>\n\t\t\t </div>\n\t\t\t <div>\n\t\t\t   <label>Demand Date</label>\n\t\t\t   <input\n\t\t\t\t type=\"date\"\n\t\t\t\t name=\"demandDate\"\n\t\t\t\t {...register(\"demandDate\")}\n\t\t\t\t readOnly\n\t\t\t   />\n\t\t\t   <div className=\"text-red-500\">{errors.demandDate?.message}</div>\n\t\t\t </div>\n\t\t\t <div>\n\t\t\t   <label>Adr Review Date</label>\n\t\t\t   <input\n\t\t\t\t type=\"date\"\n\t\t\t\t name=\"adrReviewDate\"\n\t\t\t\t {...register(\"adrReviewDate\",\n\t\t\t\t //Rahul\n\t\t\t\t {onChange: (e) =>reCalcTotalAdrByReviewdate(e)})}\n\t\t\t   />\n\t\t\t   <div className=\"text-red-500\">{errors.adrReviewDate?.message}</div>\n\t\t\t </div>\n\t\t\t \n\t\t\t <div>\n\t\t\t   <label>Demand Origin</label>\n\t\t\t   <input\n\t\t\t\t type=\"text\"\n\t\t\t\t name=\"demandOrigin\"\n\t\t\t\t {...register(\"demandOrigin\")}\n\t\t\t\t readOnly\n\t\t\t   />\n\t\t\t   <div className=\"text-red-500\">{errors.demandOrigin?.message}</div>\n\t\t\t </div>\t\t\t \n\t\t   </div>\n\t\t   <div >\n\t\t\t   <label>Settlement Remarks</label>\n\t\t\t   <textarea\n\t\t\t   className=\"w-full h-24 px-2 mt-1\"\n\t\t\t\t type=\"text\"\n\t\t\t\t name=\"settlementRemarks\"\n\t\t\t\t {...register(\"settlementRemarks\")}\n\t\t\t   />\n\t\t\t   <div className=\"text-red-500\">\n\t\t\t\t {errors.settlementRemarks?.message}\n\t\t\t   </div>\n\t\t\t </div>\n\t\t   <div className=\"grid grid-cols-2 gap-0 \">\n\t\t\t <div className=\"px-2\">\n\t\t\t   <button type=\"submit\">Save</button>\n\t\t\t </div>\n \n\t\t\t <div className=\"px-2\">\n\t\t\t   <button type=\"button\" onClick={handleButtonClick}>\n\t\t\t\t Cancel\n\t\t\t   </button>\n\t\t\t </div>\n\t\t   </div>\n\t\t </form>\n\t   </div>\n\t </div>\n   );\n };\n export default withRouter(AdrReviewEdit);"]},"metadata":{},"sourceType":"module"}