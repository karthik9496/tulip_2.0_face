{"ast":null,"code":"import _defineProperty from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/**\n * Code generated using Python\n * @author Raja Reddy\n * Date : 17 Oct 2021\n *\n * Modified By :\n */import{useState,useEffect}from\"react\";import{withRouter,useParams,useHistory}from\"react-router-dom\";import{useForm}from\"react-hook-form\";import axios from\"axios\";import*as yup from\"yup\";import{yupResolver}from\"@hookform/resolvers/yup\";import LiveSearch from\"../utils/LiveSearch\";//import DatePicker  from 'react-datepicker';\n//import \"react-datepicker/dist/react-datepicker.css\";\n//import addDays from 'date-fns/addDays'\nimport Tabs from\"react-bootstrap/Tabs\";import Tab from\"react-bootstrap/Tab\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var schema=yup.object({employee:yup.object().required(\"Required\"),basicPay:yup.number().integer().required(\"Required\")});var PayElementEdit=function PayElementEdit(){var _errors$employee,_errors$fromDate,_errors$basicPay;var _useForm=useForm({resolver:yupResolver(schema)}),register=_useForm.register,handleSubmit=_useForm.handleSubmit,setValue=_useForm.setValue,errors=_useForm.formState.errors,clearErrors=_useForm.clearErrors;var _useParams=useParams(),id=_useParams.id;var history=useHistory();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),serverErrors=_useState2[0],setServerErrors=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),entity=_useState4[0],setEntity=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),state=_useState6[0],setState=_useState6[1];var _useState7=useState(\"page1\"),_useState8=_slicedToArray(_useState7,2),key=_useState8[0],setKey=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),rankCode=_useState10[0],setRankCode=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),empId=_useState12[0],setEmpId=_useState12[1];var _useState13=useState(),_useState14=_slicedToArray(_useState13,2),basicPay=_useState14[0],setBasicPay=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),payElementData=_useState16[0],setPayElementData=_useState16[1];var _useState17=useState(\"\"),_useState18=_slicedToArray(_useState17,2),rank=_useState18[0],setRank=_useState18[1];var _useState19=useState(\"\"),_useState20=_slicedToArray(_useState19,2),rankName=_useState20[0],setRankName=_useState20[1];//pcdao -- for showing message if user not AO.\nvar _useState21=useState(\"\"),_useState22=_slicedToArray(_useState21,2),msg=_useState22[0],setMsg=_useState22[1];useEffect(function(){var isCancelled=false;console.log(id);if(id!==\"new\"){function fetchData(){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var record;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:record=\"\";_context.next=3;return axios.get(\"/payElements/\"+id).then(function(response){record=response.data;var fields=[\"id\",\"employee\",\"cancelDo2\",\"cancelled\",\"discharged\",\"effective\",\"oldRankPay\",\"do2\",\"fromDate\",\"toDate\",\"basicPay\",\"dp\",\"gradePay\",\"rankPay\",\"msPay\",\"npaPay\",\"specialistPay\",\"oldBasicPay\",\"absent\",\"deputation\",\"cdaoNo\",\"checkDigit\",\"payLevel\",\"monthEnding\",\"deputationStatus\",\"recordStatus\"];fields.forEach(function(field){return setValue(field,record[field]);});}).catch(function(error){//console.log(error);\n//console.log(error.response.status);\n//console.log(error.response.headers);\nif(error.response)setServerErrors(error.response.data.error);else setServerErrors(error.Error);});case 3:setRankCode(record.employee.rank.rankName+\":\"+record.employee.rank.rankCode.toString());console.log(record.employee.rank.rankName+\":\"+record.employee.rank.rankCode.toString());setEmpId(record.employee.id);if(!isCancelled){setEntity(record);setState(function(prev){return _objectSpread(_objectSpread({},prev),{},{state:record});});}case 7:case\"end\":return _context.stop();}}},_callee);}));return _fetchData.apply(this,arguments);}fetchData();return function(){isCancelled=true;};}},[id,setValue]);var onSubmit=function onSubmit(data,event){event.preventDefault();console.log(data);if(data.id){axios.put(\"/payElements/\"+data.id,data).then(function(response){history.push(\"/payElements\");}).catch(function(error){//console.log(error.response.data);\n//console.log(error.response.status);\n//console.log(error.response.headers);\nsetServerErrors(error.response.data);});}else{//pcdao -- added condition to show message if user not AO.\naxios.post(\"/payElements\",data).then(function(response){if(response.data){history.push(\"/payElements\");}else{setMsg(\"Facility Available only for AO.\");}}).catch(function(error){//console.log(error.response.data);\n//console.log(error.response.status);\n//console.log(error.response.headers);\nsetServerErrors(error.response.data);});}};var onError=function onError(errors,e){return console.log(errors,e);};//All foreign keys.\n// XXXXXX Add search fields and adjust the values as necessary\nvar parentData={employee:{title:\"Employee\",url:\"employees\",searchList:[\"cdaoNo\",\"checkDigit\",\"officerName\"],//XXXXXXXXX Add search fields here and also in the corresponding repository\nfkEntity:\"employee\"},cancelDo2:{title:\"Cancel Do2\",url:\"cancelDo2s\",searchList:[\"id\"],//XXXXXXXXX Add search fields here and also in the corresponding repository\nfkEntity:\"cancelDo2\"},do2:{title:\"Do2\",url:\"do2s\",searchList:[\"id\"],//XXXXXXXXX Add search fields here and also in the corresponding repository\nfkEntity:\"do2\"}};//Callback for child components (Foreign Keys)\nvar callback=function callback(childData){//console.log(\"Parent Callback\");\nsetEntity(function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},childData.fk,childData.entity));});setValue(childData.fk,childData.entity);if(childData.fk===\"employee\"){setRankCode(childData.entity.rank.rankName+\":\"+childData.entity.rank.rankCode.toString());}//console.log(errors);\nclearErrors(childData.fk);};var errorCallback=function errorCallback(err){//console.log(err);\nsetServerErrors(err);};var handleInputChange=function handleInputChange(e){//console.log(e.target.value);\n};return/*#__PURE__*/_jsx(\"div\",{className:\"max-w-xl mx-auto \",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-full w-3/4  mx-auto \",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit,onError),children:[/*#__PURE__*/_jsxs(\"h1\",{children:[id===\"new\"?\"Add\":\"Edit\",\" Pay Element \"]}),/*#__PURE__*/_jsx(\"h6\",{className:\"text-red-500\",children:msg}),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:serverErrors}),/*#__PURE__*/_jsxs(Tabs,{id:\"PayElementEdit\",activeKey:key,onSelect:function onSelect(k){return setKey(k);},className:\"mb-3\",children:[/*#__PURE__*/_jsx(Tab,{eventKey:\"page1\",title:\"Page 1\",className:\"h-120\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-0\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(LiveSearch,{name:\"employee\",onChange:handleInputChange,parentData:parentData.employee,parentCallback:callback,fkEntity:entity.employee,errCallback:errorCallback}),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500 \",children:(_errors$employee=errors.employee)===null||_errors$employee===void 0?void 0:_errors$employee.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Rank\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"rank\",value:rankCode,readOnly:true,className:\"form-control py-0\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"From Date\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"date\",name:\"fromDate\"},register(\"fromDate\")),{},{className:\"form-control py-0\"})),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$fromDate=errors.fromDate)===null||_errors$fromDate===void 0?void 0:_errors$fromDate.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Basic Pay\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"text\",name:\"basicPay\"},register(\"basicPay\")),{},{className:\"form-control py-0\"})),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$basicPay=errors.basicPay)===null||_errors$basicPay===void 0?void 0:_errors$basicPay.message})]})]})}),/*#__PURE__*/_jsxs(Tab,{eventKey:\"help\",title:\"Help\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Help\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"list-disc\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"Point 1\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Point 2\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"px-4\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Save\"})})]})})});};export default withRouter(PayElementEdit);","map":{"version":3,"sources":["/home/itsdcsec/falconws/falcon_face/src/components/PayElementEdit.js"],"names":["useState","useEffect","withRouter","useParams","useHistory","useForm","axios","yup","yupResolver","LiveSearch","Tabs","Tab","schema","object","employee","required","basicPay","number","integer","PayElementEdit","resolver","register","handleSubmit","setValue","errors","formState","clearErrors","id","history","serverErrors","setServerErrors","entity","setEntity","state","setState","key","setKey","rankCode","setRankCode","empId","setEmpId","setBasicPay","payElementData","setPayElementData","rank","setRank","rankName","setRankName","msg","setMsg","isCancelled","console","log","fetchData","record","get","then","response","data","fields","forEach","field","catch","error","Error","toString","prev","onSubmit","event","preventDefault","put","push","post","onError","e","parentData","title","url","searchList","fkEntity","cancelDo2","do2","callback","childData","fk","errorCallback","err","handleInputChange","k","message","fromDate"],"mappings":"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","sourcesContent":["/**\n * Code generated using Python\n * @author Raja Reddy\n * Date : 17 Oct 2021\n *\n * Modified By :\n */\n\nimport { useState, useEffect } from \"react\";\nimport { withRouter, useParams, useHistory } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport axios from \"axios\";\nimport * as yup from \"yup\";\n\nimport { yupResolver } from \"@hookform/resolvers/yup\";\nimport LiveSearch from \"../utils/LiveSearch\";\n\n//import DatePicker  from 'react-datepicker';\n//import \"react-datepicker/dist/react-datepicker.css\";\n//import addDays from 'date-fns/addDays'\n\nimport Tabs from \"react-bootstrap/Tabs\";\nimport Tab from \"react-bootstrap/Tab\";\n\nconst schema = yup.object({\n  employee: yup.object().required(\"Required\"),\n  basicPay: yup.number().integer().required(\"Required\"),\n});\n\nconst PayElementEdit = () => {\n  const {\n    register,\n    handleSubmit,\n    setValue,\n    formState: { errors },\n    clearErrors,\n  } = useForm({\n    resolver: yupResolver(schema),\n  });\n\n  let { id } = useParams();\n\n  let history = useHistory();\n  const [serverErrors, setServerErrors] = useState([]);\n  const [entity, setEntity] = useState({});\n  const [state, setState] = useState({});\n  const [key, setKey] = useState(\"page1\");\n\n  const [rankCode, setRankCode] = useState(\"\");\n  const [empId, setEmpId] = useState();\n  const [basicPay, setBasicPay] = useState();\n  const [payElementData, setPayElementData] = useState([]);\n  const [rank, setRank] = useState(\"\");\n  const [rankName, setRankName] = useState(\"\");\n\n  //pcdao -- for showing message if user not AO.\n  const [msg, setMsg] = useState(\"\");\n\n  useEffect(() => {\n    let isCancelled = false;\n    console.log(id);\n    if (id !== \"new\") {\n      async function fetchData() {\n        let record = \"\";\n        await axios\n          .get(\"/payElements/\" + id)\n          .then((response) => {\n            record = response.data;\n            const fields = [\n              \"id\",\n              \"employee\",\n              \"cancelDo2\",\n              \"cancelled\",\n              \"discharged\",\n              \"effective\",\n              \"oldRankPay\",\n              \"do2\",\n              \"fromDate\",\n              \"toDate\",\n              \"basicPay\",\n              \"dp\",\n              \"gradePay\",\n              \"rankPay\",\n              \"msPay\",\n              \"npaPay\",\n              \"specialistPay\",\n              \"oldBasicPay\",\n              \"absent\",\n              \"deputation\",\n              \"cdaoNo\",\n              \"checkDigit\",\n              \"payLevel\",\n              \"monthEnding\",\n              \"deputationStatus\",\n              \"recordStatus\",\n            ];\n            fields.forEach((field) => setValue(field, record[field]));\n          })\n          .catch((error) => {\n            //console.log(error);\n            //console.log(error.response.status);\n            //console.log(error.response.headers);\n            if (error.response) setServerErrors(error.response.data.error);\n            else setServerErrors(error.Error);\n          });\n        setRankCode(\n          record.employee.rank.rankName +\n            \":\" +\n            record.employee.rank.rankCode.toString()\n        );\n        console.log(\n          record.employee.rank.rankName +\n            \":\" +\n            record.employee.rank.rankCode.toString()\n        );\n        setEmpId(record.employee.id);\n\n        if (!isCancelled) {\n          setEntity(record);\n          setState((prev) => ({ ...prev, state: record }));\n        }\n      }\n\n      fetchData();\n      return () => {\n        isCancelled = true;\n      };\n    }\n  }, [id, setValue]);\n\n  const onSubmit = (data, event) => {\n    event.preventDefault();\n    console.log(data);\n    if (data.id) {\n      axios\n        .put(\"/payElements/\" + data.id, data)\n        .then((response) => {\n          history.push(\"/payElements\");\n        })\n        .catch((error) => {\n          //console.log(error.response.data);\n          //console.log(error.response.status);\n          //console.log(error.response.headers);\n          setServerErrors(error.response.data);\n        });\n    } else {\n\t  //pcdao -- added condition to show message if user not AO.\n      axios\n        .post(\"/payElements\", data)\n        .then((response) => {\n          if (response.data) {\n            history.push(\"/payElements\");\n          } else {\n            setMsg(\"Facility Available only for AO.\");\n          }\n        })\n        .catch((error) => {\n          //console.log(error.response.data);\n          //console.log(error.response.status);\n          //console.log(error.response.headers);\n          setServerErrors(error.response.data);\n        });\n    }\n  };\n\n  const onError = (errors, e) => console.log(errors, e);\n\n  //All foreign keys.\n  // XXXXXX Add search fields and adjust the values as necessary\n  const parentData = {\n    employee: {\n      title: \"Employee\",\n      url: \"employees\",\n      searchList: [\"cdaoNo\", \"checkDigit\", \"officerName\"], //XXXXXXXXX Add search fields here and also in the corresponding repository\n      fkEntity: \"employee\",\n    },\n    cancelDo2: {\n      title: \"Cancel Do2\",\n      url: \"cancelDo2s\",\n      searchList: [\"id\"], //XXXXXXXXX Add search fields here and also in the corresponding repository\n      fkEntity: \"cancelDo2\",\n    },\n    do2: {\n      title: \"Do2\",\n      url: \"do2s\",\n      searchList: [\"id\"], //XXXXXXXXX Add search fields here and also in the corresponding repository\n      fkEntity: \"do2\",\n    },\n  };\n\n  //Callback for child components (Foreign Keys)\n  const callback = (childData) => {\n    //console.log(\"Parent Callback\");\n    setEntity((prev) => ({ ...prev, [childData.fk]: childData.entity }));\n    setValue(childData.fk, childData.entity);\n    if (childData.fk === \"employee\") {\n      setRankCode(\n        childData.entity.rank.rankName +\n          \":\" +\n          childData.entity.rank.rankCode.toString()\n      );\n    }\n    //console.log(errors);\n    clearErrors(childData.fk);\n  };\n\n  const errorCallback = (err) => {\n    //console.log(err);\n    setServerErrors(err);\n  };\n\n  const handleInputChange = (e) => {\n    //console.log(e.target.value);\n  };\n\n  return (\n    <div className=\"max-w-xl mx-auto \">\n      <div className=\"w-full w-3/4  mx-auto \">\n        <form onSubmit={handleSubmit(onSubmit, onError)}>\n          <h1>{id === \"new\" ? \"Add\" : \"Edit\"} Pay Element </h1>\n\n\t\t  {/* pcdao -- added message if user not AO */}\n          <h6 className=\"text-red-500\">{msg}</h6>\n          <div className=\"text-red-500\">{serverErrors}</div>\n          <Tabs\n            id=\"PayElementEdit\"\n            activeKey={key}\n            onSelect={(k) => setKey(k)}\n            className=\"mb-3\"\n          >\n            <Tab eventKey=\"page1\" title=\"Page 1\" className=\"h-120\">\n              <div className=\"grid grid-cols-2 gap-0\">\n                <div>\n                  <LiveSearch\n                    name=\"employee\"\n                    onChange={handleInputChange}\n                    parentData={parentData.employee}\n                    parentCallback={callback}\n                    fkEntity={entity.employee}\n                    errCallback={errorCallback}\n                  />\n                  <div className=\"text-red-500 \">\n                    {errors.employee?.message}\n                  </div>\n                </div>\n\n                <div>\n                  <label>Rank</label>\n                  <input\n                    type=\"text\"\n                    name=\"rank\"\n                    value={rankCode}\n                    readOnly\n                    className=\"form-control py-0\"\n                  />\n                </div>\n\n                <div>\n                  <label>From Date</label>\n                  <input\n                    type=\"date\"\n                    name=\"fromDate\"\n                    {...register(\"fromDate\")}\n                    className=\"form-control py-0\"\n                  />\n                  <div className=\"text-red-500\">{errors.fromDate?.message}</div>\n                </div>\n\n                <div>\n                  <label>Basic Pay</label>\n                  <input\n                    type=\"text\"\n                    name=\"basicPay\"\n                    {...register(\"basicPay\")}\n                    className=\"form-control py-0\"\n                  />\n                  <div className=\"text-red-500\">{errors.basicPay?.message}</div>\n                </div>\n              </div>\n            </Tab>\n\n            <Tab eventKey=\"help\" title=\"Help\">\n              <h1>Help</h1>\n              <ul className=\"list-disc\">\n                <li>Point 1</li>\n                <li>Point 2</li>\n              </ul>\n            </Tab>\n          </Tabs>\n\n          <div className=\"px-4\">\n            <button type=\"submit\">Save</button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default withRouter(PayElementEdit);\n"]},"metadata":{},"sourceType":"module"}