{"ast":null,"code":"import _defineProperty from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/**\n Code generated using Python\n @author Raja Reddy\n Date : 13 Oct 2021\n\n */import{useState,useEffect}from\"react\";import{withRouter,useParams,useHistory}from\"react-router-dom\";import{useForm}from\"react-hook-form\";import axios from'axios';import*as yup from\"yup\";import{yupResolver}from'@hookform/resolvers/yup';import LiveSearch from'../utils/LiveSearch';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var schema=yup.object({usrName:yup.string().required('User Name is required.'),accountNo:yup.string().required('Account no. is required'),loginName:yup.string().required('Login Name is required'),designation:yup.object().required('Designation is required')//password: yup.string(),\n//password2: yup.mixed().oneOf([yup.ref('password'), null], 'Passwords must match')\n//age: yup.number().positive().integer().required(),\n}).required();var UsrEdit=function UsrEdit(){var _errors$usrName,_errors$accountNo,_errors$loginName,_errors$designation,_errors$section,_errors$phone,_errors$phone2,_errors$email;//const { register, handleSubmit, reset, setValue, getValues, formState: { errors }, clearErrors } = useForm({\nvar _useForm=useForm({resolver:yupResolver(schema)}),register=_useForm.register,handleSubmit=_useForm.handleSubmit,setValue=_useForm.setValue,errors=_useForm.formState.errors,clearErrors=_useForm.clearErrors;var _useParams=useParams(),id=_useParams.id;//console.log(id);\nvar history=useHistory();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),serverErrors=_useState2[0],setServerErrors=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),entity=_useState4[0],setEntity=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),state=_useState6[0],setState=_useState6[1];useEffect(function(){var isCancelled=false;console.log(id);if(id!=='new'){function fetchData(){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var record,fields;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:record='';_context.next=3;return axios.get('/usrs/'+id).then(function(response){record=response.data;}).catch(function(error){//console.log(error);\n//console.log(error.response.status);\n//console.log(error.response.headers);\nif(error.response)setServerErrors(error.response.data.error);else setServerErrors(error.Error);});case 3:fields=['id','usrName','accountNo','loginName','designation','gender','section','phone1','phone2','phone3','email','enabled'];fields.forEach(function(field){return setValue(field,record[field]);});if(!isCancelled){setEntity(record);setState(function(prev){return _objectSpread(_objectSpread({},prev),{},{state:record});});}case 6:case\"end\":return _context.stop();}}},_callee);}));return _fetchData.apply(this,arguments);}fetchData();return function(){isCancelled=true;};}},[id]);var onSubmit=function onSubmit(data,event){event.preventDefault();console.log(data);if(data.id){axios.put(\"/usrs/\"+data.id,data).then(function(response){}).catch(function(error){//console.log(error.response.data);\n//console.log(error.response.status);\n//console.log(error.response.headers);\nsetServerErrors(error.response.data);});}else{axios.post(\"/usrs\",data).then(function(response){}).catch(function(error){//console.log(error.response.data);\n//console.log(error.response.status);\n//console.log(error.response.headers);\nsetServerErrors(error.response.data);});}history.push(\"/usrs\");};var onError=function onError(errors,e){return console.log(errors,e);};//All foreign keys\nvar parentData={designation:{title:\"Designation\",url:\"designations\",searchList:[\"abbr\"],fkEntity:\"designation\",preload:false},section:{title:\"Section\",url:\"sections\",searchList:[\"sectionName\"],fkEntity:\"section\",preload:false}};//Callback for child components (Foreign Keys)\nvar callback=function callback(childData){//console.log(\"Parent Callback\");\nsetEntity(function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},childData.fk,childData.entity));});setValue(childData.fk,childData.entity);console.log(errors);clearErrors(childData.fk);};var errorCallback=function errorCallback(err){//console.log(err);\nsetServerErrors(err);};//console.log(entity);\nvar handleInputChange=function handleInputChange(e){console.log(e.target.value);console.log(entity.gender);//console.log(gender);\nsetValue('entity.gender',e.target.value);};return/*#__PURE__*/_jsx(\"div\",{className:\"max-w-xl mx-auto \",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-full w-3/4  mx-auto \",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit,onError),children:[/*#__PURE__*/_jsxs(\"h1\",{children:[id==='new'?'Add':'Edit',\" User \"]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:serverErrors}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-0\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"User Name\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"text\",name:\"usrName\"},register(\"usrName\")),{},{className:\"form-control py-0\"})),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$usrName=errors.usrName)===null||_errors$usrName===void 0?void 0:_errors$usrName.message})]}),/*#__PURE__*/_jsxs(\"div\",{className:\" \",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Account No.\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"text\",name:\"accountNo\"},register(\"accountNo\")),{},{className:\"form-control py-0 \"})),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$accountNo=errors.accountNo)===null||_errors$accountNo===void 0?void 0:_errors$accountNo.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Login Name\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"text\",name:\"loginName\"},register(\"loginName\")),{},{className:\"form-control py-0 \"})),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$loginName=errors.loginName)===null||_errors$loginName===void 0?void 0:_errors$loginName.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(LiveSearch,{name:\"designation\",onChange:handleInputChange,parentData:parentData.designation,parentCallback:callback,fkEntity:entity.designation,errCallback:errorCallback}),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500 \",children:(_errors$designation=errors.designation)===null||_errors$designation===void 0?void 0:_errors$designation.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(LiveSearch,{name:\"section\",onChange:handleInputChange,parentData:parentData.section,parentCallback:callback,fkEntity:entity.section,errCallback:errorCallback}),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$section=errors.section)===null||_errors$section===void 0?void 0:_errors$section.message})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Gender\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"radio\",value:\"F\",name:\"gender\"},register(\"gender\")),{},{onChange:handleInputChange})),\" Female \",/*#__PURE__*/_jsx(\"span\",{children:\"\\xA0 \\xA0\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"radio\",value:\"M\",name:\"gender\"},register(\"gender\")),{},{onChange:handleInputChange})),\" Male \",/*#__PURE__*/_jsx(\"span\",{children:\"\\xA0 \\xA0\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Phone 1\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"text\",name:\"phone1\"},register(\"phone1\")),{},{className:\"form-control py-0 \"})),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$phone=errors.phone1)===null||_errors$phone===void 0?void 0:_errors$phone.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Phone 2\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"text\",name:\"phone2\"},register(\"phone2\")),{},{className:\"form-control py-0 \"})),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$phone2=errors.phone2)===null||_errors$phone2===void 0?void 0:_errors$phone2.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"text\",name:\"email\"},register(\"email\")),{},{className:\"form-control py-0 \"})),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$email=errors.email)===null||_errors$email===void 0?void 0:_errors$email.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"checkbox\",value:\"true\",name:\"enabled\"},register(\"enabled\"))),/*#__PURE__*/_jsx(\"span\",{className:\" text-sm font-bold\",children:\" Enabled \"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"px-4\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Save\"})})]})})});};export default withRouter(UsrEdit);","map":{"version":3,"sources":["/home/itsdcsec/falconws/falcon_face/src/components/UsrEdit.js"],"names":["useState","useEffect","withRouter","useParams","useHistory","useForm","axios","yup","yupResolver","LiveSearch","schema","object","usrName","string","required","accountNo","loginName","designation","UsrEdit","resolver","register","handleSubmit","setValue","errors","formState","clearErrors","id","history","serverErrors","setServerErrors","entity","setEntity","state","setState","isCancelled","console","log","fetchData","record","get","then","response","data","catch","error","Error","fields","forEach","field","prev","onSubmit","event","preventDefault","put","post","push","onError","e","parentData","title","url","searchList","fkEntity","preload","section","callback","childData","fk","errorCallback","err","handleInputChange","target","value","gender","message","phone1","phone2","email"],"mappings":"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","sourcesContent":["/**\n Code generated using Python\n @author Raja Reddy\n Date : 13 Oct 2021\n\n */\n\n\nimport { useState, useEffect } from \"react\";\nimport { withRouter, useParams, useHistory } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport axios from 'axios';\nimport * as yup from \"yup\";\n\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport LiveSearch from '../utils/LiveSearch';\n\n\nconst schema = yup.object({\n\tusrName: yup.string().required('User Name is required.'),\n\taccountNo: yup.string().required('Account no. is required'),\n\tloginName: yup.string().required('Login Name is required'),\n\tdesignation: yup.object().required('Designation is required'),\n\t//password: yup.string(),\n\t//password2: yup.mixed().oneOf([yup.ref('password'), null], 'Passwords must match')\n\t//age: yup.number().positive().integer().required(),\n}).required();\n\n\nconst UsrEdit = () => {\n\t//const { register, handleSubmit, reset, setValue, getValues, formState: { errors }, clearErrors } = useForm({\n\tconst { register, handleSubmit, setValue, formState: { errors }, clearErrors } = useForm({\n\t\tresolver: yupResolver(schema)\n\t});\n\n\tlet { id } = useParams();\n\t//console.log(id);\n\n\tlet history = useHistory();\n\tconst [serverErrors, setServerErrors] = useState([]);\n\tconst [entity, setEntity] = useState({});\n\tconst [state, setState] = useState({});\n\n\n\tuseEffect(() => {\n\t\tlet isCancelled = false;\n\t\tconsole.log(id);\n\t\tif (id !== 'new') {\n\t\t\tasync function fetchData() {\n\t\t\t\tlet record = '';\n\t\t\t\tawait axios.get('/usrs/' + id)\n\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\trecord = response.data;\n\t\t\t\t\t})\n\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t//console.log(error);\n\t\t\t\t\t\t//console.log(error.response.status);\n\t\t\t\t\t\t//console.log(error.response.headers);\n\t\t\t\t\t\tif(error.response)\n\t\t\t\t\t\t\tsetServerErrors(error.response.data.error);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tsetServerErrors(error.Error);\n\t\t\t\t\t});\n\n\t\t\t\tconst fields = ['id', 'usrName', 'accountNo', 'loginName', 'designation', 'gender', 'section',\n\t\t\t\t\t'phone1', 'phone2', 'phone3', 'email', 'enabled'];\n\t\t\t\tfields.forEach(field => setValue(field, record[field]));\n\t\t\t\tif (!isCancelled) {\n\t\t\t\t\tsetEntity(record);\n\t\t\t\t\tsetState(prev => ({ ...prev, state: record }));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfetchData();\n\t\t\treturn () => {\n\t\t\t\tisCancelled = true;\n\t\t\t};\n\t\t}\n\n\t}, [id, ]);\n\n\n\n\tconst onSubmit = (data, event) => {\n\t\tevent.preventDefault();\n\t\tconsole.log(data);\n\t\tif (data.id) {\n\t\t\taxios\n\t\t\t\t.put(\"/usrs/\" + data.id, data)\n\t\t\t\t.then((response) => { })\n\t\t\t\t.catch((error) => {\n\t\t\t\t\t//console.log(error.response.data);\n\t\t\t\t\t//console.log(error.response.status);\n\t\t\t\t\t//console.log(error.response.headers);\n\t\t\t\t\tsetServerErrors(error.response.data)\n\t\t\t\t});\n\t\t} else {\n\t\t\taxios.post(\"/usrs\", data)\n\t\t\t\t.then((response) => { })\n\t\t\t\t.catch((error) => {\n\t\t\t\t\t//console.log(error.response.data);\n\t\t\t\t\t//console.log(error.response.status);\n\t\t\t\t\t//console.log(error.response.headers);\n\t\t\t\t\tsetServerErrors(error.response.data)\n\t\t\t\t});\n\t\t}\n\n\t\thistory.push(\"/usrs\");\n\t}\n\n\tconst onError = (errors, e) => console.log(errors, e);\n\n\t//All foreign keys\n\tconst parentData = {\n\t\tdesignation: {\n\t\t\ttitle: \"Designation\",\n\t\t\turl: \"designations\",\n\t\t\tsearchList: [\"abbr\"],\n\t\t\tfkEntity: \"designation\",\n\t\t\tpreload: false,\n\t\t},\n\n\t\tsection: {\n\t\t\ttitle: \"Section\",\n\t\t\turl: \"sections\",\n\t\t\tsearchList: [\"sectionName\"],\n\t\t\tfkEntity: \"section\",\n\t\t\tpreload: false,\n\t\t}\n\t}\n\n\n\t//Callback for child components (Foreign Keys)\n\tconst callback = (childData) => {\n\t\t//console.log(\"Parent Callback\");\n\t\tsetEntity(prev => ({ ...prev, [childData.fk]: childData.entity }));\n\t\tsetValue(childData.fk, childData.entity);\n\t\tconsole.log(errors);\n\t\tclearErrors(childData.fk);\n\t};\n\n\tconst errorCallback = (err) => {\n\t\t//console.log(err);\n\t\tsetServerErrors(err);\n\t}\n\n\t//console.log(entity);\n\n\tconst handleInputChange = (e) => {\n\t\tconsole.log(e.target.value);\n\t\tconsole.log(entity.gender);\n\t\t//console.log(gender);\n\t\tsetValue('entity.gender', e.target.value);\n\t};\n\n\treturn (\n\t\t<div className=\"max-w-xl mx-auto \">\n\t\t\t<div className=\"w-full w-3/4  mx-auto \" >\n\n\t\t\t\t<form onSubmit={handleSubmit(onSubmit, onError)}>\n\t\t\t\t\t<h1 >{id === 'new' ? 'Add' : 'Edit'} User </h1>\n\t\t\t\t\t<div className=\"text-red-500\">{serverErrors}</div>\n\n\n\t\t\t\t\t<div className=\"grid grid-cols-2 gap-0\">\n\n\t\t\t\t\t\t<div >\n\t\t\t\t\t\t\t<label >User Name</label>\n\t\t\t\t\t\t\t<input type=\"text\" name=\"usrName\" {...register(\"usrName\")}\n\t\t\t\t\t\t\t\tclassName=\"form-control py-0\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div className=\"text-red-500\">{errors.usrName?.message}</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div className=\" \">\n\t\t\t\t\t\t\t<label >Account No.</label>\n\t\t\t\t\t\t\t<input type=\"text\" name=\"accountNo\" {...register(\"accountNo\")}\n\t\t\t\t\t\t\t\tclassName=\"form-control py-0 \"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div className=\"text-red-500\">{errors.accountNo?.message}</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div >\n\t\t\t\t\t\t\t<label >Login Name</label>\n\t\t\t\t\t\t\t<input type=\"text\" name=\"loginName\" {...register(\"loginName\")}\n\t\t\t\t\t\t\t\tclassName=\"form-control py-0 \"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div className=\"text-red-500\">{errors.loginName?.message}</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div >\n\t\t\t\t\t\t\t<LiveSearch name=\"designation\" onChange={handleInputChange}\n\t\t\t\t\t\t\t\tparentData={parentData.designation} parentCallback={callback} \n\t\t\t\t\t\t\t\tfkEntity={entity.designation} errCallback={errorCallback} />\n\t\t\t\t\t\t\t<div className=\"text-red-500 \">{errors.designation?.message}</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t \n\n\t\t\t\t\t\t \n\t\t\t\t\t\t<div >\n\t\t\t\t\t\t\t<LiveSearch name=\"section\" onChange={handleInputChange}\n\t\t\t\t\t\t\t\tparentData={parentData.section} parentCallback={callback} \n\t\t\t\t\t\t\t\tfkEntity={entity.section} errCallback = {errorCallback}/>\n\t\t\t\t\t\t\t<div className=\"text-red-500\">{errors.section?.message}</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div className=\"\">\n\t\t\t\t\t\t\t<label >Gender</label>\n\t\t\t\t\t\t\t<input type=\"radio\" value=\"F\" name=\"gender\" {...register(\"gender\")} \n\t\t\t\t\t\t\t\tonChange={handleInputChange}\n\t\t\t\t\t\t\t/> Female <span>&nbsp; &nbsp;</span>\n\n\t\t\t\t\t\t\t<input type=\"radio\" value=\"M\" name=\"gender\" {...register(\"gender\")} \n\t\t\t\t\t\t\t\tonChange={handleInputChange}\n\t\t\t\t\t\t\t/> Male <span>&nbsp; &nbsp;</span>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<label >Phone 1</label>\n\t\t\t\t\t\t\t<input type=\"text\" name=\"phone1\" {...register(\"phone1\")}\n\t\t\t\t\t\t\t\tclassName=\"form-control py-0 \"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div className=\"text-red-500\">{errors.phone1?.message}</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<label >Phone 2</label>\n\t\t\t\t\t\t\t<input type=\"text\" name=\"phone2\" {...register(\"phone2\")}\n\t\t\t\t\t\t\t\tclassName=\"form-control py-0 \"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div className=\"text-red-500\">{errors.phone2?.message}</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t \n\t\t\t\t\t\t<div >\n\t\t\t\t\t\t\t<label >Email</label>\n\t\t\t\t\t\t\t<input type=\"text\" name=\"email\" {...register(\"email\")}\n\t\t\t\t\t\t\t\tclassName=\"form-control py-0 \"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div className=\"text-red-500\">{errors.email?.message}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div >\n\t\t\t\t\t\t\t<input type=\"checkbox\" value=\"true\" name=\"enabled\" {...register(\"enabled\")} /><span className=\" text-sm font-bold\"> Enabled </span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"px-4\">\n\t\t\t\t\t\t<button type=\"submit\" >Save</button>\n\t\t\t\t\t</div>\n\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport default withRouter(UsrEdit);\n"]},"metadata":{},"sourceType":"module"}