{"ast":null,"code":"var _jsxFileName = \"/home/rr/Workspace/Js/falcon_face/src/components/UsrRolList.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect, useMemo } from 'react';\nimport Table, { SelectColumnFilter } from '../utils/Table'; // \n\nimport axios from \"axios\";\nimport { withRouter, Link, useParams, useHistory } from \"react-router-dom\";\nimport LiveSearch from '../utils/LiveSearch';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction UsrRolList() {\n  _s();\n\n  const [data, setData] = useState([]); //const [update, setUpdate] = useState(false);\n\n  const [serverErrors, setServerErrors] = useState([]);\n  const [usrId, setUsrId] = useState(\"\");\n  const [inputText, setInputText] = useState('');\n  const [entity, setEntity] = useState({}); //const [state, setState] = useState({});\t\n\n  let {\n    id\n  } = useParams();\n  let history = useHistory();\n  useEffect(() => {\n    let fetching = false;\n    console.log(id);\n\n    async function fetchData() {\n      if (!fetching) await axios.get(`/usrs/${id}/rols`).then(response => {\n        setData(response.data);\n      }).catch(error => {\n        //console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n      });\n    }\n\n    fetchData();\n    return () => {\n      fetching = true;\n    }; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [id]);\n\n  async function remove(id) {\n    await axios.delete(`/rols/${id}`).then(() => {\n      //console.log(data);\n      let updatedRecords = [...data].filter(i => i.id !== id);\n      console.log(updatedRecords);\n      setData(updatedRecords); //setUpdate(!update);\n    }).catch(error => {\n      console.log(error); //console.log(error.response.status);\n      //console.log(error.response.headers);\n\n      if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n    });\n  }\n\n  const handleCheckbox = index => e => {\n    //console.log(checkedObj);\n    console.log(index + e.target.value);\n    console.log(data);\n    let key = index;\n    let item = data[index];\n    let val = item['updated'];\n\n    if (val === \"on\" || val === true) {\n      val = false;\n    } else {\n      val = true;\n    }\n\n    item['updated'] = val;\n    let newData = [...data];\n    newData[index] = item;\n    setData(newData);\n  }; //{checked[row.index]}\n\n\n  const columns = useMemo(() => [{\n    Header: 'Existing',\n    accessor: 'existing',\n    Cell: ({\n      row\n    }) => /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"checkbox\",\n        checked: row.values.existing,\n        disabled: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 6\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 5\n    }, this)\n  }, {\n    Header: 'Updated',\n    accessor: 'updated',\n    Cell: ({\n      row\n    }) => /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"checkbox\",\n        onChange: handleCheckbox(row.index),\n        checked: data[row.index]['updated']\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 6\n      }, this), \"\\xA0\\xA0 \", data[row.index]['updated'] === true ? 'Y' : 'N']\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 5\n    }, this)\n  }, {\n    Header: \"Role Name\",\n    accessor: 'rolName'\n  }, {\n    Header: \"Screen Name\",\n    accessor: 'screenName'\n  }, {\n    Header: \"Section\",\n    accessor: 'section.sectionName' // Change this\n\n  }, {\n    Header: \"Activity Brief\",\n    accessor: 'activityBrief'\n  }, {\n    Header: \"Record Status\",\n    accessor: 'recordStatus'\n  }\n  /*\n  {\n  \tHeader: \"Login Name\",\n  \taccessor: 'loginName',\n  \tFilter: SelectColumnFilter,  // new\n  \tfilter: 'includes',\n  },\n  */\n  ], [data]);\n  /*\n  \tconst handleSubmit = (event) => {\n  \t\tevent.preventDefault();\n  \t\tconsole.log(inputText);\n  \t\tsetSearch(inputText);\n  \t}\n  \n  \tconst handleKeyPress = (event) => {\n  \t\t// look for the `Enter` keyCode\n  \t\tif (event.keyCode === 13 || event.which === 13) {\n  \t\t\thandleSubmit(event)\n  \t\t}\n  \t}\n  \n  const rolList = () => {\n  \tdata.map(item => {\n  \t\treturn (\n  \t\t\t<div>\n  \t\t\t\titem.rolname\n  \t\t\t\t<input type=\"checkbox\" />\n  \t\t\t</div>\n  \t\t);\n  \t})\n  }\n  */\n\n  const onError = (errors, e) => console.log(errors, e); //All foreign keys\n\n\n  const parentData = {\n    usr: {\n      title: \"Search Users - Account No or Name\",\n      url: \"usrs\",\n      searchList: [\"accountNo\", \"usrName\"],\n      fkEntity: \"dummy\",\n      //LiveSearch expects fk, so give a dummy\n      preload: false\n    }\n  }; //Callback for child components (Foreign Keys)\n\n  const callback = childData => {\n    console.log(childData);\n    history.push('/usrs/' + childData.entity.id + '/rols');\n  };\n\n  const errorCallback = err => {\n    //console.log(err);\n    setServerErrors(err);\n  }; //console.log(entity);\n\n\n  const handleInputChange = e => {//console.log(e.target.value);\n  };\n\n  const saveRoles = () => {\n    console.log(data);\n    let saving = false;\n    console.log(id);\n\n    async function saveData() {\n      if (!saving) await axios.put(`/usrs/${id}/rols`, data).then(response => {\n        setData(response.data);\n      }).catch(error => {\n        //console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n      });\n    }\n\n    saveData();\n    return () => {\n      saving = true;\n    };\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gray-100 text-gray-900\",\n    children: /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 pt-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \" \",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-xl font-semibold ml-4\",\n          children: \"User Roles\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \" ml-2 flex flex-wrap content-start ...\",\n          children: [/*#__PURE__*/_jsxDEV(LiveSearch, {\n            name: \"designation\",\n            onChange: handleInputChange,\n            parentData: parentData.usr,\n            parentCallback: callback,\n            fkEntity: entity.usr,\n            classname: \" flex flex-wrap content-start \"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 253,\n            columnNumber: 6\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            onClick: saveRoles,\n            className: \" mt-3  w-24  \",\n            children: \"Save Roles\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 256,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"-mt-2 max-h-1 py-0 ml-0\",\n        children: /*#__PURE__*/_jsxDEV(Table, {\n          columns: columns,\n          data: data,\n          className: \"table-auto\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 6\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 4\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 235,\n    columnNumber: 3\n  }, this);\n}\n\n_s(UsrRolList, \"ICLsX3uUgWsL9RPVsVdogETjk7A=\", false, function () {\n  return [useParams, useHistory];\n});\n\n_c = UsrRolList;\nexport default _c2 = withRouter(UsrRolList);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"UsrRolList\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["/home/rr/Workspace/Js/falcon_face/src/components/UsrRolList.js"],"names":["useState","useEffect","useMemo","Table","SelectColumnFilter","axios","withRouter","Link","useParams","useHistory","LiveSearch","UsrRolList","data","setData","serverErrors","setServerErrors","usrId","setUsrId","inputText","setInputText","entity","setEntity","id","history","fetching","console","log","fetchData","get","then","response","catch","error","Error","remove","delete","updatedRecords","filter","i","handleCheckbox","index","e","target","value","key","item","val","newData","columns","Header","accessor","Cell","row","values","existing","onError","errors","parentData","usr","title","url","searchList","fkEntity","preload","callback","childData","push","errorCallback","err","handleInputChange","saveRoles","saving","saveData","put"],"mappings":"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","sourcesContent":["import { useState, useEffect, useMemo } from 'react';\nimport Table, { SelectColumnFilter } from '../utils/Table'  // \nimport axios from \"axios\";\nimport { withRouter, Link, useParams, useHistory } from \"react-router-dom\";\nimport LiveSearch from '../utils/LiveSearch';\n\nfunction UsrRolList() {\n\n\tconst [data, setData] = useState([]);\n\t//const [update, setUpdate] = useState(false);\n\tconst [serverErrors, setServerErrors] = useState([]);\n\tconst [usrId, setUsrId] = useState(\"\");\n\tconst [inputText, setInputText] = useState('');\n\tconst [entity, setEntity] = useState({});\n\t//const [state, setState] = useState({});\t\n\n\tlet { id } = useParams();\n\tlet history = useHistory();\n\n\n\tuseEffect(() => {\n\t\tlet fetching = false;\n\t\tconsole.log(id);\n\t\tasync function fetchData() {\n\t\t\tif (!fetching)\n\t\t\t\tawait axios.get(`/usrs/${id}/rols`)\n\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\tsetData(response.data);\n\t\t\t\t\t})\n\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t//console.log(error);\n\t\t\t\t\t\t//console.log(error.response.status);\n\t\t\t\t\t\t//console.log(error.response.headers);\n\t\t\t\t\t\tif (error.response)\n\t\t\t\t\t\t\tsetServerErrors(error.response.data.error);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tsetServerErrors(error.Error);\n\t\t\t\t\t})\n\t\t}\n\t\tfetchData();\n\n\t\treturn () => { fetching = true; }\n\n\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [id]);\n\n\n\tasync function remove(id) {\n\t\tawait axios.delete(`/rols/${id}`)\n\t\t\t.then(() => {\n\t\t\t\t//console.log(data);\n\t\t\t\tlet updatedRecords = [...data].filter((i) => i.id !== id);\n\t\t\t\tconsole.log(updatedRecords);\n\t\t\t\tsetData(updatedRecords);\n\t\t\t\t//setUpdate(!update);\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.log(error);\n\t\t\t\t//console.log(error.response.status);\n\t\t\t\t//console.log(error.response.headers);\n\t\t\t\tif (error.response)\n\t\t\t\t\tsetServerErrors(error.response.data.error);\n\t\t\t\telse\n\t\t\t\t\tsetServerErrors(error.Error);\n\t\t\t});\n\t}\n\n\n\tconst handleCheckbox = index => (e) => {\n\t\t//console.log(checkedObj);\n\t\tconsole.log(index + e.target.value);\n\t\tconsole.log(data);\n\t\tlet key = index;\n\t\tlet item = data[index];\n\t\tlet val = item['updated'];\n\t\tif (val === \"on\" || val === true) {\n\t\t\tval = false;\n\t\t} else {\n\t\t\tval = true;\n\t\t}\n\n\t\titem['updated'] = val;\n\t\tlet newData = [...data];\n\t\tnewData[index] = item;\n\t\tsetData(newData);\n\t}\n\n\t//{checked[row.index]}\n\tconst columns = useMemo(() => [\n\n\t\t{\n\t\t\tHeader: 'Existing',\n\t\t\taccessor: 'existing',\n\t\t\tCell: ({ row }) => (\n\t\t\t\t<div>\n\t\t\t\t\t<input type=\"checkbox\" checked={row.values.existing} disabled />\n\t\t\t\t</div>\n\t\t\t)\n\t\t},\n\t\t{\n\t\t\tHeader: 'Updated',\n\t\t\taccessor: 'updated',\n\t\t\tCell: ({ row }) => (\n\t\t\t\t<div>\n\n\t\t\t\t\t<input type=\"checkbox\" onChange={handleCheckbox(row.index)} checked={data[row.index]['updated']} />\n\t\t\t\t&nbsp;&nbsp; {data[row.index]['updated'] === true ? 'Y' : 'N'}\n\t\t\t\t</div>\n\t\t\t)\n\t\t},\n\n\t\t{\n\t\t\tHeader: \"Role Name\",\n\t\t\taccessor: 'rolName',\n\t\t},\n\n\t\t{\n\t\t\tHeader: \"Screen Name\",\n\t\t\taccessor: 'screenName',\n\t\t},\n\t\t{\n\t\t\tHeader: \"Section\",\n\t\t\taccessor: 'section.sectionName',// Change this\n\t\t},\n\n\t\t{\n\t\t\tHeader: \"Activity Brief\",\n\t\t\taccessor: 'activityBrief',\n\t\t},\n\n\n\n\t\t{\n\t\t\tHeader: \"Record Status\",\n\t\t\taccessor: 'recordStatus',\n\t\t},\n\n\n\t\t/*\n\t\t{\n\t\t\tHeader: \"Login Name\",\n\t\t\taccessor: 'loginName',\n\t\t\tFilter: SelectColumnFilter,  // new\n\t\t\tfilter: 'includes',\n\t\t},\n\t\t*/\n\t], [data])\n\n\n\t/*\n\t\tconst handleSubmit = (event) => {\n\t\t\tevent.preventDefault();\n\t\t\tconsole.log(inputText);\n\t\t\tsetSearch(inputText);\n\t\t}\n\t\n\t\tconst handleKeyPress = (event) => {\n\t\t\t// look for the `Enter` keyCode\n\t\t\tif (event.keyCode === 13 || event.which === 13) {\n\t\t\t\thandleSubmit(event)\n\t\t\t}\n\t\t}\n\t\n\tconst rolList = () => {\n\t\tdata.map(item => {\n\t\t\treturn (\n\t\t\t\t<div>\n\t\t\t\t\titem.rolname\n\t\t\t\t\t<input type=\"checkbox\" />\n\t\t\t\t</div>\n\t\t\t);\n\t\t})\n\t}\n*/\n\tconst onError = (errors, e) => console.log(errors, e);\n\n\t//All foreign keys\n\tconst parentData = {\n\t\tusr: {\n\t\t\ttitle: \"Search Users - Account No or Name\",\n\t\t\turl: \"usrs\",\n\t\t\tsearchList: [\"accountNo\", \"usrName\"],\n\t\t\tfkEntity: \"dummy\", //LiveSearch expects fk, so give a dummy\n\t\t\tpreload: false,\n\t\t},\n\t}\n\n\n\t//Callback for child components (Foreign Keys)\n\tconst callback = (childData) => {\n\t\tconsole.log(childData);\n\t\thistory.push('/usrs/' + childData.entity.id + '/rols');\n\n\t};\n\n\tconst errorCallback = (err) => {\n\t\t//console.log(err);\n\t\tsetServerErrors(err);\n\t}\n\n\t//console.log(entity);\n\n\tconst handleInputChange = (e) => {\n\t\t//console.log(e.target.value);\n\t};\n\n\tconst saveRoles = () => {\n\t\tconsole.log(data);\n\t\tlet saving = false;\n\t\tconsole.log(id);\n\t\tasync function saveData() {\n\t\t\tif (!saving)\n\t\t\t\tawait axios.put(`/usrs/${id}/rols`, data)\n\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\tsetData(response.data);\n\t\t\t\t\t})\n\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t//console.log(error);\n\t\t\t\t\t\t//console.log(error.response.status);\n\t\t\t\t\t\t//console.log(error.response.headers);\n\t\t\t\t\t\tif (error.response)\n\t\t\t\t\t\t\tsetServerErrors(error.response.data.error);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tsetServerErrors(error.Error);\n\t\t\t\t\t})\n\t\t}\n\t\tsaveData();\n\n\t\treturn () => { saving = true; }\n\t}\n\t\n\n\treturn (\n\t\t<div className=\"min-h-screen bg-gray-100 text-gray-900\">\n\t\t\t<main className=\"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 pt-4\">\n\t\t\t\t<div className=\" \">\n\t\t\t\t\t{/*\n\t\t\t\t\t<h1 className=\"text-xl font-semibold\">User Roles</h1>\n\t\t\t\t\t\n\t\t\t\t\t<div className=\"flexContainer\">\n\t\t\t\t\t\t<input type=\"text\" name=\"search\" \n\t\t\t\t\t\tonChange={e => setInputText(e.target.value)} placeholder=\"Search Not Yet Implemented\"\n\t\t\t\t\t\t\tonKeyPress={handleKeyPress}\n\t\t\t\t\t\t\tclassName=\"pl-2 -ml-2 inputField flex-initial\" />\n\t\t\t\t\t\t<button type=\"submit\" onClick={handleSubmit} className=\"w-16 m-0 p-0\">Search</button>\n\t\t\t\t\t</div>\n\t\t\t\t\t*/}\n\t\t\t\t\t\n\t\t\t\t\t<h1 className=\"text-xl font-semibold ml-4\">User Roles</h1>\n\t\t\t\t\t\n\t\t\t\t\t<div className = \" ml-2 flex flex-wrap content-start ...\">\n\t\t\t\t\t<LiveSearch name=\"designation\" onChange={handleInputChange}\n\t\t\t\t\t\tparentData={parentData.usr} parentCallback={callback}\n\t\t\t\t\t\tfkEntity={entity.usr} classname = \" flex flex-wrap content-start \"/>\n\t\t\t\t\t\t<button type=\"submit\" onClick={saveRoles} className=\" mt-3  w-24  \" >Save Roles</button>\n\t\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t\n\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"-mt-2 max-h-1 py-0 ml-0\">\n\t\t\t\t\t<Table columns={columns} data={data} className=\"table-auto\" />\n\t\t\t\t</div>\n\n\t\t\t</main>\n\n\t\t</div>\n\t);\n}\n\nexport default withRouter(UsrRolList);\n\n"]},"metadata":{},"sourceType":"module"}