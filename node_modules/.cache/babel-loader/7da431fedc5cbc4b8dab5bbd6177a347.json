{"ast":null,"code":"import _defineProperty from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/itsdcsec/falconws/falcon_face/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/**\n * Code generated using Python\n * @author Raja Reddy\n * Date : 17 Oct 2021\n *\n * Modified By : \n */import{useState,useEffect}from\"react\";import{withRouter,useParams,useHistory}from\"react-router-dom\";import{useForm}from\"react-hook-form\";import Select from'react-select';import axios from'axios';import*as yup from\"yup\";import{yupResolver}from'@hookform/resolvers/yup';import LiveSearch from'../utils/LiveSearch';import DatePicker from'react-datepicker';import\"react-datepicker/dist/react-datepicker.css\";import addDays from'date-fns/addDays';import Tabs from'react-bootstrap/Tabs';import Tab from'react-bootstrap/Tab';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var schema=yup.object({dakCategory:yup.object().required('Dak Category Required')//sectionGroup: yup.string().required('Section Required'),\n//aoDate: yup.string().required('Required'),\n});var DakTypeEdit=function DakTypeEdit(){var _errors$dakCategory,_errors$description;var _useForm=useForm({resolver:yupResolver(schema)}),register=_useForm.register,handleSubmit=_useForm.handleSubmit,setValue=_useForm.setValue,errors=_useForm.formState.errors,clearErrors=_useForm.clearErrors;var _useParams=useParams(),id=_useParams.id;//console.log(id);\nvar history=useHistory();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),serverErrors=_useState2[0],setServerErrors=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),entity=_useState4[0],setEntity=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),state=_useState6[0],setState=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),secGroup=_useState8[0],setSecGroup=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),sectionGroupList=_useState10[0],setSectionGroupList=_useState10[1];var _useState11=useState(true),_useState12=_slicedToArray(_useState11,2),loading=_useState12[0],setLoading=_useState12[1];var _useState13=useState('Page1'),_useState14=_slicedToArray(_useState13,2),key=_useState14[0],setKey=_useState14[1];useEffect(function(){var isCancelled=false;console.log(id);if(id!=='new'){function fetchData(){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var record,fields;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:record='';_context.next=3;return axios.get('/dakTypes/'+id).then(function(response){record=response.data;}).catch(function(error){//console.log(error);\n//console.log(error.response.status);\n//console.log(error.response.headers);\nif(error.response)setServerErrors(error.response.data.error);else setServerErrors(error.Error);});case 3:fields=['id','dakCategory','section','sectionGroup','description'];fields.forEach(function(field){return setValue(field,record[field]);});if(!isCancelled){setEntity(record);setState(function(prev){return _objectSpread(_objectSpread({},prev),{},{state:record});});}case 6:case\"end\":return _context.stop();}}},_callee);}));return _fetchData.apply(this,arguments);}fetchData();return function(){isCancelled=true;};}},[id,setValue]);useEffect(function(){var fetching=false;var unmounted=false;function fetchSectionGroup(){return _fetchSectionGroup.apply(this,arguments);}function _fetchSectionGroup(){_fetchSectionGroup=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(fetching){_context2.next=3;break;}_context2.next=3;return axios.get(\"/sections/999/sectionGroup\").then(function(response){console.log(\"response>>\"+response.data);setSectionGroupList(response.data);if(!unmounted){setLoading(false);}}).catch(function(error){//console.log(error);\n//console.log(error.response.status);\n//console.log(error.response.headers);\nif(error.response)setServerErrors(error.response.data.error);else setServerErrors(error.Error);});case 3:case\"end\":return _context2.stop();}}},_callee2);}));return _fetchSectionGroup.apply(this,arguments);}fetchSectionGroup();return function(){fetching=true;unmounted=true;};// eslint-disable-next-line react-hooks/exhaustive-deps\n},[id]);var onSubmit=function onSubmit(data,event){event.preventDefault();console.log(data);if(data.id){axios.put(\"/dakTypes/\"+data.id,data).then(function(response){}).catch(function(error){//console.log(error.response.data);\n//console.log(error.response.status);\n//console.log(error.response.headers);\nsetServerErrors(error.response.data);});}else{axios.post(\"/dakTypes\",data).then(function(response){}).catch(function(error){//console.log(error.response.data);\n//console.log(error.response.status);\n//console.log(error.response.headers);\nif(error.response)setServerErrors(error.response.data);else setServerErrors(error);});}history.push(\"/dakTypes\");};var onError=function onError(errors,e){return console.log(errors,e);};//All foreign keys. \n// XXXXXX Add search fields and adjust the values as necessary\nvar parentData={dakCategory:{title:\"DakCategory\",url:\"dakCategorys\",searchList:['categoryCode','categoryName'],//XXXXXXXXX Add search fields\nfkEntity:\"dakCategory\",preload:false//XXXXXX Set this to true for small tables like designations\n},section:{title:\"Section\",url:\"sections\",searchList:['sectionName'],//XXXXXXXXX Add search fields\nfkEntity:\"section\",preload:false//XXXXXX Set this to true for small tables like designations\n}};var handleGroupChange=function handleGroupChange(e){setSecGroup(sectionGroupList[e.target.selectedIndex-1]);setValue('sectionGroup',sectionGroupList[e.target.selectedIndex-1]);console.log(sectionGroupList[e.target.selectedIndex-1]);};//Callback for child components (Foreign Keys)\nvar callback=function callback(childData){//console.log(\"Parent Callback\");\nsetEntity(function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},childData.fk,childData.entity));});setValue(childData.fk,childData.entity);//console.log(errors);\nclearErrors(childData.fk);};var errorCallback=function errorCallback(err){//console.log(err);\nsetServerErrors(err);};var handleInputChange=function handleInputChange(e){//console.log(e.target.value);\n};return/*#__PURE__*/_jsx(\"div\",{className:\"max-w-xl mx-auto \",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-full w-3/4  mx-auto \",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit,onError),children:[/*#__PURE__*/_jsxs(\"h1\",{children:[id==='new'?'Add':'Edit',\" Dak Type \"]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:serverErrors}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-0 \",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Section Group\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"form-control py-0\",disabled:loading,value:secGroup,onChange:handleGroupChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",label:\"--select--\"},\"default\"),sectionGroupList.map(function(item,index){return/*#__PURE__*/_jsxs(\"option\",{value:item.toString(),children:[\"   \",item.toString(),\" \"]},item);})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(LiveSearch,{name:\"dakCategory\",onChange:handleInputChange,parentData:parentData.dakCategory,parentCallback:callback,fkEntity:entity.dakCategory,errCallback:errorCallback}),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500 \",children:(_errors$dakCategory=errors.dakCategory)===null||_errors$dakCategory===void 0?void 0:_errors$dakCategory.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Description\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"text\",name:\"description\"},register(\"description\")),{},{className:\"form-control py-0\"})),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:(_errors$description=errors.description)===null||_errors$description===void 0?void 0:_errors$description.message})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"px-4 ...\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Save\"})})]})})});};export default withRouter(DakTypeEdit);","map":{"version":3,"sources":["/home/itsdcsec/falconws/falcon_face/src/components/DakTypeEdit.js"],"names":["useState","useEffect","withRouter","useParams","useHistory","useForm","Select","axios","yup","yupResolver","LiveSearch","DatePicker","addDays","Tabs","Tab","schema","object","dakCategory","required","DakTypeEdit","resolver","register","handleSubmit","setValue","errors","formState","clearErrors","id","history","serverErrors","setServerErrors","entity","setEntity","state","setState","secGroup","setSecGroup","sectionGroupList","setSectionGroupList","loading","setLoading","key","setKey","isCancelled","console","log","fetchData","record","get","then","response","data","catch","error","Error","fields","forEach","field","prev","fetching","unmounted","fetchSectionGroup","onSubmit","event","preventDefault","put","post","push","onError","e","parentData","title","url","searchList","fkEntity","preload","section","handleGroupChange","target","selectedIndex","callback","childData","fk","errorCallback","err","handleInputChange","map","item","index","toString","message","description"],"mappings":"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","sourcesContent":["/**\n * Code generated using Python\n * @author Raja Reddy\n * Date : 17 Oct 2021\n *\n * Modified By : \n */\n\nimport { useState, useEffect } from \"react\";\nimport { withRouter, useParams, useHistory } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport Select from 'react-select';\nimport axios from 'axios';\nimport * as yup from \"yup\";\n\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport LiveSearch from '../utils/LiveSearch';\n\nimport DatePicker from 'react-datepicker';\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport addDays from 'date-fns/addDays'\n\nimport Tabs from 'react-bootstrap/Tabs'\nimport Tab from 'react-bootstrap/Tab'\n\n\nconst schema = yup.object({\n\t \n\tdakCategory: yup.object().required('Dak Category Required'),\n\t//sectionGroup: yup.string().required('Section Required'),\n\t//aoDate: yup.string().required('Required'),\n\t \n});\n\n\nconst DakTypeEdit = () => {\n\tconst { register, handleSubmit, setValue, formState: { errors }, clearErrors } = useForm({\n\t\tresolver: yupResolver(schema)\n\t});\n\n\tlet { id } = useParams();\n\t//console.log(id);\n\n\tlet history = useHistory();\n\tconst [serverErrors, setServerErrors] = useState([]);\n\tconst [entity, setEntity] = useState({});\n\tconst [state, setState] = useState({});\n\t const [secGroup,setSecGroup]=useState('');\n\tconst [sectionGroupList,setSectionGroupList]=useState([]);\n\t const [loading, setLoading] = useState(true);\n\tconst [key, setKey] = useState('Page1');\n\n\n\n\n\tuseEffect(() => {\n\t\tlet isCancelled = false;\n\t\tconsole.log(id);\n\t\tif (id !== 'new') {\n\t\t\tasync function fetchData() {\n\t\t\t\tlet record = '';\n\t\t\t\tawait axios.get('/dakTypes/' + id)\n\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\trecord = response.data;\n\t\t\t\t\t})\n\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t//console.log(error);\n\t\t\t\t\t\t//console.log(error.response.status);\n\t\t\t\t\t\t//console.log(error.response.headers);\n\t\t\t\t\t\tif (error.response)\n\t\t\t\t\t\t\tsetServerErrors(error.response.data.error);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tsetServerErrors(error.Error);\n\t\t\t\t\t});\n\n\t\t\t\tconst fields = [\n\t\t\t\t\t'id', 'dakCategory', 'section','sectionGroup', 'description' \n\t\t\t\t];\n\t\t\t\tfields.forEach(field => setValue(field, record[field]));\n\t\t\t\tif (!isCancelled) {\n\t\t\t\t\tsetEntity(record);\n\t\t\t\t\tsetState(prev => ({ ...prev, state: record }));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfetchData();\n\t\t\treturn () => {\n\t\t\t\tisCancelled = true;\n\t\t\t};\n\t\t}\n\n\t}, [id, setValue]);\n\n\n\n\tuseEffect(() => {\n\t\tlet fetching = false;\n\t\tlet unmounted = false;\n\t\t \n\t\tasync function fetchSectionGroup() {\n\t\t\t \n\t\t\tif (!fetching)\n\t\t\t\t//console.log(secId);\n\t\t\t\tawait axios.get(`/sections/999/sectionGroup`)\n\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\tconsole.log(\"response>>\" + response.data);\n\t\t\t\t\t\tsetSectionGroupList(response.data);\n\t\t\t\t\t\tif (!unmounted) {\n\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t \n\t\t\t\t\t\t\tsetLoading(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t//console.log(error);\n\t\t\t\t\t\t//console.log(error.response.status);\n\t\t\t\t\t\t//console.log(error.response.headers);\n\t\t\t\t\t\tif (error.response)\n\t\t\t\t\t\t\tsetServerErrors(error.response.data.error);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tsetServerErrors(error.Error);\n\t\t\t\t\t})\n\t\t}\n\t\tfetchSectionGroup();\n\n\t\treturn () => { fetching = true; unmounted = true; }\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [id]);\n\tconst onSubmit = (data, event) => {\n\t\tevent.preventDefault();\n\t\tconsole.log(data);\n\t\tif (data.id) {\n\t\t\taxios.put(\"/dakTypes/\" + data.id, data)\n\t\t\t\t.then((response) => { })\n\t\t\t\t.catch((error) => {\n\t\t\t\t\t//console.log(error.response.data);\n\t\t\t\t\t//console.log(error.response.status);\n\t\t\t\t\t//console.log(error.response.headers);\n\t\t\t\t\tsetServerErrors(error.response.data)\n\t\t\t\t});\n\t\t} else {\n\t\t\taxios.post(\"/dakTypes\", data)\n\t\t\t\t.then((response) => { })\n\t\t\t\t.catch((error) => {\n\t\t\t\t\t//console.log(error.response.data);\n\t\t\t\t\t//console.log(error.response.status);\n\t\t\t\t\t//console.log(error.response.headers);\n\t\t\t\t\tif (error.response)\n\t\t\t\t\t\tsetServerErrors(error.response.data);\n\t\t\t\t\telse\n\t\t\t\t\t\tsetServerErrors(error);\n\t\t\t\t});\n\t\t}\n\n\t\thistory.push(\"/dakTypes\");\n\t}\n\n\tconst onError = (errors, e) => console.log(errors, e);\n\n\t//All foreign keys. \n\t// XXXXXX Add search fields and adjust the values as necessary\n\tconst parentData = {\n\n\t\t \n\t\tdakCategory: {\n\t\t\ttitle: \"DakCategory\",\n\t\t\turl: \"dakCategorys\",\n\t\t\tsearchList: ['categoryCode','categoryName'], //XXXXXXXXX Add search fields\n\t\t\tfkEntity: \"dakCategory\",\n\t\t\tpreload: false, //XXXXXX Set this to true for small tables like designations\n\t\t},\n\t\tsection: {\n\t\t\ttitle: \"Section\",\n\t\t\turl: \"sections\",\n\t\t\tsearchList: ['sectionName'], //XXXXXXXXX Add search fields\n\t\t\tfkEntity: \"section\",\n\t\t\tpreload: false, //XXXXXX Set this to true for small tables like designations\n\t\t},\n\t\t \n\t\t \n\t\t \n\t}\n\t\tconst handleGroupChange = (e) =>{\n\t\tsetSecGroup(sectionGroupList[e.target.selectedIndex-1]);\n\t\tsetValue('sectionGroup',sectionGroupList[e.target.selectedIndex-1])\n\t\tconsole.log(sectionGroupList[e.target.selectedIndex-1]);\n\t}\n\n\t//Callback for child components (Foreign Keys)\n\tconst callback = (childData) => {\n\t\t//console.log(\"Parent Callback\");\n\t\tsetEntity(prev => ({ ...prev, [childData.fk]: childData.entity }));\n\t\tsetValue(childData.fk, childData.entity);\n\t\t//console.log(errors);\n\t\tclearErrors(childData.fk);\n\t};\n\n\tconst errorCallback = (err) => {\n\t\t//console.log(err);\n\t\tsetServerErrors(err);\n\t}\n\n\tconst handleInputChange = (e) => {\n\t\t//console.log(e.target.value);\n\t};\n\n\treturn (\n\t\t<div className=\"max-w-xl mx-auto \">\n\t\t\t<div className=\"w-full w-3/4  mx-auto \" >\n\n\t\t\t\t<form onSubmit={handleSubmit(onSubmit, onError)}>\n\t\t\t\t\t<h1 >{id === 'new' ? 'Add' : 'Edit'} Dak Type </h1>\n\t\t\t\t\t<div className=\"text-red-500\">{serverErrors}</div>\n\n\t\t\t\t\t \n\t\t\t\t\t\t\t<div className=\"grid grid-cols-2 gap-0 \">\n \n\t\t\t\t\t\t\t\t<div >\n\t\t\t\t\t\t\t<b>Section Group</b>\n\t\t\t\t\t\t\t<select className=\"form-control py-0\"\n\t\t\t\t\t\t\t\tdisabled={loading}\n\t\t\t\t\t\t\t\tvalue={secGroup}\n\t\t\t\t\t\t\t\tonChange={handleGroupChange}>\n\t\t\t\t\t\t\t\t<option key=\"default\" value=\"\" label=\"--select--\"/>\n\t\t\t\t\t\t\t\t{sectionGroupList.map((item,index) => (\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<option key={item} value={item.toString()}>   {item.toString()} </option>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<div >\n\t\t\t\t\t\t\t\t\t<LiveSearch name=\"dakCategory\" onChange={handleInputChange}\n\t\t\t\t\t\t\t\t\t\tparentData={parentData.dakCategory} parentCallback={callback}\n\t\t\t\t\t\t\t\t\t\tfkEntity={entity.dakCategory} errCallback={errorCallback} />\n\t\t\t\t\t\t\t\t\t<div className=\"text-red-500 \">{errors.dakCategory?.message}</div>\n\t\t\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t\t\t\t \n\n\t\t\t\t\t\t \n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<label>Description</label>\n\t\t\t\t\t\t\t\t\t<input type=\"text\" name=\"description\" {...register(\"description\")}\n\t\t\t\t\t\t\t\t\t\tclassName=\"form-control py-0\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<div className=\"text-red-500\">{errors.description?.message}</div>\n\t\t\t\t\t\t\t\t</div>\n \n</div>\n\t\t\t\t\t\t \n\n\t\t\t\t\t\t \n\n\t\t\t\t\t<div className=\"px-4 ...\">\n\t\t\t\t\t\t<button type=\"submit\" >Save</button>\n\t\t\t\t\t</div>\n\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport default withRouter(DakTypeEdit);"]},"metadata":{},"sourceType":"module"}