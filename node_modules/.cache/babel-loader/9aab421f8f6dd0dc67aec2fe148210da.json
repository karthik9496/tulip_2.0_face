{"ast":null,"code":"var _jsxFileName = \"/home/itsdc3/Imp Tulip files/falconws160424/falconws/falcon_face/src/components/PrintPmCs.js\";\n\n/**\n * Code generated using Python\n * @author Raja Reddy\n * Date : 17 Oct 2021\n *\n * Modified By : \n */\nimport { useState, useEffect, useMemo } from \"react\";\nimport { withRouter, useParams, useHistory, Link } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport axios from 'axios';\nimport Table, { SelectColumnFilter } from '../utils/Table'; // \n\nimport * as yup from \"yup\";\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport addDays from 'date-fns/addDays';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst schema = yup.object({});\n\nconst PrintPmCs = () => {\n  const {\n    register,\n    handleSubmit,\n    setValue,\n    formState: {\n      errors\n    },\n    clearErrors\n  } = useForm({\n    resolver: yupResolver(schema)\n  });\n  let {\n    id\n  } = useParams(); //console.log(id);\n\n  let history = useHistory();\n  const [data, setData] = useState([]);\n  const [serverErrors, setServerErrors] = useState([]);\n  const [entity, setEntity] = useState({});\n  const [state, setState] = useState({});\n  const [dakId, setDakId] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [fileName, setFileName] = useState('');\n  const [key, setKey] = useState('Page1');\n  const [reportType, setReportType] = useState('');\n  const [option, setOption] = useState('');\n  const [dpSheetNo, setDpSheetNo] = useState('');\n  const [sectionCode, setSectionCode] = useState('');\n  const [fy, setFy] = useState('');\n  useEffect(() => {\n    let fetching = false;\n    let unmounted = false;\n\n    async function fetchData() {\n      if (!fetching) //console.log(secId);\n        await axios.get(`/pms?search='PrintPmCs'`).then(response => {\n          console.log(\"response>>\" + response.data); //setSh3List(response.data);\n\n          setData(response.data);\n          ;\n        }).catch(error => {\n          //console.log(error);\n          //console.log(error.response.status);\n          //console.log(error.response.headers);\n          if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n        });\n    }\n\n    fetchData();\n    return () => {\n      fetching = true;\n      unmounted = true;\n    }; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const onError = (errors, e) => console.log(errors, e); //All foreign keys. \n  // XXXXXX Add search fields and adjust the values as necessary\n\n\n  const errorCallback = err => {\n    //console.log(err);\n    setServerErrors(err);\n  };\n\n  const handleInputChange = e => {\n    console.log(e.target.value);\n    setDakId(e.target.value);\n  };\n\n  const handleInputDpsNoChange = e => {\n    console.log(e.target.value);\n    setDpSheetNo(e.target.value);\n  };\n\n  const handlePmcsChange = event => {\n    setReportType(event.target.value);\n    setOption(\"pmcs\");\n  };\n\n  const handleCsChange = event => {\n    setReportType(event.target.value);\n    setOption(\"cs\");\n  };\n\n  const handleDpChange = event => {\n    setReportType(event.target.value);\n    setOption(\"dp\");\n  };\n\n  const handleSectionChange = e => {\n    console.log(e.target.value);\n    setSectionCode(e.target.value);\n  };\n\n  const handleFyChange = e => {\n    console.log(e.target.value);\n    setFy(e.target.value);\n  };\n\n  const generatePmCs = () => {\n    let saving = false;\n    console.log(dakId);\n\n    async function pmcs() {\n      if (!saving) axios.get(`pms/0/printPmCs/${dakId}`).then(response => {\n        console.log(response.data);\n        const url = window.open(`${process.env.REACT_APP_BASE_URL}/files/${response.data}`);\n      }).catch(error => {\n        //console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n      });\n    }\n\n    pmcs();\n    return () => {\n      saving = true;\n    };\n  };\n\n  const generateCs = () => {\n    let saving = false;\n    console.log(dpSheetNo);\n\n    async function pmcs() {\n      if (!saving) axios.get(`pms/printPmCs/${dpSheetNo}/${sectionCode}/${fy}/${option}`).then(response => {\n        console.log(response.data);\n        const url = window.open(`${process.env.REACT_APP_BASE_URL}/files/${response.data}`);\n      }).catch(error => {\n        //console.log(error);\n        //console.log(error.response.status);\n        //console.log(error.response.headers);\n        if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n      });\n    }\n\n    pmcs();\n    return () => {\n      saving = true;\n    };\n  };\n\n  const download = () => {\n    console.log(fileName);\n    setFileName(dakId + \".pdf\");\n    axios({\n      url: `${process.env.REACT_APP_BASE_URL}/files/` + fileName,\n      //XXXXXXXX localhost\n      method: 'GET',\n      responseType: 'blob' // important\n\n    }).then(response => {\n      const url = window.URL.createObjectURL(new Blob([response.data]));\n      const link = document.createElement('a');\n      link.href = url;\n      link.setAttribute('download', fileName);\n      document.body.appendChild(link);\n      link.click();\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gray-100 text-gray-900\",\n    children: /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 pt-4\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \" \",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-xl font-semibold ml-4\",\n          children: \"Print PM/CS\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-3 gap-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: /*#__PURE__*/_jsxDEV(\"label\", {\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"radio\",\n                  value: \"pmcs\",\n                  checked: reportType === 'pmcs',\n                  onChange: handlePmcsChange\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 237,\n                  columnNumber: 3\n                }, this), \" Print Pm and Chq Slip\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 236,\n                columnNumber: 3\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 235,\n              columnNumber: 9\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: /*#__PURE__*/_jsxDEV(\"label\", {\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"radio\",\n                  value: \"cs\",\n                  checked: reportType === 'cs',\n                  onChange: handleCsChange\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 246,\n                  columnNumber: 3\n                }, this), \" Print Consolidated Chq Slip\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 245,\n                columnNumber: 3\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 244,\n              columnNumber: 4\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: /*#__PURE__*/_jsxDEV(\"label\", {\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"radio\",\n                  value: \"dp\",\n                  checked: reportType === 'dp',\n                  onChange: handleDpChange\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 252,\n                  columnNumber: 3\n                }, this), \" Print Summary of DP Sheet\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 251,\n                columnNumber: 3\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 250,\n              columnNumber: 3\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 234,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex space-x-4\",\n            children: [option === 'pmcs' && /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  name: \"search\",\n                  placeholder: \"DakId No\",\n                  onChange: e => handleInputChange(e),\n                  className: \"pl-2 -ml-2 inputField flex-initial\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 262,\n                  columnNumber: 7\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 261,\n                columnNumber: 7\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"submit\",\n                  onClick: generatePmCs,\n                  className: \"w-24 m-0 p-0\",\n                  children: \"Print PM/CS\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 268,\n                  columnNumber: 7\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 267,\n                columnNumber: 8\n              }, this)]\n            }, void 0, true), (option === 'cs' || option === 'dp') && /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  name: \"search\",\n                  placeholder: \"DP Sheet No\",\n                  onChange: e => handleInputDpsNoChange(e),\n                  className: \"pl-2 -ml-2 inputField flex-initial\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 276,\n                  columnNumber: 7\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 275,\n                columnNumber: 7\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  name: \"sectionCode\",\n                  placeholder: \"Section Code\",\n                  onChange: e => handleSectionChange(e),\n                  className: \"pl-2 -ml-2 inputField flex-initial\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 282,\n                  columnNumber: 7\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 281,\n                columnNumber: 8\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  name: \"finYear\",\n                  placeholder: \"Fin Year Start (yyyy)\",\n                  onChange: e => handleFyChange(e),\n                  className: \"pl-2 -ml-2 inputField flex-initial\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 288,\n                  columnNumber: 7\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 287,\n                columnNumber: 8\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"submit\",\n                  onClick: generateCs,\n                  className: \"w-32 m-0 p-0\",\n                  children: \"Print Cheque Slip\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 293,\n                  columnNumber: 12\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 293,\n                columnNumber: 7\n              }, this)]\n            }, void 0, true)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 3\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 4\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 226,\n    columnNumber: 3\n  }, this);\n};\n\nexport default withRouter(PrintPmCs);","map":{"version":3,"sources":["/home/itsdc3/Imp Tulip files/falconws160424/falconws/falcon_face/src/components/PrintPmCs.js"],"names":["useState","useEffect","useMemo","withRouter","useParams","useHistory","Link","useForm","axios","Table","SelectColumnFilter","yup","yupResolver","addDays","schema","object","PrintPmCs","register","handleSubmit","setValue","formState","errors","clearErrors","resolver","id","history","data","setData","serverErrors","setServerErrors","entity","setEntity","state","setState","dakId","setDakId","loading","setLoading","fileName","setFileName","key","setKey","reportType","setReportType","option","setOption","dpSheetNo","setDpSheetNo","sectionCode","setSectionCode","fy","setFy","fetching","unmounted","fetchData","get","then","response","console","log","catch","error","Error","onError","e","errorCallback","err","handleInputChange","target","value","handleInputDpsNoChange","handlePmcsChange","event","handleCsChange","handleDpChange","handleSectionChange","handleFyChange","generatePmCs","saving","pmcs","url","window","open","process","env","REACT_APP_BASE_URL","generateCs","download","method","responseType","URL","createObjectURL","Blob","link","document","createElement","href","setAttribute","body","appendChild","click"],"mappings":"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","sourcesContent":["/**\n * Code generated using Python\n * @author Raja Reddy\n * Date : 17 Oct 2021\n *\n * Modified By : \n */\n\nimport { useState, useEffect, useMemo } from \"react\";\nimport { withRouter, useParams, useHistory,Link } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport axios from 'axios';\nimport Table, { SelectColumnFilter } from '../utils/Table'  // \n\n\nimport * as yup from \"yup\";\n\nimport { yupResolver } from '@hookform/resolvers/yup';\n  \n\n import addDays from 'date-fns/addDays'\n\n \n\nconst schema = yup.object({\n\t \n\t \n\t\n\t \n});\n\n \n\nconst PrintPmCs = () => {\n\tconst { register, handleSubmit, setValue, formState: { errors }, clearErrors } = useForm({\n\t\tresolver: yupResolver(schema)\n\t});\n\n\tlet { id } = useParams();\n\t//console.log(id);\n\n\tlet history = useHistory();\n \n \tconst [data,setData]=useState([]);\n\tconst [serverErrors, setServerErrors] = useState([]);\n\tconst [entity, setEntity] = useState({});\n\tconst [state, setState] = useState({});\n\t \n\tconst [dakId,setDakId]=useState('');\n\t \n\tconst [loading, setLoading] = useState(true);\n\t const [fileName,setFileName]=useState('');\n\t \n\tconst [key, setKey] = useState('Page1');\n\tconst [reportType,setReportType]=useState('');\n\tconst [option,setOption]=useState('');\n\tconst [dpSheetNo,setDpSheetNo]=useState('');\n \tconst [sectionCode,setSectionCode]=useState('');\n \tconst [fy,setFy]=useState('');\n\t\n \n\n\tuseEffect(() => {\n\t\tlet fetching = false;\n\t\tlet unmounted = false;\n\t\t \n\t\tasync function fetchData() {\n\t\t\t \n\t\t\tif (!fetching)\n\t\t\t\t//console.log(secId);\n\t\t\t\tawait axios.get(`/pms?search='PrintPmCs'`)\n\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\tconsole.log(\"response>>\" + response.data);\n\t\t\t\t\t\t//setSh3List(response.data);\n\t\t\t\t\t\t setData(response.data);;\n\t\t\t\t\t\t \n\t\t\t\t\t})\n\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t//console.log(error);\n\t\t\t\t\t\t//console.log(error.response.status);\n\t\t\t\t\t\t//console.log(error.response.headers);\n\t\t\t\t\t\tif (error.response)\n\t\t\t\t\t\t\tsetServerErrors(error.response.data.error);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tsetServerErrors(error.Error);\n\t\t\t\t\t})\n\t\t}\n\t\tfetchData();\n\n\t\treturn () => { fetching = true; unmounted = true; }\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t},[]);\n\n\n \n\n\tconst onError = (errors, e) => console.log(errors, e);\n\n\t//All foreign keys. \n\t// XXXXXX Add search fields and adjust the values as necessary\n\t \n\t \n\tconst errorCallback = (err) => {\n\t\t//console.log(err);\n\t\tsetServerErrors(err);\n\t}\n\t\n\tconst handleInputChange =  (e) =>{\n\t\t   \n\t\t   console.log(e.target.value);\n\t\t\t setDakId(e.target.value);\t\n\t\t \n\t}\n\tconst handleInputDpsNoChange =  (e) =>{\n\t\t   \n\t\t   console.log(e.target.value);\n\t\t\t setDpSheetNo(e.target.value);\t\n\t\t \n\t}\n\tconst handlePmcsChange = (event) => {\n    setReportType(event.target.value)\n    setOption(\"pmcs\");\n  }\n  \n   const handleCsChange = (event) => {\n    setReportType(event.target.value)\n    setOption(\"cs\");\n  }\n  \n  const handleDpChange = (event) => {\n    setReportType(event.target.value)\n    setOption(\"dp\");\n  }\n  \n  const handleSectionChange =  (e) =>{\n\t\t   \n\t\t   console.log(e.target.value);\n\t\t\t setSectionCode(e.target.value);\t\n\t\t \n\t}\n\tconst handleFyChange =  (e) =>{\n\t\t   \n\t\t   console.log(e.target.value);\n\t\t\t setFy(e.target.value);\t\n\t\t \n\t}\n\t\n\t \n\t const generatePmCs = () => {\n\t\t \n\t\tlet saving = false;\n\t\tconsole.log(dakId);\n\t\tasync function pmcs() {\n\t\t\tif (!saving)\n\t\t\t\taxios.get(`pms/0/printPmCs/${dakId}`)\n\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\t \n\t\t\t\t\t\tconsole.log(response.data);\n\t\t\t\t\t\t const url = window.open(`${process.env.REACT_APP_BASE_URL}/files/${response.data}`);\n    \n\t\t\t\t\t})\n\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t//console.log(error);\n\t\t\t\t\t\t//console.log(error.response.status);\n\t\t\t\t\t\t//console.log(error.response.headers);\n\t\t\t\t\t\tif (error.response)\n\t\t\t\t\t\t\tsetServerErrors(error.response.data.error);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tsetServerErrors(error.Error);\n\t\t\t\t\t})\n\t\t}\n\t\tpmcs();\n\n\t\treturn () => { saving = true; }\n\t}\n\t\n\t const generateCs = () => {\n\t\t \n\t\tlet saving = false;\n\t\tconsole.log(dpSheetNo);\n\t\tasync function pmcs() {\n\t\t\tif (!saving)\n\t\t\t\taxios.get(`pms/printPmCs/${dpSheetNo}/${sectionCode}/${fy}/${option}`)\n\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\t \n\t\t\t\t\t\tconsole.log(response.data);\n\t\t\t\t\t\t const url = window.open(`${process.env.REACT_APP_BASE_URL}/files/${response.data}`);\n    \n\t\t\t\t\t})\n\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t//console.log(error);\n\t\t\t\t\t\t//console.log(error.response.status);\n\t\t\t\t\t\t//console.log(error.response.headers);\n\t\t\t\t\t\tif (error.response)\n\t\t\t\t\t\t\tsetServerErrors(error.response.data.error);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tsetServerErrors(error.Error);\n\t\t\t\t\t})\n\t\t}\n\t\tpmcs();\n\n\t\treturn () => { saving = true; }\n\t}\n\t \n\tconst download = () => {\n\t\tconsole.log(fileName);\n\t\tsetFileName(dakId+\".pdf\");\n\t\taxios({\n\t\t\turl: `${process.env.REACT_APP_BASE_URL}/files/` + fileName, //XXXXXXXX localhost\n\t\t\tmethod: 'GET',\n\t\t\tresponseType: 'blob', // important\n\t\t}).then((response) => {\n\t\t\tconst url = window.URL.createObjectURL(new Blob([response.data]));\n\t\t\tconst link = document.createElement('a');\n\t\t\tlink.href = url;\n\t\t\tlink.setAttribute('download', fileName);\n\t\t\tdocument.body.appendChild(link);\n\t\t\tlink.click();\n\t\t});\n\t}\n\t\n\t  \n\t \n\t   \n\treturn (\n\t\t<div className=\"min-h-screen bg-gray-100 text-gray-900\">\n\t\t\t<main className=\"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 pt-4\">\n\t\t\t\t<div className=\" \">\n\t\t\t\t\t \n\n\t\t\t\t\t<h1 className=\"text-xl font-semibold ml-4\">Print PM/CS</h1>\n\t\t\t\t\t<div>\n\t\t\t\t\t\n\t\t\t\t\t <div className=\"grid grid-cols-3 gap-4\">\n\t\t\t\t\t   <div>\n\t <label>\n\t <input type=\"radio\" value=\"pmcs\" checked={reportType==='pmcs'} onChange={handlePmcsChange}/> Print Pm and Chq Slip\n\t </label>\n\t </div>\n\t  \n\t \n\t \n\t \n\t  <div>\n\t <label>\n\t <input type=\"radio\" value=\"cs\" checked={reportType==='cs'} onChange={handleCsChange}/> Print Consolidated Chq Slip\n\t </label>\n\t </div>\n\t \n\t <div>\n\t <label>\n\t <input type=\"radio\" value=\"dp\" checked={reportType==='dp'} onChange={handleDpChange}/> Print Summary of DP Sheet\n\t </label>\n\t </div>\n\t \n\t \n\t </div>\n\t <div className=\"flex space-x-4\">\n\t {option==='pmcs' &&\n\t <>\n\t \t\t\t\t<div>\n\t\t\t\t\t\t<input type=\"text\" name=\"search\" placeholder=\"DakId No\"\n\t\t\t\t\t\tonChange={e=>handleInputChange(e)}\n\t\t\t\t\t\t\t \n\t\t\t\t\t\t\tclassName=\"pl-2 -ml-2 inputField flex-initial\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t<button type=\"submit\" onClick={generatePmCs} className=\"w-24 m-0 p-0\">Print PM/CS</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t}\t\n\t\t\t\t\t\n\t\t\t\t\t {(option==='cs' || option==='dp')&&\n\t <>\n\t \t\t\t\t<div>\n\t\t\t\t\t\t<input type=\"text\" name=\"search\" placeholder=\"DP Sheet No\"\n\t\t\t\t\t\tonChange={e=>handleInputDpsNoChange(e)}\n\t\t\t\t\t\t\t \n\t\t\t\t\t\t\tclassName=\"pl-2 -ml-2 inputField flex-initial\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t<input type=\"text\" name=\"sectionCode\" placeholder=\"Section Code\"\n\t\t\t\t\t\tonChange={e=>handleSectionChange(e)}\n\t\t\t\t\t\t\t \n\t\t\t\t\t\t\tclassName=\"pl-2 -ml-2 inputField flex-initial\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t<input type=\"text\" name=\"finYear\" placeholder=\"Fin Year Start (yyyy)\"\n\t\t\t\t\t\tonChange={e=>handleFyChange(e)}\n\t\t\t\t\t\t\t \n\t\t\t\t\t\t\tclassName=\"pl-2 -ml-2 inputField flex-initial\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div><button type=\"submit\" onClick={generateCs} className=\"w-32 m-0 p-0\">Print Cheque Slip</button></div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t} \t\t\n\t\t\t\t\t</div>\t\t\t\n\t\t\t\t\t</div>\t\t\n\t\t\t\t\t \n\n\n\t\t\t\t</div>\n\t\t\t\t \n\t\t\t</main>\n\n\t\t</div>\n\t);\n};\n \n\nexport default withRouter(PrintPmCs);"]},"metadata":{},"sourceType":"module"}