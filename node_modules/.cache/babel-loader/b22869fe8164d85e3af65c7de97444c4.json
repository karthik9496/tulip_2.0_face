{"ast":null,"code":"var _jsxFileName = \"/home/itsdc3/Imp Tulip files/falconws160424/falconws/falcon_face/src/components/BankEdit.js\";\n\n/**\n * Code generated using Python\n * @author Raja Reddy\n * Date : 17 Oct 2021\n *\n * Modified By :\n */\nimport { useState, useEffect } from \"react\";\nimport { withRouter, useParams, useHistory, useLocation } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport axios from \"axios\";\nimport * as yup from \"yup\";\nimport { yupResolver } from \"@hookform/resolvers/yup\";\nimport LiveSearch from \"../utils/LiveSearch\"; //import DatePicker  from 'react-datepicker';\n//import \"react-datepicker/dist/react-datepicker.css\";\n//import addDays from 'date-fns/addDays'\n\nimport Tabs from \"react-bootstrap/Tabs\";\nimport Tab from \"react-bootstrap/Tab\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst schema = yup.object({\n  bankName: yup.string().required(\"Required\"),\n  bankBranch: yup.string().required(\"Required\"),\n  bankStation: yup.string().required(\"Required\"),\n  ifsc: yup.string().required(\"Required\")\n});\n\nconst BankEdit = () => {\n  var _errors$bankName, _errors$bankBranch, _errors$bankStation, _errors$ifsc, _errors$treasuryCode, _errors$micr, _usr$designation, _usr$designation2, _usr$designation3, _usr$designation4;\n\n  const {\n    register,\n    handleSubmit,\n    setValue,\n    formState: {\n      errors\n    },\n    clearErrors\n  } = useForm({\n    resolver: yupResolver(schema)\n  });\n  let {\n    id\n  } = useParams();\n  let history = useHistory();\n  const [usr, setUsr] = useState({});\n  const [serverErrors, setServerErrors] = useState([]);\n  const [entity, setEntity] = useState({});\n  const [state, setState] = useState({});\n  const [key, setKey] = useState(\"page1\");\n  useEffect(() => {\n    let usr = JSON.parse(sessionStorage.getItem(\"usr\"));\n    setUsr(usr);\n  }, []);\n  useEffect(() => {\n    let isCancelled = false;\n    console.log(id);\n\n    if (id !== \"new\") {\n      async function fetchData() {\n        let record = \"\";\n        await axios.get(\"/banks/\" + id).then(response => {\n          record = response.data;\n          console.log(response.data);\n          const fields = [\"id\", \"treasuryBank\", \"auditorDate\", \"aaoDate\", \"aoDate\", \"approved\", \"bankName\", \"bankBranch\", \"bankStation\", \"recordStatus\", \"treasuryCode\", \"micr\", \"ifsc\", \"oldIfsc\", \"rtgsCode\"];\n          fields.forEach(field => setValue(field, record[field]));\n        }).catch(error => {\n          //console.log(error);\n          //console.log(error.response.status);\n          //console.log(error.response.headers);\n          if (error.response) setServerErrors(error.response.data.error);else setServerErrors(error.Error);\n        });\n\n        if (!isCancelled) {\n          setEntity(record);\n          setState(prev => ({ ...prev,\n            state: record\n          }));\n        }\n      }\n\n      fetchData();\n      return () => {\n        isCancelled = true;\n      };\n    }\n  }, [id, setValue]);\n\n  const onSubmit = (data, event) => {\n    event.preventDefault();\n    console.log(data);\n\n    if (data.id) {\n      axios.put(\"/banks/\" + data.id, data).then(response => {\n        if (response.status === 200) history.push(\"/banks\");\n      }).catch(error => {\n        //console.log(error.response.data);\n        console.log(error.response.status); //console.log(error.response.headers);\n\n        setServerErrors(error.response.data);\n      });\n    } else {\n      axios.post(\"/banks\", data).then(response => {\n        console.log(response.data);\n        if (response.status === 200) history.push({\n          pathname: \"/banks\",\n          state: response.data\n        });\n      }).catch(error => {\n        //console.log(error.response.data);\n        console.log(error.response.status); //console.log(error.response.headers);\n\n        setServerErrors(error.response.data);\n      });\n    }\n  };\n\n  const onError = (errors, e) => console.log(errors, e); //All foreign keys.\n  // XXXXXX Add search fields and adjust the values as necessary\n\n\n  const parentData = {\n    treasuryBank: {\n      title: \"Treasury Bank\",\n      url: \"treasuryBanks\",\n      searchList: [\"id\"],\n      //XXXXXXXXX Add search fields here and also in the corresponding repository\n      fkEntity: \"treasuryBank\"\n    }\n  }; //Callback for child components (Foreign Keys)\n\n  const callback = childData => {\n    //console.log(\"Parent Callback\");\n    setEntity(prev => ({ ...prev,\n      [childData.fk]: childData.entity\n    }));\n    setValue(childData.fk, childData.entity); //console.log(errors);\n\n    clearErrors(childData.fk);\n  };\n\n  const errorCallback = err => {\n    //console.log(err);\n    setServerErrors(err);\n  };\n\n  const handleInputChange = e => {//console.log(e.target.value);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-xl mx-auto \",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full  mx-auto \",\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit(onSubmit, onError),\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: [id === \"new\" ? \"Add\" : \"Edit\", \" Bank \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-red-500\",\n          children: serverErrors\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-2 gap-0\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Bank Name\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 187,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"bankName\",\n              ...register(\"bankName\"),\n              className: \"form-control py-0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 188,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-red-500\",\n              children: (_errors$bankName = errors.bankName) === null || _errors$bankName === void 0 ? void 0 : _errors$bankName.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 194,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Bank Branch\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 198,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"bankBranch\",\n              ...register(\"bankBranch\"),\n              className: \"form-control py-0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 199,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-red-500\",\n              children: (_errors$bankBranch = errors.bankBranch) === null || _errors$bankBranch === void 0 ? void 0 : _errors$bankBranch.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Bank Station\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"bankStation\",\n              ...register(\"bankStation\"),\n              className: \"form-control py-0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 210,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-red-500\",\n              children: (_errors$bankStation = errors.bankStation) === null || _errors$bankStation === void 0 ? void 0 : _errors$bankStation.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 216,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Ifsc\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 220,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"ifsc\",\n              ...register(\"ifsc\"),\n              className: \"form-control py-0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 221,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-red-500\",\n              children: (_errors$ifsc = errors.ifsc) === null || _errors$ifsc === void 0 ? void 0 : _errors$ifsc.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 227,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Treasury Code\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 231,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"treasuryCode\",\n              ...register(\"treasuryCode\"),\n              className: \"form-control py-0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-red-500\",\n              children: (_errors$treasuryCode = errors.treasuryCode) === null || _errors$treasuryCode === void 0 ? void 0 : _errors$treasuryCode.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 238,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Micr\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 242,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              name: \"micr\",\n              ...register(\"micr\"),\n              className: \"form-control py-0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 243,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-red-500\",\n              children: (_errors$micr = errors.micr) === null || _errors$micr === void 0 ? void 0 : _errors$micr.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 249,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 241,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"px-8\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            children: [(usr === null || usr === void 0 ? void 0 : (_usr$designation = usr.designation) === null || _usr$designation === void 0 ? void 0 : _usr$designation.designationLevel) < 30 && \"Save\", (usr === null || usr === void 0 ? void 0 : (_usr$designation2 = usr.designation) === null || _usr$designation2 === void 0 ? void 0 : _usr$designation2.designationLevel) >= 30 && (usr === null || usr === void 0 ? void 0 : (_usr$designation3 = usr.designation) === null || _usr$designation3 === void 0 ? void 0 : _usr$designation3.designationLevel) <= 40 && \"Submit\", (usr === null || usr === void 0 ? void 0 : (_usr$designation4 = usr.designation) === null || _usr$designation4 === void 0 ? void 0 : _usr$designation4.designationLevel) >= 50 && \"Approve\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 179,\n    columnNumber: 5\n  }, this);\n};\n\nexport default withRouter(BankEdit);","map":{"version":3,"sources":["/home/itsdc3/Imp Tulip files/falconws160424/falconws/falcon_face/src/components/BankEdit.js"],"names":["useState","useEffect","withRouter","useParams","useHistory","useLocation","useForm","axios","yup","yupResolver","LiveSearch","Tabs","Tab","schema","object","bankName","string","required","bankBranch","bankStation","ifsc","BankEdit","register","handleSubmit","setValue","formState","errors","clearErrors","resolver","id","history","usr","setUsr","serverErrors","setServerErrors","entity","setEntity","state","setState","key","setKey","JSON","parse","sessionStorage","getItem","isCancelled","console","log","fetchData","record","get","then","response","data","fields","forEach","field","catch","error","Error","prev","onSubmit","event","preventDefault","put","status","push","post","pathname","onError","e","parentData","treasuryBank","title","url","searchList","fkEntity","callback","childData","fk","errorCallback","err","handleInputChange","message","treasuryCode","micr","designation","designationLevel"],"mappings":"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","sourcesContent":["/**\n * Code generated using Python\n * @author Raja Reddy\n * Date : 17 Oct 2021\n *\n * Modified By :\n */\n\nimport { useState, useEffect } from \"react\";\nimport {\n  withRouter,\n  useParams,\n  useHistory,\n  useLocation,\n} from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\nimport axios from \"axios\";\nimport * as yup from \"yup\";\n\nimport { yupResolver } from \"@hookform/resolvers/yup\";\nimport LiveSearch from \"../utils/LiveSearch\";\n\n//import DatePicker  from 'react-datepicker';\n//import \"react-datepicker/dist/react-datepicker.css\";\n//import addDays from 'date-fns/addDays'\n\nimport Tabs from \"react-bootstrap/Tabs\";\nimport Tab from \"react-bootstrap/Tab\";\n\nconst schema = yup.object({\n  bankName: yup.string().required(\"Required\"),\n  bankBranch: yup.string().required(\"Required\"),\n  bankStation: yup.string().required(\"Required\"),\n\n  ifsc: yup.string().required(\"Required\"),\n});\n\nconst BankEdit = () => {\n  const {\n    register,\n    handleSubmit,\n    setValue,\n    formState: { errors },\n    clearErrors,\n  } = useForm({\n    resolver: yupResolver(schema),\n  });\n\n  let { id } = useParams();\n\n  let history = useHistory();\n  const [usr, setUsr] = useState({});\n  const [serverErrors, setServerErrors] = useState([]);\n  const [entity, setEntity] = useState({});\n  const [state, setState] = useState({});\n  const [key, setKey] = useState(\"page1\");\n\n  useEffect(() => {\n    let usr = JSON.parse(sessionStorage.getItem(\"usr\"));\n    setUsr(usr);\n  }, []);\n\n  useEffect(() => {\n    let isCancelled = false;\n    console.log(id);\n    if (id !== \"new\") {\n      async function fetchData() {\n        let record = \"\";\n        await axios\n          .get(\"/banks/\" + id)\n          .then((response) => {\n            record = response.data;\n            console.log(response.data);\n            const fields = [\n              \"id\",\n              \"treasuryBank\",\n              \"auditorDate\",\n              \"aaoDate\",\n              \"aoDate\",\n              \"approved\",\n              \"bankName\",\n              \"bankBranch\",\n              \"bankStation\",\n              \"recordStatus\",\n              \"treasuryCode\",\n              \"micr\",\n              \"ifsc\",\n              \"oldIfsc\",\n              \"rtgsCode\",\n            ];\n            fields.forEach((field) => setValue(field, record[field]));\n          })\n          .catch((error) => {\n            //console.log(error);\n            //console.log(error.response.status);\n            //console.log(error.response.headers);\n            if (error.response) setServerErrors(error.response.data.error);\n            else setServerErrors(error.Error);\n          });\n\n        if (!isCancelled) {\n          setEntity(record);\n          setState((prev) => ({ ...prev, state: record }));\n        }\n      }\n\n      fetchData();\n      return () => {\n        isCancelled = true;\n      };\n    }\n  }, [id, setValue]);\n\n  const onSubmit = (data, event) => {\n    event.preventDefault();\n    console.log(data);\n    if (data.id) {\n      axios\n        .put(\"/banks/\" + data.id, data)\n        .then((response) => {\n          if (response.status === 200) history.push(\"/banks\");\n        })\n        .catch((error) => {\n          //console.log(error.response.data);\n          console.log(error.response.status);\n          //console.log(error.response.headers);\n          setServerErrors(error.response.data);\n        });\n    } else {\n      axios\n        .post(\"/banks\", data)\n        .then((response) => {\n          console.log(response.data);\n          if (response.status === 200)\n            history.push({ pathname: \"/banks\", state: response.data });\n        })\n        .catch((error) => {\n          //console.log(error.response.data);\n\n          console.log(error.response.status);\n          //console.log(error.response.headers);\n          setServerErrors(error.response.data);\n        });\n    }\n  };\n\n  const onError = (errors, e) => console.log(errors, e);\n\n  //All foreign keys.\n  // XXXXXX Add search fields and adjust the values as necessary\n  const parentData = {\n    treasuryBank: {\n      title: \"Treasury Bank\",\n      url: \"treasuryBanks\",\n      searchList: [\"id\"], //XXXXXXXXX Add search fields here and also in the corresponding repository\n      fkEntity: \"treasuryBank\",\n    },\n  };\n\n  //Callback for child components (Foreign Keys)\n  const callback = (childData) => {\n    //console.log(\"Parent Callback\");\n    setEntity((prev) => ({ ...prev, [childData.fk]: childData.entity }));\n    setValue(childData.fk, childData.entity);\n    //console.log(errors);\n    clearErrors(childData.fk);\n  };\n\n  const errorCallback = (err) => {\n    //console.log(err);\n    setServerErrors(err);\n  };\n\n  const handleInputChange = (e) => {\n    //console.log(e.target.value);\n  };\n\n  return (\n    <div className=\"max-w-xl mx-auto \">\n      <div className=\"w-full  mx-auto \">\n        <form onSubmit={handleSubmit(onSubmit, onError)}>\n          <h1>{id === \"new\" ? \"Add\" : \"Edit\"} Bank </h1>\n          <div className=\"text-red-500\">{serverErrors}</div>\n\n          <div className=\"grid grid-cols-2 gap-0\">\n            <div>\n              <label>Bank Name</label>\n              <input\n                type=\"text\"\n                name=\"bankName\"\n                {...register(\"bankName\")}\n                className=\"form-control py-0\"\n              />\n              <div className=\"text-red-500\">{errors.bankName?.message}</div>\n            </div>\n\n            <div>\n              <label>Bank Branch</label>\n              <input\n                type=\"text\"\n                name=\"bankBranch\"\n                {...register(\"bankBranch\")}\n                className=\"form-control py-0\"\n              />\n              <div className=\"text-red-500\">{errors.bankBranch?.message}</div>\n            </div>\n\n            <div>\n              <label>Bank Station</label>\n              <input\n                type=\"text\"\n                name=\"bankStation\"\n                {...register(\"bankStation\")}\n                className=\"form-control py-0\"\n              />\n              <div className=\"text-red-500\">{errors.bankStation?.message}</div>\n            </div>\n\n            <div>\n              <label>Ifsc</label>\n              <input\n                type=\"text\"\n                name=\"ifsc\"\n                {...register(\"ifsc\")}\n                className=\"form-control py-0\"\n              />\n              <div className=\"text-red-500\">{errors.ifsc?.message}</div>\n            </div>\n\n            <div>\n              <label>Treasury Code</label>\n              <input\n                type=\"text\"\n                name=\"treasuryCode\"\n                {...register(\"treasuryCode\")}\n                className=\"form-control py-0\"\n              />\n              <div className=\"text-red-500\">{errors.treasuryCode?.message}</div>\n            </div>\n\n            <div>\n              <label>Micr</label>\n              <input\n                type=\"text\"\n                name=\"micr\"\n                {...register(\"micr\")}\n                className=\"form-control py-0\"\n              />\n              <div className=\"text-red-500\">{errors.micr?.message}</div>\n            </div>\n          </div>\n\n          <div className=\"px-8\">\n            <button type=\"submit\">\n              {usr?.designation?.designationLevel < 30 && \"Save\"}\n              {usr?.designation?.designationLevel >= 30 &&\n                usr?.designation?.designationLevel <= 40 &&\n                \"Submit\"}\n              {usr?.designation?.designationLevel >= 50 && \"Approve\"}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default withRouter(BankEdit);\n"]},"metadata":{},"sourceType":"module"}